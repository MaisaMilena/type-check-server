module FormalityInternal where
import Unsafe.Coerce
import Data.Word
import Data.Bits
import Data.List (intercalate)
import Debug.Trace
import System.Exit
import System.Directory
import System.FilePath.Posix (takeDirectory)
u = unsafeCoerce
setFile :: String -> IO ()
setFile param = do
  let path = takeWhile (/= '=') param
  let file = drop (length path + 1) param
  createDirectoryIfMissing True (takeDirectory path)
  writeFile path file
delFile :: String -> IO ()
delFile param = do
  isDir <- doesDirectoryExist param
  if isDir then do
    removeDirectory param
  else do
    removeFile param
getDir :: String -> IO String
getDir param = do
  dir <- listDirectory param
  return $ intercalate ";" dir
run p = case p of {
  (1,f) -> (u f (\query param cont-> case query of {
    "print"      -> do { putStrLn param; run (cont ()); };
    "put_string" -> do { putStr param; run (cont ()); };
    "exit"       -> do { exitFailure; run (cont ()); };
    "get_line"   -> do { line <- getLine; run (u cont line); };
    "set_file"   -> do { setFile param; run (u cont ""); };
    "get_file"   -> do { line <- readFile param; run (u cont line); };
    "del_file"   -> do { delFile param; run (u cont ""); };
    "get_dir"    -> do { dir <- getDir param; run (u cont dir); };
    otherwise    -> do { u cont (); };
  }));
  (0,f) -> (u f (\value-> do { (return :: a -> IO a) value; }));
}
word_to_u16       w        = u word_to_u16_go 0 w 0
word_to_u16_go 16 w      x = u x
word_to_u16_go  i (0,f)  x = u word_to_u16_go (i+1) (0,\t-> t) (x::Word16)
word_to_u16_go  i (1,f)  x = u f (\w-> word_to_u16_go (i+1) w x)
word_to_u16_go  i (2,f)  x = u f (\w-> word_to_u16_go (i+1) w (x .|. (shiftL 1 i)))
u16_to_word       x        = u u16_to_word_go 0 x (0,\t-> t)
u16_to_word_go 16 x      w = u w
u16_to_word_go  i x      w = u u16_to_word_go (i+1) (x::Word16) (if (shiftR x (16-i-1) .&. 1) > 0 then (2,\t-> t w) else (1,\t-> t w))
io = (\_a_1-> ())
io_ask = (\_query_2-> (\_param_3-> (\_then_4-> (1,\t-> t _query_2 _param_3 _then_4))))
io_bind = (\_a_3-> (\_f_4-> (let _0 = _a_3 in (case _0 of {(0,f) -> u f (\_1-> (u _f_4 _1)); (1,f) -> u f (\_2 _3 _4-> (u (u (u io_ask _2) _3) (\_x_8-> (u (u io_bind (u _4 _x_8)) _f_4)))); }))))
io_end = (\_value_2-> (0,\t-> t _value_2))
io_monad = (\_new_2-> (u (u _new_2 io_bind) io_end))
maybe = (\_a_1-> ())
map = (\_a_1-> ())
maybe_none = (0,\t-> t)
map_get = (\_bits_2-> (\_map_3-> (let _5 = _bits_2 in (case _5 of {(0,f) -> u f ((let _6 = _map_3 in (case _6 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_7 _8 _9-> _7); }))); (1,f) -> u f (\_10-> (let _11 = _map_3 in (case _11 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_12 _13 _14-> (u (u map_get _10) _13)); }))); (2,f) -> u f (\_15-> (let _16 = _map_3 in (case _16 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_17 _18 _19-> (u (u map_get _15) _19)); }))); }))))
bits_e = (0,\t-> t)
bool_false = False
bool_and = (\a0-> \a1-> (a0 && a1))
bool_true = True
cmp_as_lte = (\_cmp_1-> (let _20 = _cmp_1 in (case _20 of {(0,f) -> u f (bool_true); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
cmp_ltn = (0,\t-> t)
cmp_gtn = (2,\t-> t)
word_cmp_go = (\_a_2-> (\_b_3-> (\_c_4-> (let _21 = _a_2 in (case _21 of {(0,f) -> u f ((\_b_5-> _c_4)); (1,f) -> u f (\_22-> (\_b_7-> (let _23 = _b_7 in (case _23 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_24-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _24) _c_4))); (2,f) -> u f (\_25-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _25) cmp_ltn))); })) _22)); (2,f) -> u f (\_26-> (\_b_7-> (let _27 = _b_7 in (case _27 of {(0,f) -> u f ((\_a_pred_8-> _c_4)); (1,f) -> u f (\_28-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _28) cmp_gtn))); (2,f) -> u f (\_29-> (\_a_pred_10-> (u (u (u word_cmp_go _a_pred_10) _29) _c_4))); })) _26)); })) _b_3)))
cmp_eql = (1,\t-> t)
word_cmp = (\_a_2-> (\_b_3-> (u (u (u word_cmp_go _a_2) _b_3) cmp_eql)))
word_lte = (\_a_2-> (\_b_3-> (u cmp_as_lte (u (u word_cmp _a_2) _b_3))))
nat_succ = (\_pred_1-> 1+_pred_1)
nat_zero = 0
u16_lte = (\a0-> \a1-> ((a0::Word16) <= a1))
u16_btw = (\_a_1-> (\_b_2-> (\_c_3-> (((((_a_1::Word16) <= _b_2)) && (((_b_2::Word16) <= _c_3)))))))
u16_new = (\_value_1-> (word_to_u16 _value_1))
word_e = (0,\t-> t)
word = (\_size_1-> ())
word_i = (\_pred_2-> (2,\t-> t _pred_2))
word_o = (\_pred_2-> (1,\t-> t _pred_2))
word_subber = (\_a_2-> (\_b_3-> (\_c_4-> (let _30 = _a_2 in (case _30 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_31-> (\_b_7-> (let _32 = _b_7 in (case _32 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_33-> (\_a_pred_10-> (let _34 = _c_4 in (if _34 then (u word_i (u (u (u word_subber _a_pred_10) _33) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _33) bool_false)))))); (2,f) -> u f (\_35-> (\_a_pred_10-> (let _36 = _c_4 in (if _36 then (u word_o (u (u (u word_subber _a_pred_10) _35) bool_true)) else (u word_i (u (u (u word_subber _a_pred_10) _35) bool_true)))))); })) _31)); (2,f) -> u f (\_37-> (\_b_7-> (let _38 = _b_7 in (case _38 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_39-> (\_a_pred_10-> (let _40 = _c_4 in (if _40 then (u word_o (u (u (u word_subber _a_pred_10) _39) bool_false)) else (u word_i (u (u (u word_subber _a_pred_10) _39) bool_false)))))); (2,f) -> u f (\_41-> (\_a_pred_10-> (let _42 = _c_4 in (if _42 then (u word_i (u (u (u word_subber _a_pred_10) _41) bool_true)) else (u word_o (u (u (u word_subber _a_pred_10) _41) bool_false)))))); })) _37)); })) _b_3)))
word_sub = (\_a_2-> (\_b_3-> (u (u (u word_subber _a_2) _b_3) bool_false)))
u16_sub = (\a0-> \a1-> ((a0::Word16) - a1))
nat_apply = (\_n_2-> (\_f_3-> (\_x_4-> (let _43 = _n_2 in (if _43==0 then _x_4 else (u (u (u nat_apply (_43-1)) _f_3) (u _f_3 _x_4)))))))
word_inc = (\_word_2-> (let _44 = _word_2 in (case _44 of {(0,f) -> u f (word_e); (1,f) -> u f (\_45-> (u word_i _45)); (2,f) -> u f (\_46-> (u word_o (u word_inc _46))); })))
u16_inc = (\_a_1-> (let _47 = _a_1 in (u u16_new (u word_inc (u16_to_word _47)))))
word_zero = (\_size_1-> (let _48 = _size_1 in (if _48==0 then word_e else (u word_o (u word_zero (_48-1))))))
u16_zero = (u u16_new (u word_zero 16))
nat_to_u16 = (\a0-> (fromIntegral (a0::Integer)))
word_adder = (\_a_2-> (\_b_3-> (\_c_4-> (let _49 = _a_2 in (case _49 of {(0,f) -> u f ((\_b_5-> word_e)); (1,f) -> u f (\_50-> (\_b_7-> (let _51 = _b_7 in (case _51 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_52-> (\_a_pred_10-> (let _53 = _c_4 in (if _53 then (u word_i (u (u (u word_adder _a_pred_10) _52) bool_false)) else (u word_o (u (u (u word_adder _a_pred_10) _52) bool_false)))))); (2,f) -> u f (\_54-> (\_a_pred_10-> (let _55 = _c_4 in (if _55 then (u word_o (u (u (u word_adder _a_pred_10) _54) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _54) bool_false)))))); })) _50)); (2,f) -> u f (\_56-> (\_b_7-> (let _57 = _b_7 in (case _57 of {(0,f) -> u f ((\_a_pred_8-> word_e)); (1,f) -> u f (\_58-> (\_a_pred_10-> (let _59 = _c_4 in (if _59 then (u word_o (u (u (u word_adder _a_pred_10) _58) bool_true)) else (u word_i (u (u (u word_adder _a_pred_10) _58) bool_false)))))); (2,f) -> u f (\_60-> (\_a_pred_10-> (let _61 = _c_4 in (if _61 then (u word_i (u (u (u word_adder _a_pred_10) _60) bool_true)) else (u word_o (u (u (u word_adder _a_pred_10) _60) bool_true)))))); })) _56)); })) _b_3)))
word_add = (\_a_2-> (\_b_3-> (u (u (u word_adder _a_2) _b_3) bool_false)))
u16_add = (\a0-> \a1-> ((a0::Word16) + a1))
cmp_as_eql = (\_cmp_1-> (let _62 = _cmp_1 in (case _62 of {(0,f) -> u f (bool_false); (1,f) -> u f (bool_true); (2,f) -> u f (bool_false); })))
word_eql = (\_a_2-> (\_b_3-> (u cmp_as_eql (u (u word_cmp _a_2) _b_3))))
u16_eql = (\a0-> \a1-> ((a0::Word16) == a1))
bits_o = (\_pred_1-> (1,\t-> t _pred_1))
bits_i = (\_pred_1-> (2,\t-> t _pred_1))
word_to_bits = (\_a_2-> (let _63 = _a_2 in (case _63 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_64-> (u bits_o (u word_to_bits _64))); (2,f) -> u f (\_65-> (u bits_i (u word_to_bits _65))); })))
word_trim = (\_new_size_2-> (\_word_3-> (let _66 = _new_size_2 in (if _66==0 then word_e else (let _67 = _word_3 in (case _67 of {(0,f) -> u f ((u word_o (u (u word_trim (_66-1)) word_e))); (1,f) -> u f (\_68-> (u word_o (u (u word_trim (_66-1)) _68))); (2,f) -> u f (\_69-> (u word_i (u (u word_trim (_66-1)) _69))); }))))))
bits_concat = (\_a_1-> (\_b_2-> (let _70 = _a_1 in (case _70 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_71-> (u bits_o (u (u bits_concat _71) _b_2))); (2,f) -> u f (\_72-> (u bits_i (u (u bits_concat _72) _b_2))); }))))
bits_reverse_tco = (\_a_1-> (\_r_2-> (let _73 = _a_1 in (case _73 of {(0,f) -> u f (_r_2); (1,f) -> u f (\_74-> (u (u bits_reverse_tco _74) (u bits_o _r_2))); (2,f) -> u f (\_75-> (u (u bits_reverse_tco _75) (u bits_i _r_2))); }))))
bits_reverse = (\_a_1-> (u (u bits_reverse_tco _a_1) bits_e))
fm_name_to_bits = (\_name_1-> (let _76 = _name_1 in (if null (_76::String) then bits_e else (let _chr_4=(fromIntegral (fromEnum (head _76 :: Char)) :: Word16) in (let _u16_5=(let _77 = (u (u (u u16_btw 65) _chr_4) 90) in (if _77 then (((_chr_4::Word16) - 65)) else (let _78 = (u (u (u u16_btw 97) _chr_4) 122) in (if _78 then (((_chr_4::Word16) - 71)) else (let _79 = (u (u (u u16_btw 48) _chr_4) 57) in (if _79 then (((_chr_4::Word16) + 4)) else (let _80 = (((46::Word16) == _chr_4)) in (if _80 then 62 else (let _81 = (((95::Word16) == _chr_4)) in (if _81 then 63 else 0)))))))))) in (let _bts_6=(let _82 = _u16_5 in (u word_to_bits (u (u word_trim 6) (u16_to_word _82)))) in (u (u bits_concat (u bits_reverse _bts_6)) (u fm_name_to_bits (tail _76)))))))))
fm_get = (\_name_2-> (\_map_3-> (u (u map_get (u fm_name_to_bits _name_2)) _map_3)))
io_get_file = (\_name_1-> (u (u (u io_ask "get_file") _name_1) (\_file_2-> (u io_end _file_2))))
parser_reply = (\_v_1-> ())
parser_reply_value = (\_idx_2-> (\_code_3-> (\_val_4-> (1,\t-> t _idx_2 _code_3 _val_4))))
parser_is_eof = (\_idx_1-> (\_code_2-> (let _83 = _code_2 in (if null (_83::String) then (u (u (u parser_reply_value _idx_1) _code_2) bool_true) else (u (u (u parser_reply_value _idx_1) _code_2) bool_false)))))
parser_reply_error = (\_idx_2-> (\_code_3-> (\_err_4-> (0,\t-> t _idx_2 _code_3 _err_4))))
parser = (\_v_1-> ())
maybe_some = (\_value_2-> (1,\t-> t _value_2))
parser_errorat_new = (\_idx_1-> (\_code_2-> (\_err_3-> (0,\t-> t _idx_1 _code_2 _err_3))))
nat_gtn = (\a0-> \a1-> ((a0::Integer) > a1))
parser_errorat_combine = (\_a_1-> (\_b_2-> (let _84 = _a_1 in (case _84 of {(0,f) -> u f (_b_2); (1,f) -> u f (\_85-> (let _86 = _b_2 in (case _86 of {(0,f) -> u f (_a_1); (1,f) -> u f (\_87-> (let _88 = _85 in (case _88 of {(0,f) -> u f (\_89 _90 _91-> (let _92 = _87 in (case _92 of {(0,f) -> u f (\_93 _94 _95-> (let _96 = (((_89::Integer) > _93)) in (if _96 then _a_1 else _b_2))); }))); }))); }))); }))))
parser_first_of_go = (\_pars_2-> (\_err_3-> (\_idx_4-> (\_code_5-> (let _97 = _pars_2 in (case _97 of {(0,f) -> u f ((let _98 = _err_3 in (case _98 of {(0,f) -> u f ((u (u (u parser_reply_error _idx_4) _code_5) "No parse.")); (1,f) -> u f (\_99-> (let _100 = _99 in (case _100 of {(0,f) -> u f (\_101 _102 _103-> (u (u (u parser_reply_error _101) _102) _103)); }))); }))); (1,f) -> u f (\_104 _105-> (let _parsed_8=(u (u _104 _idx_4) _code_5) in (let _106 = _parsed_8 in (case _106 of {(0,f) -> u f (\_107 _108 _109-> (let _neo_12=(u maybe_some (u (u (u parser_errorat_new _107) _108) _109)) in (let _err_13=(u (u parser_errorat_combine _neo_12) _err_3) in (u (u (u (u parser_first_of_go _105) _err_13) _idx_4) _code_5)))); (1,f) -> u f (\_110 _111 _112-> (u (u (u parser_reply_value _110) _111) _112)); })))); }))))))
parser_first_of = (\_pars_2-> (u (u parser_first_of_go _pars_2) maybe_none))
list_cons = (\_head_2-> (\_tail_3-> (1,\t-> t _head_2 _tail_3)))
list = (\_a_1-> ())
list_nil = (0,\t-> t)
parser_many_go = (\_parse_2-> (\_values_3-> (\_idx_4-> (\_code_5-> (let _113 = (u (u _parse_2 _idx_4) _code_5) in (case _113 of {(0,f) -> u f (\_114 _115 _116-> (u (u (u parser_reply_value _idx_4) _code_5) (u _values_3 list_nil))); (1,f) -> u f (\_117 _118 _119-> (u (u (u (u parser_many_go _parse_2) (\_xs_9-> (u _values_3 (u (u list_cons _119) _xs_9)))) _117) _118)); }))))))
parser_many = (\_parser_2-> (u (u parser_many_go _parser_2) (\_x_3-> _x_3)))
unit_new = ()
string_cons = (\_head_1-> (\_tail_2-> ((toEnum (fromIntegral _head_1 :: Int) :: Char) : _tail_2)))
string_concat = (\a0-> \a1-> ((a0::String) ++ a1))
string_flatten_go = (\_xs_1-> (\_res_2-> (let _120 = _xs_1 in (case _120 of {(0,f) -> u f (_res_2); (1,f) -> u f (\_121 _122-> (u (u string_flatten_go _122) (((_res_2::String) ++ _121)))); }))))
string_flatten = (\_xs_1-> (u (u string_flatten_go _xs_1) ""))
string_nil = []
parser_text_go = (\_text_1-> (\_idx_2-> (\_code_3-> (let _123 = _text_1 in (if null (_123::String) then (u (u (u parser_reply_value _idx_2) _code_3) unit_new) else (let _124 = _code_3 in (if null (_124::String) then (let _error_6=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found end of file.") list_nil)))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_6)) else (let _125 = ((((fromIntegral (fromEnum (head _123 :: Char)) :: Word16)::Word16) == (fromIntegral (fromEnum (head _124 :: Char)) :: Word16))) in (if _125 then (u (u (u parser_text (tail _123)) (u nat_succ _idx_2)) (tail _124)) else (let _error_8=(u string_flatten (u (u list_cons "Expected '") (u (u list_cons _text_1) (u (u list_cons "', found '") (u (u list_cons (u (u string_cons (fromIntegral (fromEnum (head _124 :: Char)) :: Word16)) string_nil)) (u (u list_cons "'.") list_nil)))))) in (u (u (u parser_reply_error _idx_2) _code_3) _error_8)))))))))))
parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _126 = (u (u (u parser_text_go _text_1) _idx_2) _code_3) in (case _126 of {(0,f) -> u f (\_127 _128 _129-> (u (u (u parser_reply_error _idx_2) _code_3) _129)); (1,f) -> u f (\_130 _131 _132-> (u (u (u parser_reply_value _130) _131) _132)); })))))
list_reverse_go = (\_xs_2-> (\_res_3-> (let _133 = _xs_2 in (case _133 of {(0,f) -> u f (_res_3); (1,f) -> u f (\_134 _135-> (u (u list_reverse_go _135) (u (u list_cons _134) _res_3))); }))))
list_reverse = (\_xs_2-> (u (u list_reverse_go _xs_2) list_nil))
parser_until_go = (\_until_2-> (\_parse_3-> (\_values_4-> (\_idx_5-> (\_code_6-> (let _until_reply_7=(u (u _until_2 _idx_5) _code_6) in (let _136 = _until_reply_7 in (case _136 of {(0,f) -> u f (\_137 _138 _139-> (let _reply_11=(u (u _parse_3 _idx_5) _code_6) in (let _140 = _reply_11 in (case _140 of {(0,f) -> u f (\_141 _142 _143-> (u (u (u parser_reply_error _141) _142) _143)); (1,f) -> u f (\_144 _145 _146-> (u (u (u (u (u parser_until_go _until_2) _parse_3) (u (u list_cons _146) _values_4)) _144) _145)); })))); (1,f) -> u f (\_147 _148 _149-> (u (u (u parser_reply_value _147) _148) (u list_reverse _values_4))); }))))))))
parser_until = (\_until_2-> (\_parse_3-> (u (u (u parser_until_go _until_2) _parse_3) list_nil)))
parser_one = (\_idx_1-> (\_code_2-> (let _150 = _code_2 in (if null (_150::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected end of file.") else (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _150)) (fromIntegral (fromEnum (head _150 :: Char)) :: Word16))))))
fm_parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\t")) (u (u list_cons (u parser_text "\n")) (u (u list_cons (\_idx_1-> (\_code_2-> (let _151 = (u (u (u parser_text "//") _idx_1) _code_2) in (case _151 of {(0,f) -> u f (\_152 _153 _154-> (u (u (u parser_reply_error _152) _153) _154)); (1,f) -> u f (\_155 _156 _157-> (let _158 = (u (u (u (u parser_until (u parser_text "\n")) parser_one) _155) _156) in (case _158 of {(0,f) -> u f (\_159 _160 _161-> (u (u (u parser_reply_error _159) _160) _161)); (1,f) -> u f (\_162 _163 _164-> (u (u (u parser_reply_value _162) _163) unit_new)); }))); }))))) list_nil))))))
parser_get_index = (\_idx_1-> (\_code_2-> (u (u (u parser_reply_value _idx_1) _code_2) _idx_1)))
fm_parser_init = (\_idx_1-> (\_code_2-> (let _165 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _165 of {(0,f) -> u f (\_166 _167 _168-> (u (u (u parser_reply_error _166) _167) _168)); (1,f) -> u f (\_169 _170 _171-> (let _172 = (u (u parser_get_index _169) _170) in (case _172 of {(0,f) -> u f (\_173 _174 _175-> (u (u (u parser_reply_error _173) _174) _175)); (1,f) -> u f (\_176 _177 _178-> (u (u (u parser_reply_value _176) _177) _178)); }))); }))))
parser_many1 = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _179 = (u (u _parser_2 _idx_3) _code_4) in (case _179 of {(0,f) -> u f (\_180 _181 _182-> (u (u (u parser_reply_error _180) _181) _182)); (1,f) -> u f (\_183 _184 _185-> (let _186 = (u (u (u parser_many _parser_2) _183) _184) in (case _186 of {(0,f) -> u f (\_187 _188 _189-> (u (u (u parser_reply_error _187) _188) _189)); (1,f) -> u f (\_190 _191 _192-> (u (u (u parser_reply_value _190) _191) (u (u list_cons _185) _192))); }))); })))))
fm_name_is_letter = (\_chr_1-> (let _193 = (u (u (u u16_btw 65) _chr_1) 90) in (if _193 then bool_true else (let _194 = (u (u (u u16_btw 97) _chr_1) 122) in (if _194 then bool_true else (let _195 = (u (u (u u16_btw 48) _chr_1) 57) in (if _195 then bool_true else (let _196 = (((46::Word16) == _chr_1)) in (if _196 then bool_true else (let _197 = (((95::Word16) == _chr_1)) in (if _197 then bool_true else (let _198 = (((94::Word16) == _chr_1)) in (if _198 then bool_true else bool_false)))))))))))))
fm_parser_letter = (\_idx_1-> (\_code_2-> (let _199 = _code_2 in (if null (_199::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Unexpected eof.") else (let _200 = (u fm_name_is_letter (fromIntegral (fromEnum (head _199 :: Char)) :: Word16)) in (if _200 then (u (u (u parser_reply_value (u nat_succ _idx_1)) (tail _199)) (fromIntegral (fromEnum (head _199 :: Char)) :: Word16)) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected letter.")))))))
list_fold = (\_list_2-> (\_nil_4-> (\_cons_5-> (let _201 = _list_2 in (case _201 of {(0,f) -> u f (_nil_4); (1,f) -> u f (\_202 _203-> (u (u _cons_5 _202) (u (u (u list_fold _203) _nil_4) _cons_5))); })))))
fm_parser_name1 = (\_idx_1-> (\_code_2-> (let _204 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _204 of {(0,f) -> u f (\_205 _206 _207-> (u (u (u parser_reply_error _205) _206) _207)); (1,f) -> u f (\_208 _209 _210-> (let _211 = (u (u (u parser_many1 fm_parser_letter) _208) _209) in (case _211 of {(0,f) -> u f (\_212 _213 _214-> (u (u (u parser_reply_error _212) _213) _214)); (1,f) -> u f (\_215 _216 _217-> (u (u (u parser_reply_value _215) _216) (u (u (u list_fold _217) string_nil) string_cons))); }))); }))))
fm_parser_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _218 = (u (u fm_parser_spaces _idx_2) _code_3) in (case _218 of {(0,f) -> u f (\_219 _220 _221-> (u (u (u parser_reply_error _219) _220) _221)); (1,f) -> u f (\_222 _223 _224-> (u (u (u parser_text _text_1) _222) _223)); })))))
parser_until1 = (\_cond_2-> (\_parser_3-> (\_idx_4-> (\_code_5-> (let _225 = (u (u _parser_3 _idx_4) _code_5) in (case _225 of {(0,f) -> u f (\_226 _227 _228-> (u (u (u parser_reply_error _226) _227) _228)); (1,f) -> u f (\_229 _230 _231-> (let _232 = (u (u (u (u parser_until _cond_2) _parser_3) _229) _230) in (case _232 of {(0,f) -> u f (\_233 _234 _235-> (u (u (u parser_reply_error _233) _234) _235)); (1,f) -> u f (\_236 _237 _238-> (u (u (u parser_reply_value _236) _237) (u (u list_cons _231) _238))); }))); }))))))
pair = (\_a_1-> (\_b_2-> ()))
parser_maybe = (\_parse_2-> (\_idx_3-> (\_code_4-> (let _239 = (u (u _parse_2 _idx_3) _code_4) in (case _239 of {(0,f) -> u f (\_240 _241 _242-> (u (u (u parser_reply_value _idx_3) _code_4) maybe_none)); (1,f) -> u f (\_243 _244 _245-> (u (u (u parser_reply_value _243) _244) (u maybe_some _245))); })))))
fm_parser_item = (\_parser_2-> (\_idx_3-> (\_code_4-> (let _246 = (u (u fm_parser_spaces _idx_3) _code_4) in (case _246 of {(0,f) -> u f (\_247 _248 _249-> (u (u (u parser_reply_error _247) _248) _249)); (1,f) -> u f (\_250 _251 _252-> (let _253 = (u (u _parser_2 _250) _251) in (case _253 of {(0,f) -> u f (\_254 _255 _256-> (u (u (u parser_reply_error _254) _255) _256)); (1,f) -> u f (\_257 _258 _259-> (let _260 = (u (u (u parser_maybe (u fm_parser_text ",")) _257) _258) in (case _260 of {(0,f) -> u f (\_261 _262 _263-> (u (u (u parser_reply_error _261) _262) _263)); (1,f) -> u f (\_264 _265 _266-> (u (u (u parser_reply_value _264) _265) _259)); }))); }))); })))))
fm_parser_name = (\_idx_1-> (\_code_2-> (let _267 = (u (u fm_parser_spaces _idx_1) _code_2) in (case _267 of {(0,f) -> u f (\_268 _269 _270-> (u (u (u parser_reply_error _268) _269) _270)); (1,f) -> u f (\_271 _272 _273-> (let _274 = (u (u (u parser_many fm_parser_letter) _271) _272) in (case _274 of {(0,f) -> u f (\_275 _276 _277-> (u (u (u parser_reply_error _275) _276) _277)); (1,f) -> u f (\_278 _279 _280-> (u (u (u parser_reply_value _278) _279) (u (u (u list_fold _280) string_nil) string_cons))); }))); }))))
pair_new = (\_fst_3-> (\_snd_4-> (0,\t-> t _fst_3 _snd_4)))
fm_parser_stop = (\_from_1-> (\_idx_2-> (\_code_3-> (let _281 = (u (u parser_get_index _idx_2) _code_3) in (case _281 of {(0,f) -> u f (\_282 _283 _284-> (u (u (u parser_reply_error _282) _283) _284)); (1,f) -> u f (\_285 _286 _287-> (let _orig_7=(u (u pair_new _from_1) _287) in (u (u (u parser_reply_value _285) _286) _orig_7))); })))))
fm_term_ori = (\_orig_1-> (\_expr_2-> (15,\t-> t _orig_1 _expr_2)))
fm_term_typ = (2,\t-> t)
fm_parser_type = (\_idx_1-> (\_code_2-> (let _288 = (u (u fm_parser_init _idx_1) _code_2) in (case _288 of {(0,f) -> u f (\_289 _290 _291-> (u (u (u parser_reply_error _289) _290) _291)); (1,f) -> u f (\_292 _293 _294-> (let _295 = (u (u (u fm_parser_text "Type") _292) _293) in (case _295 of {(0,f) -> u f (\_296 _297 _298-> (u (u (u parser_reply_error _296) _297) _298)); (1,f) -> u f (\_299 _300 _301-> (let _302 = (u (u (u fm_parser_stop _294) _299) _300) in (case _302 of {(0,f) -> u f (\_303 _304 _305-> (u (u (u parser_reply_error _303) _304) _305)); (1,f) -> u f (\_306 _307 _308-> (u (u (u parser_reply_value _306) _307) (u (u fm_term_ori _308) fm_term_typ))); }))); }))); }))))
fm_term_all = (\_eras_1-> (\_self_2-> (\_name_3-> (\_xtyp_4-> (\_body_5-> (3,\t-> t _eras_1 _self_2 _name_3 _xtyp_4 _body_5))))))
fm_parser_forall = (\_idx_1-> (\_code_2-> (let _309 = (u (u fm_parser_init _idx_1) _code_2) in (case _309 of {(0,f) -> u f (\_310 _311 _312-> (u (u (u parser_reply_error _310) _311) _312)); (1,f) -> u f (\_313 _314 _315-> (let _316 = (u (u fm_parser_name _313) _314) in (case _316 of {(0,f) -> u f (\_317 _318 _319-> (u (u (u parser_reply_error _317) _318) _319)); (1,f) -> u f (\_320 _321 _322-> (let _323 = (u (u fm_parser_binder _320) _321) in (case _323 of {(0,f) -> u f (\_324 _325 _326-> (u (u (u parser_reply_error _324) _325) _326)); (1,f) -> u f (\_327 _328 _329-> (let _330 = (u (u (u parser_maybe (u fm_parser_text "->")) _327) _328) in (case _330 of {(0,f) -> u f (\_331 _332 _333-> (u (u (u parser_reply_error _331) _332) _333)); (1,f) -> u f (\_334 _335 _336-> (let _337 = (u (u fm_parser_term _334) _335) in (case _337 of {(0,f) -> u f (\_338 _339 _340-> (u (u (u parser_reply_error _338) _339) _340)); (1,f) -> u f (\_341 _342 _343-> (let _term_18=(u (u (u list_fold _329) _343) (\_x_18-> (\_t_19-> (let _344 = _x_18 in (case _344 of {(0,f) -> u f (\_345 _346 _347-> (u (u (u (u (u fm_term_all _345) "") _346) _347) (\_s_23-> (\_x_24-> _t_19)))); }))))) in (let _348 = (u (u (u fm_parser_stop _315) _341) _342) in (case _348 of {(0,f) -> u f (\_349 _350 _351-> (u (u (u parser_reply_error _349) _350) _351)); (1,f) -> u f (\_352 _353 _354-> (u (u (u parser_reply_value _352) _353) (let _355 = _term_18 in (case _355 of {(0,f) -> u f (\_356 _357-> _term_18); (1,f) -> u f (\_358-> _term_18); (2,f) -> u f (_term_18); (3,f) -> u f (\_359 _360 _361 _362 _363-> (u (u fm_term_ori _354) (u (u (u (u (u fm_term_all _359) _322) _361) _362) _363))); (4,f) -> u f (\_364 _365-> _term_18); (5,f) -> u f (\_366 _367-> _term_18); (6,f) -> u f (\_368 _369 _370-> _term_18); (7,f) -> u f (\_371 _372 _373-> _term_18); (8,f) -> u f (\_374 _375 _376-> _term_18); (9,f) -> u f (\_377 _378 _379-> _term_18); (10,f) -> u f (\_380-> _term_18); (11,f) -> u f (\_381-> _term_18); (12,f) -> u f (\_382-> _term_18); (13,f) -> u f (\_383-> _term_18); (14,f) -> u f (\_384 _385 _386 _387 _388 _389-> _term_18); (15,f) -> u f (\_390 _391-> _term_18); })))); })))); }))); }))); }))); }))); }))))
fm_term_lam = (\_name_1-> (\_body_2-> (4,\t-> t _name_1 _body_2)))
fm_parser_make_lambda = (\_names_1-> (\_body_2-> (let _392 = _names_1 in (case _392 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_393 _394-> (u (u fm_term_lam _393) (\_x_5-> (u (u fm_parser_make_lambda _394) _body_2)))); }))))
fm_parser_lambda = (\_idx_1-> (\_code_2-> (let _395 = (u (u fm_parser_init _idx_1) _code_2) in (case _395 of {(0,f) -> u f (\_396 _397 _398-> (u (u (u parser_reply_error _396) _397) _398)); (1,f) -> u f (\_399 _400 _401-> (let _402 = (u (u (u fm_parser_text "(") _399) _400) in (case _402 of {(0,f) -> u f (\_403 _404 _405-> (u (u (u parser_reply_error _403) _404) _405)); (1,f) -> u f (\_406 _407 _408-> (let _409 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_name1)) _406) _407) in (case _409 of {(0,f) -> u f (\_410 _411 _412-> (u (u (u parser_reply_error _410) _411) _412)); (1,f) -> u f (\_413 _414 _415-> (let _416 = (u (u fm_parser_term _413) _414) in (case _416 of {(0,f) -> u f (\_417 _418 _419-> (u (u (u parser_reply_error _417) _418) _419)); (1,f) -> u f (\_420 _421 _422-> (let _423 = (u (u (u fm_parser_stop _401) _420) _421) in (case _423 of {(0,f) -> u f (\_424 _425 _426-> (u (u (u parser_reply_error _424) _425) _426)); (1,f) -> u f (\_427 _428 _429-> (let _expr_18=(u (u fm_parser_make_lambda _415) _422) in (u (u (u parser_reply_value _427) _428) (u (u fm_term_ori _429) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_erased = (\_idx_1-> (\_code_2-> (let _430 = (u (u fm_parser_init _idx_1) _code_2) in (case _430 of {(0,f) -> u f (\_431 _432 _433-> (u (u (u parser_reply_error _431) _432) _433)); (1,f) -> u f (\_434 _435 _436-> (let _437 = (u (u (u fm_parser_text "<") _434) _435) in (case _437 of {(0,f) -> u f (\_438 _439 _440-> (u (u (u parser_reply_error _438) _439) _440)); (1,f) -> u f (\_441 _442 _443-> (let _444 = (u (u (u (u parser_until1 (u fm_parser_text ">")) (u fm_parser_item fm_parser_name1)) _441) _442) in (case _444 of {(0,f) -> u f (\_445 _446 _447-> (u (u (u parser_reply_error _445) _446) _447)); (1,f) -> u f (\_448 _449 _450-> (let _451 = (u (u fm_parser_term _448) _449) in (case _451 of {(0,f) -> u f (\_452 _453 _454-> (u (u (u parser_reply_error _452) _453) _454)); (1,f) -> u f (\_455 _456 _457-> (let _458 = (u (u (u fm_parser_stop _436) _455) _456) in (case _458 of {(0,f) -> u f (\_459 _460 _461-> (u (u (u parser_reply_error _459) _460) _461)); (1,f) -> u f (\_462 _463 _464-> (let _expr_18=(u (u fm_parser_make_lambda _450) _457) in (u (u (u parser_reply_value _462) _463) (u (u fm_term_ori _464) _expr_18)))); }))); }))); }))); }))); }))))
fm_parser_lambda_nameless = (\_idx_1-> (\_code_2-> (let _465 = (u (u fm_parser_init _idx_1) _code_2) in (case _465 of {(0,f) -> u f (\_466 _467 _468-> (u (u (u parser_reply_error _466) _467) _468)); (1,f) -> u f (\_469 _470 _471-> (let _472 = (u (u (u fm_parser_text "()") _469) _470) in (case _472 of {(0,f) -> u f (\_473 _474 _475-> (u (u (u parser_reply_error _473) _474) _475)); (1,f) -> u f (\_476 _477 _478-> (let _479 = (u (u fm_parser_term _476) _477) in (case _479 of {(0,f) -> u f (\_480 _481 _482-> (u (u (u parser_reply_error _480) _481) _482)); (1,f) -> u f (\_483 _484 _485-> (let _486 = (u (u (u fm_parser_stop _471) _483) _484) in (case _486 of {(0,f) -> u f (\_487 _488 _489-> (u (u (u parser_reply_error _487) _488) _489)); (1,f) -> u f (\_490 _491 _492-> (let _expr_15=(u (u fm_term_lam "") (\_x_15-> _485)) in (u (u (u parser_reply_value _490) _491) (u (u fm_term_ori _492) _expr_15)))); }))); }))); }))); }))))
fm_parser_parenthesis = (\_idx_1-> (\_code_2-> (let _493 = (u (u (u fm_parser_text "(") _idx_1) _code_2) in (case _493 of {(0,f) -> u f (\_494 _495 _496-> (u (u (u parser_reply_error _494) _495) _496)); (1,f) -> u f (\_497 _498 _499-> (let _500 = (u (u fm_parser_term _497) _498) in (case _500 of {(0,f) -> u f (\_501 _502 _503-> (u (u (u parser_reply_error _501) _502) _503)); (1,f) -> u f (\_504 _505 _506-> (let _507 = (u (u (u fm_parser_text ")") _504) _505) in (case _507 of {(0,f) -> u f (\_508 _509 _510-> (u (u (u parser_reply_error _508) _509) _510)); (1,f) -> u f (\_511 _512 _513-> (u (u (u parser_reply_value _511) _512) _506)); }))); }))); }))))
fm_term_ref = (\_name_1-> (1,\t-> t _name_1))
fm_term_app = (\_func_1-> (\_argm_2-> (5,\t-> t _func_1 _argm_2)))
fm_term_hol = (\_path_1-> (10,\t-> t _path_1))
fm_term_let = (\_name_1-> (\_expr_2-> (\_body_3-> (6,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_letforrange_u32 = (\_idx_1-> (\_code_2-> (let _514 = (u (u fm_parser_init _idx_1) _code_2) in (case _514 of {(0,f) -> u f (\_515 _516 _517-> (u (u (u parser_reply_error _515) _516) _517)); (1,f) -> u f (\_518 _519 _520-> (let _521 = (u (u (u fm_parser_text "let ") _518) _519) in (case _521 of {(0,f) -> u f (\_522 _523 _524-> (u (u (u parser_reply_error _522) _523) _524)); (1,f) -> u f (\_525 _526 _527-> (let _528 = (u (u fm_parser_name1 _525) _526) in (case _528 of {(0,f) -> u f (\_529 _530 _531-> (u (u (u parser_reply_error _529) _530) _531)); (1,f) -> u f (\_532 _533 _534-> (let _535 = (u (u (u fm_parser_text "=") _532) _533) in (case _535 of {(0,f) -> u f (\_536 _537 _538-> (u (u (u parser_reply_error _536) _537) _538)); (1,f) -> u f (\_539 _540 _541-> (let _542 = (u (u (u fm_parser_text "for ") _539) _540) in (case _542 of {(0,f) -> u f (\_543 _544 _545-> (u (u (u parser_reply_error _543) _544) _545)); (1,f) -> u f (\_546 _547 _548-> (let _549 = (u (u fm_parser_name1 _546) _547) in (case _549 of {(0,f) -> u f (\_550 _551 _552-> (u (u (u parser_reply_error _550) _551) _552)); (1,f) -> u f (\_553 _554 _555-> (let _556 = (u (u (u fm_parser_text ":") _553) _554) in (case _556 of {(0,f) -> u f (\_557 _558 _559-> (u (u (u parser_reply_error _557) _558) _559)); (1,f) -> u f (\_560 _561 _562-> (let _563 = (u (u (u fm_parser_text "U32") _560) _561) in (case _563 of {(0,f) -> u f (\_564 _565 _566-> (u (u (u parser_reply_error _564) _565) _566)); (1,f) -> u f (\_567 _568 _569-> (let _570 = (u (u (u fm_parser_text "=") _567) _568) in (case _570 of {(0,f) -> u f (\_571 _572 _573-> (u (u (u parser_reply_error _571) _572) _573)); (1,f) -> u f (\_574 _575 _576-> (let _577 = (u (u fm_parser_term _574) _575) in (case _577 of {(0,f) -> u f (\_578 _579 _580-> (u (u (u parser_reply_error _578) _579) _580)); (1,f) -> u f (\_581 _582 _583-> (let _584 = (u (u (u fm_parser_text "..") _581) _582) in (case _584 of {(0,f) -> u f (\_585 _586 _587-> (u (u (u parser_reply_error _585) _586) _587)); (1,f) -> u f (\_588 _589 _590-> (let _591 = (u (u fm_parser_term _588) _589) in (case _591 of {(0,f) -> u f (\_592 _593 _594-> (u (u (u parser_reply_error _592) _593) _594)); (1,f) -> u f (\_595 _596 _597-> (let _598 = (u (u (u fm_parser_text ":") _595) _596) in (case _598 of {(0,f) -> u f (\_599 _600 _601-> (u (u (u parser_reply_error _599) _600) _601)); (1,f) -> u f (\_602 _603 _604-> (let _605 = (u (u fm_parser_term _602) _603) in (case _605 of {(0,f) -> u f (\_606 _607 _608-> (u (u (u parser_reply_error _606) _607) _608)); (1,f) -> u f (\_609 _610 _611-> (let _612 = (u (u (u parser_maybe (u fm_parser_text ";")) _609) _610) in (case _612 of {(0,f) -> u f (\_613 _614 _615-> (u (u (u parser_reply_error _613) _614) _615)); (1,f) -> u f (\_616 _617 _618-> (let _619 = (u (u fm_parser_term _616) _617) in (case _619 of {(0,f) -> u f (\_620 _621 _622-> (u (u (u parser_reply_error _620) _621) _622)); (1,f) -> u f (\_623 _624 _625-> (let _626 = (u (u (u fm_parser_stop _520) _623) _624) in (case _626 of {(0,f) -> u f (\_627 _628 _629-> (u (u (u parser_reply_error _627) _628) _629)); (1,f) -> u f (\_630 _631 _632-> (let _term_54=(u fm_term_ref "U32.for") in (let _term_55=(u (u fm_term_app _term_54) (u fm_term_hol bits_e)) in (let _term_56=(u (u fm_term_app _term_55) (u fm_term_ref _534)) in (let _term_57=(u (u fm_term_app _term_56) _583) in (let _term_58=(u (u fm_term_app _term_57) _597) in (let _lamb_59=(u (u fm_term_lam _555) (\_e_59-> (u (u fm_term_lam _534) (\_s_60-> _611)))) in (let _term_60=(u (u fm_term_app _term_58) _lamb_59) in (let _term_61=(u (u (u fm_term_let _534) _term_60) (\_x_61-> _625)) in (u (u (u parser_reply_value _630) _631) (u (u fm_term_ori _632) _term_61))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_letforin = (\_idx_1-> (\_code_2-> (let _633 = (u (u fm_parser_init _idx_1) _code_2) in (case _633 of {(0,f) -> u f (\_634 _635 _636-> (u (u (u parser_reply_error _634) _635) _636)); (1,f) -> u f (\_637 _638 _639-> (let _640 = (u (u (u fm_parser_text "let ") _637) _638) in (case _640 of {(0,f) -> u f (\_641 _642 _643-> (u (u (u parser_reply_error _641) _642) _643)); (1,f) -> u f (\_644 _645 _646-> (let _647 = (u (u fm_parser_name1 _644) _645) in (case _647 of {(0,f) -> u f (\_648 _649 _650-> (u (u (u parser_reply_error _648) _649) _650)); (1,f) -> u f (\_651 _652 _653-> (let _654 = (u (u (u fm_parser_text "=") _651) _652) in (case _654 of {(0,f) -> u f (\_655 _656 _657-> (u (u (u parser_reply_error _655) _656) _657)); (1,f) -> u f (\_658 _659 _660-> (let _661 = (u (u (u fm_parser_text "for ") _658) _659) in (case _661 of {(0,f) -> u f (\_662 _663 _664-> (u (u (u parser_reply_error _662) _663) _664)); (1,f) -> u f (\_665 _666 _667-> (let _668 = (u (u fm_parser_name1 _665) _666) in (case _668 of {(0,f) -> u f (\_669 _670 _671-> (u (u (u parser_reply_error _669) _670) _671)); (1,f) -> u f (\_672 _673 _674-> (let _675 = (u (u (u fm_parser_text "in") _672) _673) in (case _675 of {(0,f) -> u f (\_676 _677 _678-> (u (u (u parser_reply_error _676) _677) _678)); (1,f) -> u f (\_679 _680 _681-> (let _682 = (u (u fm_parser_term _679) _680) in (case _682 of {(0,f) -> u f (\_683 _684 _685-> (u (u (u parser_reply_error _683) _684) _685)); (1,f) -> u f (\_686 _687 _688-> (let _689 = (u (u (u fm_parser_text ":") _686) _687) in (case _689 of {(0,f) -> u f (\_690 _691 _692-> (u (u (u parser_reply_error _690) _691) _692)); (1,f) -> u f (\_693 _694 _695-> (let _696 = (u (u fm_parser_term _693) _694) in (case _696 of {(0,f) -> u f (\_697 _698 _699-> (u (u (u parser_reply_error _697) _698) _699)); (1,f) -> u f (\_700 _701 _702-> (let _703 = (u (u (u parser_maybe (u fm_parser_text ";")) _700) _701) in (case _703 of {(0,f) -> u f (\_704 _705 _706-> (u (u (u parser_reply_error _704) _705) _706)); (1,f) -> u f (\_707 _708 _709-> (let _710 = (u (u fm_parser_term _707) _708) in (case _710 of {(0,f) -> u f (\_711 _712 _713-> (u (u (u parser_reply_error _711) _712) _713)); (1,f) -> u f (\_714 _715 _716-> (let _717 = (u (u (u fm_parser_stop _639) _714) _715) in (case _717 of {(0,f) -> u f (\_718 _719 _720-> (u (u (u parser_reply_error _718) _719) _720)); (1,f) -> u f (\_721 _722 _723-> (let _term_42=(u fm_term_ref "List.for") in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_hol bits_e)) in (let _term_44=(u (u fm_term_app _term_43) _688) in (let _term_45=(u (u fm_term_app _term_44) (u fm_term_hol bits_e)) in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_ref _653)) in (let _lamb_47=(u (u fm_term_lam _674) (\_i_47-> (u (u fm_term_lam _653) (\_x_48-> _702)))) in (let _term_48=(u (u fm_term_app _term_46) _lamb_47) in (let _term_49=(u (u (u fm_term_let _653) _term_48) (\_x_49-> _716)) in (u (u (u parser_reply_value _721) _722) (u (u fm_term_ori _723) _term_49))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_let = (\_idx_1-> (\_code_2-> (let _724 = (u (u fm_parser_init _idx_1) _code_2) in (case _724 of {(0,f) -> u f (\_725 _726 _727-> (u (u (u parser_reply_error _725) _726) _727)); (1,f) -> u f (\_728 _729 _730-> (let _731 = (u (u (u fm_parser_text "let ") _728) _729) in (case _731 of {(0,f) -> u f (\_732 _733 _734-> (u (u (u parser_reply_error _732) _733) _734)); (1,f) -> u f (\_735 _736 _737-> (let _738 = (u (u fm_parser_name _735) _736) in (case _738 of {(0,f) -> u f (\_739 _740 _741-> (u (u (u parser_reply_error _739) _740) _741)); (1,f) -> u f (\_742 _743 _744-> (let _745 = (u (u (u fm_parser_text "=") _742) _743) in (case _745 of {(0,f) -> u f (\_746 _747 _748-> (u (u (u parser_reply_error _746) _747) _748)); (1,f) -> u f (\_749 _750 _751-> (let _752 = (u (u fm_parser_term _749) _750) in (case _752 of {(0,f) -> u f (\_753 _754 _755-> (u (u (u parser_reply_error _753) _754) _755)); (1,f) -> u f (\_756 _757 _758-> (let _759 = (u (u (u parser_maybe (u fm_parser_text ";")) _756) _757) in (case _759 of {(0,f) -> u f (\_760 _761 _762-> (u (u (u parser_reply_error _760) _761) _762)); (1,f) -> u f (\_763 _764 _765-> (let _766 = (u (u fm_parser_term _763) _764) in (case _766 of {(0,f) -> u f (\_767 _768 _769-> (u (u (u parser_reply_error _767) _768) _769)); (1,f) -> u f (\_770 _771 _772-> (let _773 = (u (u (u fm_parser_stop _730) _770) _771) in (case _773 of {(0,f) -> u f (\_774 _775 _776-> (u (u (u parser_reply_error _774) _775) _776)); (1,f) -> u f (\_777 _778 _779-> (u (u (u parser_reply_value _777) _778) (u (u fm_term_ori _779) (u (u (u fm_term_let _744) _758) (\_x_27-> _772))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_get = (\_idx_1-> (\_code_2-> (let _780 = (u (u fm_parser_init _idx_1) _code_2) in (case _780 of {(0,f) -> u f (\_781 _782 _783-> (u (u (u parser_reply_error _781) _782) _783)); (1,f) -> u f (\_784 _785 _786-> (let _787 = (u (u (u fm_parser_text "let ") _784) _785) in (case _787 of {(0,f) -> u f (\_788 _789 _790-> (u (u (u parser_reply_error _788) _789) _790)); (1,f) -> u f (\_791 _792 _793-> (let _794 = (u (u (u fm_parser_text "{") _791) _792) in (case _794 of {(0,f) -> u f (\_795 _796 _797-> (u (u (u parser_reply_error _795) _796) _797)); (1,f) -> u f (\_798 _799 _800-> (let _801 = (u (u fm_parser_name _798) _799) in (case _801 of {(0,f) -> u f (\_802 _803 _804-> (u (u (u parser_reply_error _802) _803) _804)); (1,f) -> u f (\_805 _806 _807-> (let _808 = (u (u (u fm_parser_text ",") _805) _806) in (case _808 of {(0,f) -> u f (\_809 _810 _811-> (u (u (u parser_reply_error _809) _810) _811)); (1,f) -> u f (\_812 _813 _814-> (let _815 = (u (u fm_parser_name _812) _813) in (case _815 of {(0,f) -> u f (\_816 _817 _818-> (u (u (u parser_reply_error _816) _817) _818)); (1,f) -> u f (\_819 _820 _821-> (let _822 = (u (u (u fm_parser_text "}") _819) _820) in (case _822 of {(0,f) -> u f (\_823 _824 _825-> (u (u (u parser_reply_error _823) _824) _825)); (1,f) -> u f (\_826 _827 _828-> (let _829 = (u (u (u fm_parser_text "=") _826) _827) in (case _829 of {(0,f) -> u f (\_830 _831 _832-> (u (u (u parser_reply_error _830) _831) _832)); (1,f) -> u f (\_833 _834 _835-> (let _836 = (u (u fm_parser_term _833) _834) in (case _836 of {(0,f) -> u f (\_837 _838 _839-> (u (u (u parser_reply_error _837) _838) _839)); (1,f) -> u f (\_840 _841 _842-> (let _843 = (u (u (u parser_maybe (u fm_parser_text ";")) _840) _841) in (case _843 of {(0,f) -> u f (\_844 _845 _846-> (u (u (u parser_reply_error _844) _845) _846)); (1,f) -> u f (\_847 _848 _849-> (let _850 = (u (u fm_parser_term _847) _848) in (case _850 of {(0,f) -> u f (\_851 _852 _853-> (u (u (u parser_reply_error _851) _852) _853)); (1,f) -> u f (\_854 _855 _856-> (let _857 = (u (u (u fm_parser_stop _786) _854) _855) in (case _857 of {(0,f) -> u f (\_858 _859 _860-> (u (u (u parser_reply_error _858) _859) _860)); (1,f) -> u f (\_861 _862 _863-> (let _term_39=_842 in (let _term_40=(u (u fm_term_app _term_39) (u (u fm_term_lam "x") (\_x_40-> (u fm_term_hol bits_e)))) in (let _term_41=(u (u fm_term_app _term_40) (u (u fm_term_lam _807) (\_x_41-> (u (u fm_term_lam _821) (\_y_42-> _856))))) in (u (u (u parser_reply_value _861) _862) (u (u fm_term_ori _863) _term_41)))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_term_def = (\_name_1-> (\_expr_2-> (\_body_3-> (7,\t-> t _name_1 _expr_2 _body_3))))
fm_parser_def = (\_idx_1-> (\_code_2-> (let _864 = (u (u fm_parser_init _idx_1) _code_2) in (case _864 of {(0,f) -> u f (\_865 _866 _867-> (u (u (u parser_reply_error _865) _866) _867)); (1,f) -> u f (\_868 _869 _870-> (let _871 = (u (u (u fm_parser_text "def ") _868) _869) in (case _871 of {(0,f) -> u f (\_872 _873 _874-> (u (u (u parser_reply_error _872) _873) _874)); (1,f) -> u f (\_875 _876 _877-> (let _878 = (u (u fm_parser_name _875) _876) in (case _878 of {(0,f) -> u f (\_879 _880 _881-> (u (u (u parser_reply_error _879) _880) _881)); (1,f) -> u f (\_882 _883 _884-> (let _885 = (u (u (u fm_parser_text "=") _882) _883) in (case _885 of {(0,f) -> u f (\_886 _887 _888-> (u (u (u parser_reply_error _886) _887) _888)); (1,f) -> u f (\_889 _890 _891-> (let _892 = (u (u fm_parser_term _889) _890) in (case _892 of {(0,f) -> u f (\_893 _894 _895-> (u (u (u parser_reply_error _893) _894) _895)); (1,f) -> u f (\_896 _897 _898-> (let _899 = (u (u (u parser_maybe (u fm_parser_text ";")) _896) _897) in (case _899 of {(0,f) -> u f (\_900 _901 _902-> (u (u (u parser_reply_error _900) _901) _902)); (1,f) -> u f (\_903 _904 _905-> (let _906 = (u (u fm_parser_term _903) _904) in (case _906 of {(0,f) -> u f (\_907 _908 _909-> (u (u (u parser_reply_error _907) _908) _909)); (1,f) -> u f (\_910 _911 _912-> (let _913 = (u (u (u fm_parser_stop _870) _910) _911) in (case _913 of {(0,f) -> u f (\_914 _915 _916-> (u (u (u parser_reply_error _914) _915) _916)); (1,f) -> u f (\_917 _918 _919-> (u (u (u parser_reply_value _917) _918) (u (u fm_term_ori _919) (u (u (u fm_term_def _884) _898) (\_x_27-> _912))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_if = (\_idx_1-> (\_code_2-> (let _920 = (u (u fm_parser_init _idx_1) _code_2) in (case _920 of {(0,f) -> u f (\_921 _922 _923-> (u (u (u parser_reply_error _921) _922) _923)); (1,f) -> u f (\_924 _925 _926-> (let _927 = (u (u (u fm_parser_text "if ") _924) _925) in (case _927 of {(0,f) -> u f (\_928 _929 _930-> (u (u (u parser_reply_error _928) _929) _930)); (1,f) -> u f (\_931 _932 _933-> (let _934 = (u (u fm_parser_term _931) _932) in (case _934 of {(0,f) -> u f (\_935 _936 _937-> (u (u (u parser_reply_error _935) _936) _937)); (1,f) -> u f (\_938 _939 _940-> (let _941 = (u (u (u fm_parser_text "then") _938) _939) in (case _941 of {(0,f) -> u f (\_942 _943 _944-> (u (u (u parser_reply_error _942) _943) _944)); (1,f) -> u f (\_945 _946 _947-> (let _948 = (u (u fm_parser_term _945) _946) in (case _948 of {(0,f) -> u f (\_949 _950 _951-> (u (u (u parser_reply_error _949) _950) _951)); (1,f) -> u f (\_952 _953 _954-> (let _955 = (u (u (u fm_parser_text "else") _952) _953) in (case _955 of {(0,f) -> u f (\_956 _957 _958-> (u (u (u parser_reply_error _956) _957) _958)); (1,f) -> u f (\_959 _960 _961-> (let _962 = (u (u fm_parser_term _959) _960) in (case _962 of {(0,f) -> u f (\_963 _964 _965-> (u (u (u parser_reply_error _963) _964) _965)); (1,f) -> u f (\_966 _967 _968-> (let _969 = (u (u (u fm_parser_stop _926) _966) _967) in (case _969 of {(0,f) -> u f (\_970 _971 _972-> (u (u (u parser_reply_error _970) _971) _972)); (1,f) -> u f (\_973 _974 _975-> (let _term_27=_940 in (let _term_28=(u (u fm_term_app _term_27) (u (u fm_term_lam "") (\_x_28-> (u fm_term_hol bits_e)))) in (let _term_29=(u (u fm_term_app _term_28) _954) in (let _term_30=(u (u fm_term_app _term_29) _968) in (u (u (u parser_reply_value _973) _974) (u (u fm_term_ori _975) _term_30))))))); }))); }))); }))); }))); }))); }))); }))); }))))
list_mapped = (\_as_2-> (\_f_4-> (let _976 = _as_2 in (case _976 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_977 _978-> (u (u list_cons (u _f_4 _977)) (u (u list_mapped _978) _f_4))); }))))
fm_backslash = 92
fm_escapes = (u (u list_cons (u (u pair_new "\\b") 8)) (u (u list_cons (u (u pair_new "\\f") 12)) (u (u list_cons (u (u pair_new "\\n") 10)) (u (u list_cons (u (u pair_new "\\r") 13)) (u (u list_cons (u (u pair_new "\\t") 9)) (u (u list_cons (u (u pair_new "\\v") 11)) (u (u list_cons (u (u pair_new (u (u string_cons fm_backslash) (u (u string_cons fm_backslash) string_nil))) fm_backslash)) (u (u list_cons (u (u pair_new "\\\"") 34)) (u (u list_cons (u (u pair_new "\\0") 0)) (u (u list_cons (u (u pair_new "\\'") 39)) list_nil))))))))))
fm_parser_char_single = (u parser_first_of (u (u list_cons (u parser_first_of (u (u list_mapped fm_escapes) (\_esc_1-> (let _979 = _esc_1 in (case _979 of {(0,f) -> u f (\_980 _981-> (\_idx_4-> (\_code_5-> (let _982 = (u (u (u parser_text _980) _idx_4) _code_5) in (case _982 of {(0,f) -> u f (\_983 _984 _985-> (u (u (u parser_reply_error _983) _984) _985)); (1,f) -> u f (\_986 _987 _988-> (u (u (u parser_reply_value _986) _987) _981)); }))))); })))))) (u (u list_cons parser_one) list_nil)))
fm_term_chr = (\_chrx_1-> (12,\t-> t _chrx_1))
fm_parser_char = (\_idx_1-> (\_code_2-> (let _989 = (u (u fm_parser_init _idx_1) _code_2) in (case _989 of {(0,f) -> u f (\_990 _991 _992-> (u (u (u parser_reply_error _990) _991) _992)); (1,f) -> u f (\_993 _994 _995-> (let _996 = (u (u (u fm_parser_text "'") _993) _994) in (case _996 of {(0,f) -> u f (\_997 _998 _999-> (u (u (u parser_reply_error _997) _998) _999)); (1,f) -> u f (\_1000 _1001 _1002-> (let _1003 = (u (u fm_parser_char_single _1000) _1001) in (case _1003 of {(0,f) -> u f (\_1004 _1005 _1006-> (u (u (u parser_reply_error _1004) _1005) _1006)); (1,f) -> u f (\_1007 _1008 _1009-> (let _1010 = (u (u (u parser_text "'") _1007) _1008) in (case _1010 of {(0,f) -> u f (\_1011 _1012 _1013-> (u (u (u parser_reply_error _1011) _1012) _1013)); (1,f) -> u f (\_1014 _1015 _1016-> (let _1017 = (u (u (u fm_parser_stop _995) _1014) _1015) in (case _1017 of {(0,f) -> u f (\_1018 _1019 _1020-> (u (u (u parser_reply_error _1018) _1019) _1020)); (1,f) -> u f (\_1021 _1022 _1023-> (u (u (u parser_reply_value _1021) _1022) (u (u fm_term_ori _1023) (u fm_term_chr _1009)))); }))); }))); }))); }))); }))))
string_reverse_go = (\_xs_1-> (\_res_2-> (let _1024 = _xs_1 in (if null (_1024::String) then _res_2 else (u (u string_reverse_go (tail _1024)) (u (u string_cons (fromIntegral (fromEnum (head _1024 :: Char)) :: Word16)) _res_2))))))
string_reverse = (\_xs_1-> (u (u string_reverse_go _xs_1) string_nil))
fm_parser_string_go = (\_str_1-> (\_idx_2-> (\_code_3-> (let _1025 = _code_3 in (if null (_1025::String) then (u (u (u parser_reply_error _idx_2) _code_3) "Non-terminating string.") else (let _1026 = ((((fromIntegral (fromEnum (head _1025 :: Char)) :: Word16)::Word16) == 34)) in (if _1026 then (u (u (u parser_reply_value (u nat_succ _idx_2)) (tail _1025)) (u string_reverse _str_1)) else (let _1027 = (u (u fm_parser_char_single _idx_2) _code_3) in (case _1027 of {(0,f) -> u f (\_1028 _1029 _1030-> (u (u (u parser_reply_error _1028) _1029) _1030)); (1,f) -> u f (\_1031 _1032 _1033-> (u (u (u fm_parser_string_go (u (u string_cons _1033) _str_1)) _1031) _1032)); })))))))))
fm_term_str = (\_strx_1-> (13,\t-> t _strx_1))
fm_parser_string = (\_idx_1-> (\_code_2-> (let _1034 = (u (u fm_parser_init _idx_1) _code_2) in (case _1034 of {(0,f) -> u f (\_1035 _1036 _1037-> (u (u (u parser_reply_error _1035) _1036) _1037)); (1,f) -> u f (\_1038 _1039 _1040-> (let _1041 = (u (u (u fm_parser_text (u (u string_cons 34) string_nil)) _1038) _1039) in (case _1041 of {(0,f) -> u f (\_1042 _1043 _1044-> (u (u (u parser_reply_error _1042) _1043) _1044)); (1,f) -> u f (\_1045 _1046 _1047-> (let _1048 = (u (u (u fm_parser_string_go "") _1045) _1046) in (case _1048 of {(0,f) -> u f (\_1049 _1050 _1051-> (u (u (u parser_reply_error _1049) _1050) _1051)); (1,f) -> u f (\_1052 _1053 _1054-> (let _1055 = (u (u (u fm_parser_stop _1040) _1052) _1053) in (case _1055 of {(0,f) -> u f (\_1056 _1057 _1058-> (u (u (u parser_reply_error _1056) _1057) _1058)); (1,f) -> u f (\_1059 _1060 _1061-> (u (u (u parser_reply_value _1059) _1060) (u (u fm_term_ori _1061) (u fm_term_str _1054)))); }))); }))); }))); }))))
fm_parser_pair = (\_idx_1-> (\_code_2-> (let _1062 = (u (u fm_parser_init _idx_1) _code_2) in (case _1062 of {(0,f) -> u f (\_1063 _1064 _1065-> (u (u (u parser_reply_error _1063) _1064) _1065)); (1,f) -> u f (\_1066 _1067 _1068-> (let _1069 = (u (u (u fm_parser_text "{") _1066) _1067) in (case _1069 of {(0,f) -> u f (\_1070 _1071 _1072-> (u (u (u parser_reply_error _1070) _1071) _1072)); (1,f) -> u f (\_1073 _1074 _1075-> (let _1076 = (u (u fm_parser_term _1073) _1074) in (case _1076 of {(0,f) -> u f (\_1077 _1078 _1079-> (u (u (u parser_reply_error _1077) _1078) _1079)); (1,f) -> u f (\_1080 _1081 _1082-> (let _1083 = (u (u (u fm_parser_text ",") _1080) _1081) in (case _1083 of {(0,f) -> u f (\_1084 _1085 _1086-> (u (u (u parser_reply_error _1084) _1085) _1086)); (1,f) -> u f (\_1087 _1088 _1089-> (let _1090 = (u (u fm_parser_term _1087) _1088) in (case _1090 of {(0,f) -> u f (\_1091 _1092 _1093-> (u (u (u parser_reply_error _1091) _1092) _1093)); (1,f) -> u f (\_1094 _1095 _1096-> (let _1097 = (u (u (u fm_parser_text "}") _1094) _1095) in (case _1097 of {(0,f) -> u f (\_1098 _1099 _1100-> (u (u (u parser_reply_error _1098) _1099) _1100)); (1,f) -> u f (\_1101 _1102 _1103-> (let _1104 = (u (u (u fm_parser_stop _1068) _1101) _1102) in (case _1104 of {(0,f) -> u f (\_1105 _1106 _1107-> (u (u (u parser_reply_error _1105) _1106) _1107)); (1,f) -> u f (\_1108 _1109 _1110-> (let _term_24=(u fm_term_ref "Pair.new") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) _1082) in (let _term_28=(u (u fm_term_app _term_27) _1096) in (u (u (u parser_reply_value _1108) _1109) (u (u fm_term_ori _1110) _term_28)))))))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_sigma_type = (\_idx_1-> (\_code_2-> (let _1111 = (u (u fm_parser_init _idx_1) _code_2) in (case _1111 of {(0,f) -> u f (\_1112 _1113 _1114-> (u (u (u parser_reply_error _1112) _1113) _1114)); (1,f) -> u f (\_1115 _1116 _1117-> (let _1118 = (u (u (u fm_parser_text "{") _1115) _1116) in (case _1118 of {(0,f) -> u f (\_1119 _1120 _1121-> (u (u (u parser_reply_error _1119) _1120) _1121)); (1,f) -> u f (\_1122 _1123 _1124-> (let _1125 = (u (u fm_parser_name1 _1122) _1123) in (case _1125 of {(0,f) -> u f (\_1126 _1127 _1128-> (u (u (u parser_reply_error _1126) _1127) _1128)); (1,f) -> u f (\_1129 _1130 _1131-> (let _1132 = (u (u (u fm_parser_text ":") _1129) _1130) in (case _1132 of {(0,f) -> u f (\_1133 _1134 _1135-> (u (u (u parser_reply_error _1133) _1134) _1135)); (1,f) -> u f (\_1136 _1137 _1138-> (let _1139 = (u (u fm_parser_term _1136) _1137) in (case _1139 of {(0,f) -> u f (\_1140 _1141 _1142-> (u (u (u parser_reply_error _1140) _1141) _1142)); (1,f) -> u f (\_1143 _1144 _1145-> (let _1146 = (u (u (u fm_parser_text "}") _1143) _1144) in (case _1146 of {(0,f) -> u f (\_1147 _1148 _1149-> (u (u (u parser_reply_error _1147) _1148) _1149)); (1,f) -> u f (\_1150 _1151 _1152-> (let _1153 = (u (u fm_parser_term _1150) _1151) in (case _1153 of {(0,f) -> u f (\_1154 _1155 _1156-> (u (u (u parser_reply_error _1154) _1155) _1156)); (1,f) -> u f (\_1157 _1158 _1159-> (let _1160 = (u (u (u fm_parser_stop _1117) _1157) _1158) in (case _1160 of {(0,f) -> u f (\_1161 _1162 _1163-> (u (u (u parser_reply_error _1161) _1162) _1163)); (1,f) -> u f (\_1164 _1165 _1166-> (let _term_27=(u fm_term_ref "Sigma") in (let _term_28=(u (u fm_term_app _term_27) _1145) in (let _term_29=(u (u fm_term_app _term_28) (u (u fm_term_lam _1131) (\_x_29-> _1159))) in (u (u (u parser_reply_value _1164) _1165) (u (u fm_term_ori _1166) _term_29)))))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_some = (\_idx_1-> (\_code_2-> (let _1167 = (u (u fm_parser_init _idx_1) _code_2) in (case _1167 of {(0,f) -> u f (\_1168 _1169 _1170-> (u (u (u parser_reply_error _1168) _1169) _1170)); (1,f) -> u f (\_1171 _1172 _1173-> (let _1174 = (u (u (u fm_parser_text "some(") _1171) _1172) in (case _1174 of {(0,f) -> u f (\_1175 _1176 _1177-> (u (u (u parser_reply_error _1175) _1176) _1177)); (1,f) -> u f (\_1178 _1179 _1180-> (let _1181 = (u (u fm_parser_term _1178) _1179) in (case _1181 of {(0,f) -> u f (\_1182 _1183 _1184-> (u (u (u parser_reply_error _1182) _1183) _1184)); (1,f) -> u f (\_1185 _1186 _1187-> (let _1188 = (u (u (u fm_parser_text ")") _1185) _1186) in (case _1188 of {(0,f) -> u f (\_1189 _1190 _1191-> (u (u (u parser_reply_error _1189) _1190) _1191)); (1,f) -> u f (\_1192 _1193 _1194-> (let _1195 = (u (u (u fm_parser_stop _1173) _1192) _1193) in (case _1195 of {(0,f) -> u f (\_1196 _1197 _1198-> (u (u (u parser_reply_error _1196) _1197) _1198)); (1,f) -> u f (\_1199 _1200 _1201-> (let _term_18=(u fm_term_ref "Maybe.some") in (let _term_19=(u (u fm_term_app _term_18) (u fm_term_hol bits_e)) in (let _term_20=(u (u fm_term_app _term_19) _1187) in (u (u (u parser_reply_value _1199) _1200) (u (u fm_term_ori _1201) _term_20)))))); }))); }))); }))); }))); }))))
fm_parser_apply = (\_idx_1-> (\_code_2-> (let _1202 = (u (u fm_parser_init _idx_1) _code_2) in (case _1202 of {(0,f) -> u f (\_1203 _1204 _1205-> (u (u (u parser_reply_error _1203) _1204) _1205)); (1,f) -> u f (\_1206 _1207 _1208-> (let _1209 = (u (u (u fm_parser_text "apply(") _1206) _1207) in (case _1209 of {(0,f) -> u f (\_1210 _1211 _1212-> (u (u (u parser_reply_error _1210) _1211) _1212)); (1,f) -> u f (\_1213 _1214 _1215-> (let _1216 = (u (u fm_parser_term _1213) _1214) in (case _1216 of {(0,f) -> u f (\_1217 _1218 _1219-> (u (u (u parser_reply_error _1217) _1218) _1219)); (1,f) -> u f (\_1220 _1221 _1222-> (let _1223 = (u (u (u fm_parser_text ",") _1220) _1221) in (case _1223 of {(0,f) -> u f (\_1224 _1225 _1226-> (u (u (u parser_reply_error _1224) _1225) _1226)); (1,f) -> u f (\_1227 _1228 _1229-> (let _1230 = (u (u fm_parser_term _1227) _1228) in (case _1230 of {(0,f) -> u f (\_1231 _1232 _1233-> (u (u (u parser_reply_error _1231) _1232) _1233)); (1,f) -> u f (\_1234 _1235 _1236-> (let _1237 = (u (u (u fm_parser_text ")") _1234) _1235) in (case _1237 of {(0,f) -> u f (\_1238 _1239 _1240-> (u (u (u parser_reply_error _1238) _1239) _1240)); (1,f) -> u f (\_1241 _1242 _1243-> (let _1244 = (u (u (u fm_parser_stop _1208) _1241) _1242) in (case _1244 of {(0,f) -> u f (\_1245 _1246 _1247-> (u (u (u parser_reply_error _1245) _1246) _1247)); (1,f) -> u f (\_1248 _1249 _1250-> (let _term_24=(u fm_term_ref "Equal.apply") in (let _term_25=(u (u fm_term_app _term_24) (u fm_term_hol bits_e)) in (let _term_26=(u (u fm_term_app _term_25) (u fm_term_hol bits_e)) in (let _term_27=(u (u fm_term_app _term_26) (u fm_term_hol bits_e)) in (let _term_28=(u (u fm_term_app _term_27) (u fm_term_hol bits_e)) in (let _term_29=(u (u fm_term_app _term_28) _1222) in (let _term_30=(u (u fm_term_app _term_29) _1236) in (u (u (u parser_reply_value _1248) _1249) (u (u fm_term_ori _1250) _term_30)))))))))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_mirror = (\_idx_1-> (\_code_2-> (let _1251 = (u (u fm_parser_init _idx_1) _code_2) in (case _1251 of {(0,f) -> u f (\_1252 _1253 _1254-> (u (u (u parser_reply_error _1252) _1253) _1254)); (1,f) -> u f (\_1255 _1256 _1257-> (let _1258 = (u (u (u fm_parser_text "mirror(") _1255) _1256) in (case _1258 of {(0,f) -> u f (\_1259 _1260 _1261-> (u (u (u parser_reply_error _1259) _1260) _1261)); (1,f) -> u f (\_1262 _1263 _1264-> (let _1265 = (u (u fm_parser_term _1262) _1263) in (case _1265 of {(0,f) -> u f (\_1266 _1267 _1268-> (u (u (u parser_reply_error _1266) _1267) _1268)); (1,f) -> u f (\_1269 _1270 _1271-> (let _1272 = (u (u (u fm_parser_text ")") _1269) _1270) in (case _1272 of {(0,f) -> u f (\_1273 _1274 _1275-> (u (u (u parser_reply_error _1273) _1274) _1275)); (1,f) -> u f (\_1276 _1277 _1278-> (let _1279 = (u (u (u fm_parser_stop _1257) _1276) _1277) in (case _1279 of {(0,f) -> u f (\_1280 _1281 _1282-> (u (u (u parser_reply_error _1280) _1281) _1282)); (1,f) -> u f (\_1283 _1284 _1285-> (let _term_18=(u fm_term_ref "Equal.mirror") in (let _term_19=(u (u fm_term_app _term_18) (u fm_term_hol bits_e)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_hol bits_e)) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) _1271) in (u (u (u parser_reply_value _1283) _1284) (u (u fm_term_ori _1285) _term_22)))))))); }))); }))); }))); }))); }))))
fm_name_read = (\_str_1-> _str_1)
fm_parser_list = (\_idx_1-> (\_code_2-> (let _1286 = (u (u fm_parser_init _idx_1) _code_2) in (case _1286 of {(0,f) -> u f (\_1287 _1288 _1289-> (u (u (u parser_reply_error _1287) _1288) _1289)); (1,f) -> u f (\_1290 _1291 _1292-> (let _1293 = (u (u (u fm_parser_text "[") _1290) _1291) in (case _1293 of {(0,f) -> u f (\_1294 _1295 _1296-> (u (u (u parser_reply_error _1294) _1295) _1296)); (1,f) -> u f (\_1297 _1298 _1299-> (let _1300 = (u (u (u (u parser_until (u fm_parser_text "]")) (u fm_parser_item fm_parser_term)) _1297) _1298) in (case _1300 of {(0,f) -> u f (\_1301 _1302 _1303-> (u (u (u parser_reply_error _1301) _1302) _1303)); (1,f) -> u f (\_1304 _1305 _1306-> (let _1307 = (u (u (u fm_parser_stop _1292) _1304) _1305) in (case _1307 of {(0,f) -> u f (\_1308 _1309 _1310-> (u (u (u parser_reply_error _1308) _1309) _1310)); (1,f) -> u f (\_1311 _1312 _1313-> (u (u (u parser_reply_value _1311) _1312) (u (u (u list_fold _1306) (u (u fm_term_app (u fm_term_ref (u fm_name_read "List.nil"))) (u fm_term_hol bits_e))) (\_x_15-> (\_xs_16-> (let _term_17=(u fm_term_ref (u fm_name_read "List.cons")) in (let _term_18=(u (u fm_term_app _term_17) (u fm_term_hol bits_e)) in (let _term_19=(u (u fm_term_app _term_18) _x_15) in (let _term_20=(u (u fm_term_app _term_19) _xs_16) in (u (u fm_term_ori _1313) _term_20)))))))))); }))); }))); }))); }))))
fm_parser_log = (\_idx_1-> (\_code_2-> (let _1314 = (u (u fm_parser_init _idx_1) _code_2) in (case _1314 of {(0,f) -> u f (\_1315 _1316 _1317-> (u (u (u parser_reply_error _1315) _1316) _1317)); (1,f) -> u f (\_1318 _1319 _1320-> (let _1321 = (u (u (u fm_parser_text "log(") _1318) _1319) in (case _1321 of {(0,f) -> u f (\_1322 _1323 _1324-> (u (u (u parser_reply_error _1322) _1323) _1324)); (1,f) -> u f (\_1325 _1326 _1327-> (let _1328 = (u (u (u (u parser_until (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _1325) _1326) in (case _1328 of {(0,f) -> u f (\_1329 _1330 _1331-> (u (u (u parser_reply_error _1329) _1330) _1331)); (1,f) -> u f (\_1332 _1333 _1334-> (let _1335 = (u (u fm_parser_term _1332) _1333) in (case _1335 of {(0,f) -> u f (\_1336 _1337 _1338-> (u (u (u parser_reply_error _1336) _1337) _1338)); (1,f) -> u f (\_1339 _1340 _1341-> (let _term_15=(u fm_term_ref "Debug.log") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _args_17=(u (u (u list_fold _1334) (u fm_term_ref "String.nil")) (\_x_17-> (\_xs_18-> (let _arg_19=(u fm_term_ref "String.concat") in (let _arg_20=(u (u fm_term_app _arg_19) _x_17) in (let _arg_21=(u (u fm_term_app _arg_20) _xs_18) in _arg_21)))))) in (let _term_18=(u (u fm_term_app _term_16) _args_17) in (let _term_19=(u (u fm_term_app _term_18) (u (u fm_term_lam "x") (\_x_19-> _1341))) in (let _1342 = (u (u (u fm_parser_stop _1320) _1339) _1340) in (case _1342 of {(0,f) -> u f (\_1343 _1344 _1345-> (u (u (u parser_reply_error _1343) _1344) _1345)); (1,f) -> u f (\_1346 _1347 _1348-> (u (u (u parser_reply_value _1346) _1347) (u (u fm_term_ori _1348) _term_19))); })))))))); }))); }))); }))); }))))
fm_parser_forrange_u32 = (\_idx_1-> (\_code_2-> (let _1349 = (u (u fm_parser_init _idx_1) _code_2) in (case _1349 of {(0,f) -> u f (\_1350 _1351 _1352-> (u (u (u parser_reply_error _1350) _1351) _1352)); (1,f) -> u f (\_1353 _1354 _1355-> (let _1356 = (u (u (u fm_parser_text "for ") _1353) _1354) in (case _1356 of {(0,f) -> u f (\_1357 _1358 _1359-> (u (u (u parser_reply_error _1357) _1358) _1359)); (1,f) -> u f (\_1360 _1361 _1362-> (let _1363 = (u (u fm_parser_name1 _1360) _1361) in (case _1363 of {(0,f) -> u f (\_1364 _1365 _1366-> (u (u (u parser_reply_error _1364) _1365) _1366)); (1,f) -> u f (\_1367 _1368 _1369-> (let _1370 = (u (u (u fm_parser_text ":") _1367) _1368) in (case _1370 of {(0,f) -> u f (\_1371 _1372 _1373-> (u (u (u parser_reply_error _1371) _1372) _1373)); (1,f) -> u f (\_1374 _1375 _1376-> (let _1377 = (u (u (u fm_parser_text "U32") _1374) _1375) in (case _1377 of {(0,f) -> u f (\_1378 _1379 _1380-> (u (u (u parser_reply_error _1378) _1379) _1380)); (1,f) -> u f (\_1381 _1382 _1383-> (let _1384 = (u (u (u fm_parser_text "=") _1381) _1382) in (case _1384 of {(0,f) -> u f (\_1385 _1386 _1387-> (u (u (u parser_reply_error _1385) _1386) _1387)); (1,f) -> u f (\_1388 _1389 _1390-> (let _1391 = (u (u fm_parser_term _1388) _1389) in (case _1391 of {(0,f) -> u f (\_1392 _1393 _1394-> (u (u (u parser_reply_error _1392) _1393) _1394)); (1,f) -> u f (\_1395 _1396 _1397-> (let _1398 = (u (u (u fm_parser_text "..") _1395) _1396) in (case _1398 of {(0,f) -> u f (\_1399 _1400 _1401-> (u (u (u parser_reply_error _1399) _1400) _1401)); (1,f) -> u f (\_1402 _1403 _1404-> (let _1405 = (u (u fm_parser_term _1402) _1403) in (case _1405 of {(0,f) -> u f (\_1406 _1407 _1408-> (u (u (u parser_reply_error _1406) _1407) _1408)); (1,f) -> u f (\_1409 _1410 _1411-> (let _1412 = (u (u (u fm_parser_text "with") _1409) _1410) in (case _1412 of {(0,f) -> u f (\_1413 _1414 _1415-> (u (u (u parser_reply_error _1413) _1414) _1415)); (1,f) -> u f (\_1416 _1417 _1418-> (let _1419 = (u (u fm_parser_name1 _1416) _1417) in (case _1419 of {(0,f) -> u f (\_1420 _1421 _1422-> (u (u (u parser_reply_error _1420) _1421) _1422)); (1,f) -> u f (\_1423 _1424 _1425-> (let _1426 = (u (u (u fm_parser_text ":") _1423) _1424) in (case _1426 of {(0,f) -> u f (\_1427 _1428 _1429-> (u (u (u parser_reply_error _1427) _1428) _1429)); (1,f) -> u f (\_1430 _1431 _1432-> (let _1433 = (u (u fm_parser_term _1430) _1431) in (case _1433 of {(0,f) -> u f (\_1434 _1435 _1436-> (u (u (u parser_reply_error _1434) _1435) _1436)); (1,f) -> u f (\_1437 _1438 _1439-> (let _1440 = (u (u (u fm_parser_stop _1355) _1437) _1438) in (case _1440 of {(0,f) -> u f (\_1441 _1442 _1443-> (u (u (u parser_reply_error _1441) _1442) _1443)); (1,f) -> u f (\_1444 _1445 _1446-> (let _term_45=(u fm_term_ref "U32.for") in (let _term_46=(u (u fm_term_app _term_45) (u fm_term_hol bits_e)) in (let _term_47=(u (u fm_term_app _term_46) (u fm_term_ref _1425)) in (let _term_48=(u (u fm_term_app _term_47) _1397) in (let _term_49=(u (u fm_term_app _term_48) _1411) in (let _lamb_50=(u (u fm_term_lam _1369) (\_e_50-> (u (u fm_term_lam _1425) (\_s_51-> _1439)))) in (let _term_51=(u (u fm_term_app _term_49) _lamb_50) in (let _term_52=(u (u (u fm_term_let _1425) _term_51) (\_x_52-> (u fm_term_ref _1425))) in (u (u (u parser_reply_value _1444) _1445) (u (u fm_term_ori _1446) _term_52))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forrange_u32_2 = (\_idx_1-> (\_code_2-> (let _1447 = (u (u fm_parser_init _idx_1) _code_2) in (case _1447 of {(0,f) -> u f (\_1448 _1449 _1450-> (u (u (u parser_reply_error _1448) _1449) _1450)); (1,f) -> u f (\_1451 _1452 _1453-> (let _1454 = (u (u (u fm_parser_text "for ") _1451) _1452) in (case _1454 of {(0,f) -> u f (\_1455 _1456 _1457-> (u (u (u parser_reply_error _1455) _1456) _1457)); (1,f) -> u f (\_1458 _1459 _1460-> (let _1461 = (u (u fm_parser_name1 _1458) _1459) in (case _1461 of {(0,f) -> u f (\_1462 _1463 _1464-> (u (u (u parser_reply_error _1462) _1463) _1464)); (1,f) -> u f (\_1465 _1466 _1467-> (let _1468 = (u (u (u fm_parser_text ":") _1465) _1466) in (case _1468 of {(0,f) -> u f (\_1469 _1470 _1471-> (u (u (u parser_reply_error _1469) _1470) _1471)); (1,f) -> u f (\_1472 _1473 _1474-> (let _1475 = (u (u (u fm_parser_text "U32") _1472) _1473) in (case _1475 of {(0,f) -> u f (\_1476 _1477 _1478-> (u (u (u parser_reply_error _1476) _1477) _1478)); (1,f) -> u f (\_1479 _1480 _1481-> (let _1482 = (u (u (u fm_parser_text "=") _1479) _1480) in (case _1482 of {(0,f) -> u f (\_1483 _1484 _1485-> (u (u (u parser_reply_error _1483) _1484) _1485)); (1,f) -> u f (\_1486 _1487 _1488-> (let _1489 = (u (u fm_parser_term _1486) _1487) in (case _1489 of {(0,f) -> u f (\_1490 _1491 _1492-> (u (u (u parser_reply_error _1490) _1491) _1492)); (1,f) -> u f (\_1493 _1494 _1495-> (let _1496 = (u (u (u fm_parser_text "..") _1493) _1494) in (case _1496 of {(0,f) -> u f (\_1497 _1498 _1499-> (u (u (u parser_reply_error _1497) _1498) _1499)); (1,f) -> u f (\_1500 _1501 _1502-> (let _1503 = (u (u fm_parser_term _1500) _1501) in (case _1503 of {(0,f) -> u f (\_1504 _1505 _1506-> (u (u (u parser_reply_error _1504) _1505) _1506)); (1,f) -> u f (\_1507 _1508 _1509-> (let _1510 = (u (u (u fm_parser_text ":") _1507) _1508) in (case _1510 of {(0,f) -> u f (\_1511 _1512 _1513-> (u (u (u parser_reply_error _1511) _1512) _1513)); (1,f) -> u f (\_1514 _1515 _1516-> (let _1517 = (u (u fm_parser_name1 _1514) _1515) in (case _1517 of {(0,f) -> u f (\_1518 _1519 _1520-> (u (u (u parser_reply_error _1518) _1519) _1520)); (1,f) -> u f (\_1521 _1522 _1523-> (let _1524 = (u (u (u fm_parser_text "=") _1521) _1522) in (case _1524 of {(0,f) -> u f (\_1525 _1526 _1527-> (u (u (u parser_reply_error _1525) _1526) _1527)); (1,f) -> u f (\_1528 _1529 _1530-> (let _1531 = (u (u fm_parser_term _1528) _1529) in (case _1531 of {(0,f) -> u f (\_1532 _1533 _1534-> (u (u (u parser_reply_error _1532) _1533) _1534)); (1,f) -> u f (\_1535 _1536 _1537-> (let _1538 = (u (u (u parser_maybe (u fm_parser_text ";")) _1535) _1536) in (case _1538 of {(0,f) -> u f (\_1539 _1540 _1541-> (u (u (u parser_reply_error _1539) _1540) _1541)); (1,f) -> u f (\_1542 _1543 _1544-> (let _1545 = (u (u fm_parser_term _1542) _1543) in (case _1545 of {(0,f) -> u f (\_1546 _1547 _1548-> (u (u (u parser_reply_error _1546) _1547) _1548)); (1,f) -> u f (\_1549 _1550 _1551-> (let _1552 = (u (u (u fm_parser_stop _1453) _1549) _1550) in (case _1552 of {(0,f) -> u f (\_1553 _1554 _1555-> (u (u (u parser_reply_error _1553) _1554) _1555)); (1,f) -> u f (\_1556 _1557 _1558-> (let _term_51=(u fm_term_ref "U32.for") in (let _term_52=(u (u fm_term_app _term_51) (u fm_term_hol bits_e)) in (let _term_53=(u (u fm_term_app _term_52) (u fm_term_ref _1523)) in (let _term_54=(u (u fm_term_app _term_53) _1495) in (let _term_55=(u (u fm_term_app _term_54) _1509) in (let _lamb_56=(u (u fm_term_lam _1467) (\_e_56-> (u (u fm_term_lam _1523) (\_s_57-> _1537)))) in (let _term_57=(u (u fm_term_app _term_55) _lamb_56) in (let _term_58=(u (u (u fm_term_let _1523) _term_57) (\_x_58-> _1551)) in (u (u (u parser_reply_value _1556) _1557) (u (u fm_term_ori _1558) _term_58))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin = (\_idx_1-> (\_code_2-> (let _1559 = (u (u fm_parser_init _idx_1) _code_2) in (case _1559 of {(0,f) -> u f (\_1560 _1561 _1562-> (u (u (u parser_reply_error _1560) _1561) _1562)); (1,f) -> u f (\_1563 _1564 _1565-> (let _1566 = (u (u (u fm_parser_text "for ") _1563) _1564) in (case _1566 of {(0,f) -> u f (\_1567 _1568 _1569-> (u (u (u parser_reply_error _1567) _1568) _1569)); (1,f) -> u f (\_1570 _1571 _1572-> (let _1573 = (u (u fm_parser_name1 _1570) _1571) in (case _1573 of {(0,f) -> u f (\_1574 _1575 _1576-> (u (u (u parser_reply_error _1574) _1575) _1576)); (1,f) -> u f (\_1577 _1578 _1579-> (let _1580 = (u (u (u fm_parser_text "in") _1577) _1578) in (case _1580 of {(0,f) -> u f (\_1581 _1582 _1583-> (u (u (u parser_reply_error _1581) _1582) _1583)); (1,f) -> u f (\_1584 _1585 _1586-> (let _1587 = (u (u fm_parser_term _1584) _1585) in (case _1587 of {(0,f) -> u f (\_1588 _1589 _1590-> (u (u (u parser_reply_error _1588) _1589) _1590)); (1,f) -> u f (\_1591 _1592 _1593-> (let _1594 = (u (u (u fm_parser_text "with") _1591) _1592) in (case _1594 of {(0,f) -> u f (\_1595 _1596 _1597-> (u (u (u parser_reply_error _1595) _1596) _1597)); (1,f) -> u f (\_1598 _1599 _1600-> (let _1601 = (u (u fm_parser_name1 _1598) _1599) in (case _1601 of {(0,f) -> u f (\_1602 _1603 _1604-> (u (u (u parser_reply_error _1602) _1603) _1604)); (1,f) -> u f (\_1605 _1606 _1607-> (let _1608 = (u (u (u fm_parser_text ":") _1605) _1606) in (case _1608 of {(0,f) -> u f (\_1609 _1610 _1611-> (u (u (u parser_reply_error _1609) _1610) _1611)); (1,f) -> u f (\_1612 _1613 _1614-> (let _1615 = (u (u fm_parser_term _1612) _1613) in (case _1615 of {(0,f) -> u f (\_1616 _1617 _1618-> (u (u (u parser_reply_error _1616) _1617) _1618)); (1,f) -> u f (\_1619 _1620 _1621-> (let _1622 = (u (u (u fm_parser_stop _1565) _1619) _1620) in (case _1622 of {(0,f) -> u f (\_1623 _1624 _1625-> (u (u (u parser_reply_error _1623) _1624) _1625)); (1,f) -> u f (\_1626 _1627 _1628-> (let _term_33=(u fm_term_ref "List.for") in (let _term_34=(u (u fm_term_app _term_33) (u fm_term_hol bits_e)) in (let _term_35=(u (u fm_term_app _term_34) _1593) in (let _term_36=(u (u fm_term_app _term_35) (u fm_term_hol bits_e)) in (let _term_37=(u (u fm_term_app _term_36) (u fm_term_ref _1607)) in (let _lamb_38=(u (u fm_term_lam _1579) (\_i_38-> (u (u fm_term_lam _1607) (\_x_39-> _1621)))) in (let _term_39=(u (u fm_term_app _term_37) _lamb_38) in (let _term_40=(u (u (u fm_term_let _1607) _term_39) (\_x_40-> (u fm_term_ref _1607))) in (u (u (u parser_reply_value _1626) _1627) (u (u fm_term_ori _1628) _term_40))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_forin_2 = (\_idx_1-> (\_code_2-> (let _1629 = (u (u fm_parser_init _idx_1) _code_2) in (case _1629 of {(0,f) -> u f (\_1630 _1631 _1632-> (u (u (u parser_reply_error _1630) _1631) _1632)); (1,f) -> u f (\_1633 _1634 _1635-> (let _1636 = (u (u (u fm_parser_text "for ") _1633) _1634) in (case _1636 of {(0,f) -> u f (\_1637 _1638 _1639-> (u (u (u parser_reply_error _1637) _1638) _1639)); (1,f) -> u f (\_1640 _1641 _1642-> (let _1643 = (u (u fm_parser_name1 _1640) _1641) in (case _1643 of {(0,f) -> u f (\_1644 _1645 _1646-> (u (u (u parser_reply_error _1644) _1645) _1646)); (1,f) -> u f (\_1647 _1648 _1649-> (let _1650 = (u (u (u fm_parser_text "in") _1647) _1648) in (case _1650 of {(0,f) -> u f (\_1651 _1652 _1653-> (u (u (u parser_reply_error _1651) _1652) _1653)); (1,f) -> u f (\_1654 _1655 _1656-> (let _1657 = (u (u fm_parser_term _1654) _1655) in (case _1657 of {(0,f) -> u f (\_1658 _1659 _1660-> (u (u (u parser_reply_error _1658) _1659) _1660)); (1,f) -> u f (\_1661 _1662 _1663-> (let _1664 = (u (u (u fm_parser_text ":") _1661) _1662) in (case _1664 of {(0,f) -> u f (\_1665 _1666 _1667-> (u (u (u parser_reply_error _1665) _1666) _1667)); (1,f) -> u f (\_1668 _1669 _1670-> (let _1671 = (u (u fm_parser_name1 _1668) _1669) in (case _1671 of {(0,f) -> u f (\_1672 _1673 _1674-> (u (u (u parser_reply_error _1672) _1673) _1674)); (1,f) -> u f (\_1675 _1676 _1677-> (let _1678 = (u (u (u fm_parser_text "=") _1675) _1676) in (case _1678 of {(0,f) -> u f (\_1679 _1680 _1681-> (u (u (u parser_reply_error _1679) _1680) _1681)); (1,f) -> u f (\_1682 _1683 _1684-> (let _1685 = (u (u fm_parser_term _1682) _1683) in (case _1685 of {(0,f) -> u f (\_1686 _1687 _1688-> (u (u (u parser_reply_error _1686) _1687) _1688)); (1,f) -> u f (\_1689 _1690 _1691-> (let _1692 = (u (u (u parser_maybe (u fm_parser_text ";")) _1689) _1690) in (case _1692 of {(0,f) -> u f (\_1693 _1694 _1695-> (u (u (u parser_reply_error _1693) _1694) _1695)); (1,f) -> u f (\_1696 _1697 _1698-> (let _1699 = (u (u fm_parser_term _1696) _1697) in (case _1699 of {(0,f) -> u f (\_1700 _1701 _1702-> (u (u (u parser_reply_error _1700) _1701) _1702)); (1,f) -> u f (\_1703 _1704 _1705-> (let _1706 = (u (u (u fm_parser_stop _1635) _1703) _1704) in (case _1706 of {(0,f) -> u f (\_1707 _1708 _1709-> (u (u (u parser_reply_error _1707) _1708) _1709)); (1,f) -> u f (\_1710 _1711 _1712-> (let _term_39=(u fm_term_ref "List.for") in (let _term_40=(u (u fm_term_app _term_39) (u fm_term_hol bits_e)) in (let _term_41=(u (u fm_term_app _term_40) _1663) in (let _term_42=(u (u fm_term_app _term_41) (u fm_term_hol bits_e)) in (let _term_43=(u (u fm_term_app _term_42) (u fm_term_ref _1677)) in (let _lamb_44=(u (u fm_term_lam _1649) (\_i_44-> (u (u fm_term_lam _1677) (\_x_45-> _1691)))) in (let _term_45=(u (u fm_term_app _term_43) _lamb_44) in (let _term_46=(u (u (u fm_term_let _1677) _term_45) (\_x_46-> _1705)) in (u (u (u parser_reply_value _1710) _1711) (u (u fm_term_ori _1712) _term_46))))))))))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))); }))))
fm_parser_do_statements = (\_monad_name_1-> (u parser_first_of (u (u list_cons (\_idx_2-> (\_code_3-> (let _1713 = (u (u fm_parser_init _idx_2) _code_3) in (case _1713 of {(0,f) -> u f (\_1714 _1715 _1716-> (u (u (u parser_reply_error _1714) _1715) _1716)); (1,f) -> u f (\_1717 _1718 _1719-> (let _1720 = (u (u (u fm_parser_text "var ") _1717) _1718) in (case _1720 of {(0,f) -> u f (\_1721 _1722 _1723-> (u (u (u parser_reply_error _1721) _1722) _1723)); (1,f) -> u f (\_1724 _1725 _1726-> (let _1727 = (u (u fm_parser_name1 _1724) _1725) in (case _1727 of {(0,f) -> u f (\_1728 _1729 _1730-> (u (u (u parser_reply_error _1728) _1729) _1730)); (1,f) -> u f (\_1731 _1732 _1733-> (let _1734 = (u (u (u fm_parser_text "=") _1731) _1732) in (case _1734 of {(0,f) -> u f (\_1735 _1736 _1737-> (u (u (u parser_reply_error _1735) _1736) _1737)); (1,f) -> u f (\_1738 _1739 _1740-> (let _1741 = (u (u fm_parser_term _1738) _1739) in (case _1741 of {(0,f) -> u f (\_1742 _1743 _1744-> (u (u (u parser_reply_error _1742) _1743) _1744)); (1,f) -> u f (\_1745 _1746 _1747-> (let _1748 = (u (u (u parser_maybe (u fm_parser_text ";")) _1745) _1746) in (case _1748 of {(0,f) -> u f (\_1749 _1750 _1751-> (u (u (u parser_reply_error _1749) _1750) _1751)); (1,f) -> u f (\_1752 _1753 _1754-> (let _1755 = (u (u (u fm_parser_do_statements _monad_name_1) _1752) _1753) in (case _1755 of {(0,f) -> u f (\_1756 _1757 _1758-> (u (u (u parser_reply_error _1756) _1757) _1758)); (1,f) -> u f (\_1759 _1760 _1761-> (let _1762 = (u (u (u fm_parser_stop _1719) _1759) _1760) in (case _1762 of {(0,f) -> u f (\_1763 _1764 _1765-> (u (u (u parser_reply_error _1763) _1764) _1765)); (1,f) -> u f (\_1766 _1767 _1768-> (let _term_28=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_29=(u (u fm_term_app _term_28) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) _1747) in (let _term_33=(u (u fm_term_app _term_32) (u (u fm_term_lam _1733) (\_x_33-> _1761))) in (u (u (u parser_reply_value _1766) _1767) (u (u fm_term_ori _1768) _term_33))))))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1769 = (u (u fm_parser_init _idx_2) _code_3) in (case _1769 of {(0,f) -> u f (\_1770 _1771 _1772-> (u (u (u parser_reply_error _1770) _1771) _1772)); (1,f) -> u f (\_1773 _1774 _1775-> (let _1776 = (u (u (u fm_parser_text "let ") _1773) _1774) in (case _1776 of {(0,f) -> u f (\_1777 _1778 _1779-> (u (u (u parser_reply_error _1777) _1778) _1779)); (1,f) -> u f (\_1780 _1781 _1782-> (let _1783 = (u (u fm_parser_name1 _1780) _1781) in (case _1783 of {(0,f) -> u f (\_1784 _1785 _1786-> (u (u (u parser_reply_error _1784) _1785) _1786)); (1,f) -> u f (\_1787 _1788 _1789-> (let _1790 = (u (u (u fm_parser_text "=") _1787) _1788) in (case _1790 of {(0,f) -> u f (\_1791 _1792 _1793-> (u (u (u parser_reply_error _1791) _1792) _1793)); (1,f) -> u f (\_1794 _1795 _1796-> (let _1797 = (u (u fm_parser_term _1794) _1795) in (case _1797 of {(0,f) -> u f (\_1798 _1799 _1800-> (u (u (u parser_reply_error _1798) _1799) _1800)); (1,f) -> u f (\_1801 _1802 _1803-> (let _1804 = (u (u (u parser_maybe (u fm_parser_text ";")) _1801) _1802) in (case _1804 of {(0,f) -> u f (\_1805 _1806 _1807-> (u (u (u parser_reply_error _1805) _1806) _1807)); (1,f) -> u f (\_1808 _1809 _1810-> (let _1811 = (u (u (u fm_parser_do_statements _monad_name_1) _1808) _1809) in (case _1811 of {(0,f) -> u f (\_1812 _1813 _1814-> (u (u (u parser_reply_error _1812) _1813) _1814)); (1,f) -> u f (\_1815 _1816 _1817-> (let _1818 = (u (u (u fm_parser_stop _1775) _1815) _1816) in (case _1818 of {(0,f) -> u f (\_1819 _1820 _1821-> (u (u (u parser_reply_error _1819) _1820) _1821)); (1,f) -> u f (\_1822 _1823 _1824-> (u (u (u parser_reply_value _1822) _1823) (u (u fm_term_ori _1824) (u (u (u fm_term_let _1789) _1803) (\_x_28-> _1817))))); }))); }))); }))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1825 = (u (u fm_parser_init _idx_2) _code_3) in (case _1825 of {(0,f) -> u f (\_1826 _1827 _1828-> (u (u (u parser_reply_error _1826) _1827) _1828)); (1,f) -> u f (\_1829 _1830 _1831-> (let _1832 = (u (u (u fm_parser_text "return ") _1829) _1830) in (case _1832 of {(0,f) -> u f (\_1833 _1834 _1835-> (u (u (u parser_reply_error _1833) _1834) _1835)); (1,f) -> u f (\_1836 _1837 _1838-> (let _1839 = (u (u fm_parser_term _1836) _1837) in (case _1839 of {(0,f) -> u f (\_1840 _1841 _1842-> (u (u (u parser_reply_error _1840) _1841) _1842)); (1,f) -> u f (\_1843 _1844 _1845-> (let _1846 = (u (u (u parser_maybe (u fm_parser_text ";")) _1843) _1844) in (case _1846 of {(0,f) -> u f (\_1847 _1848 _1849-> (u (u (u parser_reply_error _1847) _1848) _1849)); (1,f) -> u f (\_1850 _1851 _1852-> (let _1853 = (u (u (u fm_parser_stop _1831) _1850) _1851) in (case _1853 of {(0,f) -> u f (\_1854 _1855 _1856-> (u (u (u parser_reply_error _1854) _1855) _1856)); (1,f) -> u f (\_1857 _1858 _1859-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.pure")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) _1845) in (u (u (u parser_reply_value _1857) _1858) (u (u fm_term_ori _1859) _term_22))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1860 = (u (u fm_parser_init _idx_2) _code_3) in (case _1860 of {(0,f) -> u f (\_1861 _1862 _1863-> (u (u (u parser_reply_error _1861) _1862) _1863)); (1,f) -> u f (\_1864 _1865 _1866-> (let _1867 = (u (u fm_parser_term _1864) _1865) in (case _1867 of {(0,f) -> u f (\_1868 _1869 _1870-> (u (u (u parser_reply_error _1868) _1869) _1870)); (1,f) -> u f (\_1871 _1872 _1873-> (let _1874 = (u (u (u parser_maybe (u fm_parser_text ";")) _1871) _1872) in (case _1874 of {(0,f) -> u f (\_1875 _1876 _1877-> (u (u (u parser_reply_error _1875) _1876) _1877)); (1,f) -> u f (\_1878 _1879 _1880-> (let _1881 = (u (u (u fm_parser_do_statements _monad_name_1) _1878) _1879) in (case _1881 of {(0,f) -> u f (\_1882 _1883 _1884-> (u (u (u parser_reply_error _1882) _1883) _1884)); (1,f) -> u f (\_1885 _1886 _1887-> (let _1888 = (u (u (u fm_parser_stop _1866) _1885) _1886) in (case _1888 of {(0,f) -> u f (\_1889 _1890 _1891-> (u (u (u parser_reply_error _1889) _1890) _1891)); (1,f) -> u f (\_1892 _1893 _1894-> (let _term_19=(u (u fm_term_app (u fm_term_ref "Monad.bind")) (u fm_term_ref _monad_name_1)) in (let _term_20=(u (u fm_term_app _term_19) (u fm_term_ref (((_monad_name_1::String) ++ ".monad")))) in (let _term_21=(u (u fm_term_app _term_20) (u fm_term_hol bits_e)) in (let _term_22=(u (u fm_term_app _term_21) (u fm_term_hol bits_e)) in (let _term_23=(u (u fm_term_app _term_22) _1873) in (let _term_24=(u (u fm_term_app _term_23) (u (u fm_term_lam "") (\_x_24-> _1887))) in (u (u (u parser_reply_value _1892) _1893) (u (u fm_term_ori _1894) _term_24))))))))); }))); }))); }))); }))); }))))) (u (u list_cons (\_idx_2-> (\_code_3-> (let _1895 = (u (u fm_parser_term _idx_2) _code_3) in (case _1895 of {(0,f) -> u f (\_1896 _1897 _1898-> (u (u (u parser_reply_error _1896) _1897) _1898)); (1,f) -> u f (\_1899 _1900 _1901-> (let _1902 = (u (u (u parser_maybe (u fm_parser_text ";")) _1899) _1900) in (case _1902 of {(0,f) -> u f (\_1903 _1904 _1905-> (u (u (u parser_reply_error _1903) _1904) _1905)); (1,f) -> u f (\_1906 _1907 _1908-> (u (u (u parser_reply_value _1906) _1907) _1901)); }))); }))))) list_nil)))))))
fm_parser_do = (\_idx_1-> (\_code_2-> (let _1909 = (u (u (u fm_parser_text "do ") _idx_1) _code_2) in (case _1909 of {(0,f) -> u f (\_1910 _1911 _1912-> (u (u (u parser_reply_error _1910) _1911) _1912)); (1,f) -> u f (\_1913 _1914 _1915-> (let _1916 = (u (u fm_parser_name1 _1913) _1914) in (case _1916 of {(0,f) -> u f (\_1917 _1918 _1919-> (u (u (u parser_reply_error _1917) _1918) _1919)); (1,f) -> u f (\_1920 _1921 _1922-> (let _1923 = (u (u (u fm_parser_text "{") _1920) _1921) in (case _1923 of {(0,f) -> u f (\_1924 _1925 _1926-> (u (u (u parser_reply_error _1924) _1925) _1926)); (1,f) -> u f (\_1927 _1928 _1929-> (let _1930 = (u (u (u fm_parser_do_statements _1922) _1927) _1928) in (case _1930 of {(0,f) -> u f (\_1931 _1932 _1933-> (u (u (u parser_reply_error _1931) _1932) _1933)); (1,f) -> u f (\_1934 _1935 _1936-> (let _1937 = (u (u (u fm_parser_text "}") _1934) _1935) in (case _1937 of {(0,f) -> u f (\_1938 _1939 _1940-> (u (u (u parser_reply_error _1938) _1939) _1940)); (1,f) -> u f (\_1941 _1942 _1943-> (u (u (u parser_reply_value _1941) _1942) _1936)); }))); }))); }))); }))); }))))
fm_term_nat = (\_natx_1-> (11,\t-> t _natx_1))
fm_term_unroll_nat = (\_natx_1-> (let _1944 = _natx_1 in (if _1944==0 then (u fm_term_ref (u fm_name_read "Nat.zero")) else (let _func_3=(u fm_term_ref (u fm_name_read "Nat.succ")) in (let _argm_4=(u fm_term_nat (_1944-1)) in (u (u fm_term_app _func_3) _argm_4))))))
u16_to_bits = (\_a_1-> (let _1945 = _a_1 in (u word_to_bits (u16_to_word _1945))))
fm_term_unroll_chr_bits = (\_bits_1-> (let _1946 = _bits_1 in (case _1946 of {(0,f) -> u f ((u fm_term_ref (u fm_name_read "Bits.e"))); (1,f) -> u f (\_1947-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.o"))) (u fm_term_unroll_chr_bits _1947))); (2,f) -> u f (\_1948-> (u (u fm_term_app (u fm_term_ref (u fm_name_read "Bits.i"))) (u fm_term_unroll_chr_bits _1948))); })))
fm_term_unroll_chr = (\_chrx_1-> (let _bits_2=(u u16_to_bits _chrx_1) in (let _term_3=(u fm_term_ref (u fm_name_read "Word.from_bits")) in (let _term_4=(u (u fm_term_app _term_3) (u fm_term_nat 16)) in (let _term_5=(u (u fm_term_app _term_4) (u fm_term_unroll_chr_bits _bits_2)) in (let _term_6=(u (u fm_term_app (u fm_term_ref (u fm_name_read "U16.new"))) _term_5) in _term_6))))))
fm_term_unroll_str = (\_strx_1-> (let _1949 = _strx_1 in (if null (_1949::String) then (u fm_term_ref (u fm_name_read "String.nil")) else (let _char_4=(u fm_term_chr (fromIntegral (fromEnum (head _1949 :: Char)) :: Word16)) in (let _term_5=(u fm_term_ref (u fm_name_read "String.cons")) in (let _term_6=(u (u fm_term_app _term_5) _char_4) in (let _term_7=(u (u fm_term_app _term_6) (u fm_term_str (tail _1949))) in _term_7)))))))
fm_term_reduce = (\_term_1-> (\_defs_2-> (let _1950 = _term_1 in (case _1950 of {(0,f) -> u f (\_1951 _1952-> _term_1); (1,f) -> u f (\_1953-> (let _1954 = (u (u fm_get _1953) _defs_2) in (case _1954 of {(0,f) -> u f ((u fm_term_ref _1953)); (1,f) -> u f (\_1955-> (let _1956 = _1955 in (case _1956 of {(0,f) -> u f (\_1957 _1958 _1959 _1960 _1961 _1962 _1963 _1964 _1965-> (u (u fm_term_reduce _1961) _defs_2)); }))); }))); (2,f) -> u f (_term_1); (3,f) -> u f (\_1966 _1967 _1968 _1969 _1970-> _term_1); (4,f) -> u f (\_1971 _1972-> _term_1); (5,f) -> u f (\_1973 _1974-> (let _func_5=(u (u fm_term_reduce _1973) _defs_2) in (let _1975 = _func_5 in (case _1975 of {(0,f) -> u f (\_1976 _1977-> _term_1); (1,f) -> u f (\_1978-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_1979 _1980 _1981 _1982 _1983-> _term_1); (4,f) -> u f (\_1984 _1985-> (u (u fm_term_reduce (u _1985 _1974)) _defs_2)); (5,f) -> u f (\_1986 _1987-> _term_1); (6,f) -> u f (\_1988 _1989 _1990-> _term_1); (7,f) -> u f (\_1991 _1992 _1993-> _term_1); (8,f) -> u f (\_1994 _1995 _1996-> _term_1); (9,f) -> u f (\_1997 _1998 _1999-> _term_1); (10,f) -> u f (\_2000-> _term_1); (11,f) -> u f (\_2001-> _term_1); (12,f) -> u f (\_2002-> _term_1); (13,f) -> u f (\_2003-> _term_1); (14,f) -> u f (\_2004 _2005 _2006 _2007 _2008 _2009-> _term_1); (15,f) -> u f (\_2010 _2011-> _term_1); })))); (6,f) -> u f (\_2012 _2013 _2014-> (u (u fm_term_reduce (u _2014 _2013)) _defs_2)); (7,f) -> u f (\_2015 _2016 _2017-> (u (u fm_term_reduce (u _2017 _2016)) _defs_2)); (8,f) -> u f (\_2018 _2019 _2020-> (u (u fm_term_reduce _2019) _defs_2)); (9,f) -> u f (\_2021 _2022 _2023-> _term_1); (10,f) -> u f (\_2024-> _term_1); (11,f) -> u f (\_2025-> (u (u fm_term_reduce (u fm_term_unroll_nat _2025)) _defs_2)); (12,f) -> u f (\_2026-> (u (u fm_term_reduce (u fm_term_unroll_chr _2026)) _defs_2)); (13,f) -> u f (\_2027-> (u (u fm_term_reduce (u fm_term_unroll_str _2027)) _defs_2)); (14,f) -> u f (\_2028 _2029 _2030 _2031 _2032 _2033-> _term_1); (15,f) -> u f (\_2034 _2035-> (u (u fm_term_reduce _2035) _defs_2)); }))))
map_new = (0,\t-> t)
fm_def_new = (\_file_1-> (\_code_2-> (\_orig_3-> (\_name_4-> (\_term_5-> (\_type_6-> (\_isct_7-> (\_arit_8-> (\_stat_9-> (0,\t-> t _file_1 _code_2 _orig_3 _name_4 _term_5 _type_6 _isct_7 _arit_8 _stat_9))))))))))
fm_status_init = (0,\t-> t)
fm_parser_case_with = (\_idx_1-> (\_code_2-> (let _2036 = (u (u (u fm_parser_text "with") _idx_1) _code_2) in (case _2036 of {(0,f) -> u f (\_2037 _2038 _2039-> (u (u (u parser_reply_error _2037) _2038) _2039)); (1,f) -> u f (\_2040 _2041 _2042-> (let _2043 = (u (u fm_parser_name1 _2040) _2041) in (case _2043 of {(0,f) -> u f (\_2044 _2045 _2046-> (u (u (u parser_reply_error _2044) _2045) _2046)); (1,f) -> u f (\_2047 _2048 _2049-> (let _2050 = (u (u (u fm_parser_text ":") _2047) _2048) in (case _2050 of {(0,f) -> u f (\_2051 _2052 _2053-> (u (u (u parser_reply_error _2051) _2052) _2053)); (1,f) -> u f (\_2054 _2055 _2056-> (let _2057 = (u (u fm_parser_term _2054) _2055) in (case _2057 of {(0,f) -> u f (\_2058 _2059 _2060-> (u (u (u parser_reply_error _2058) _2059) _2060)); (1,f) -> u f (\_2061 _2062 _2063-> (let _2064 = (u (u (u fm_parser_text "=") _2061) _2062) in (case _2064 of {(0,f) -> u f (\_2065 _2066 _2067-> (u (u (u parser_reply_error _2065) _2066) _2067)); (1,f) -> u f (\_2068 _2069 _2070-> (let _2071 = (u (u fm_parser_term _2068) _2069) in (case _2071 of {(0,f) -> u f (\_2072 _2073 _2074-> (u (u (u parser_reply_error _2072) _2073) _2074)); (1,f) -> u f (\_2075 _2076 _2077-> (u (u (u parser_reply_value _2075) _2076) (u (u (u (u (u (u (u (u (u fm_def_new "") "") (u (u pair_new 0) 0)) _2049) _2077) _2063) bool_false) 0) fm_status_init))); }))); }))); }))); }))); }))); }))))
fm_parser_case_case = (\_idx_1-> (\_code_2-> (let _2078 = (u (u fm_parser_name1 _idx_1) _code_2) in (case _2078 of {(0,f) -> u f (\_2079 _2080 _2081-> (u (u (u parser_reply_error _2079) _2080) _2081)); (1,f) -> u f (\_2082 _2083 _2084-> (let _2085 = (u (u (u fm_parser_text ":") _2082) _2083) in (case _2085 of {(0,f) -> u f (\_2086 _2087 _2088-> (u (u (u parser_reply_error _2086) _2087) _2088)); (1,f) -> u f (\_2089 _2090 _2091-> (let _2092 = (u (u fm_parser_term _2089) _2090) in (case _2092 of {(0,f) -> u f (\_2093 _2094 _2095-> (u (u (u parser_reply_error _2093) _2094) _2095)); (1,f) -> u f (\_2096 _2097 _2098-> (let _2099 = (u (u (u parser_maybe (u fm_parser_text ",")) _2096) _2097) in (case _2099 of {(0,f) -> u f (\_2100 _2101 _2102-> (u (u (u parser_reply_error _2100) _2101) _2102)); (1,f) -> u f (\_2103 _2104 _2105-> (u (u (u parser_reply_value _2103) _2104) (u (u pair_new _2084) _2098))); }))); }))); }))); }))))
map_tie = (\_val_2-> (\_lft_3-> (\_rgt_4-> (1,\t-> t _val_2 _lft_3 _rgt_4))))
map_set = (\_bits_2-> (\_val_3-> (\_map_4-> (let _2106 = _bits_2 in (case _2106 of {(0,f) -> u f ((let _2107 = _map_4 in (case _2107 of {(0,f) -> u f ((u (u (u map_tie (u maybe_some _val_3)) map_new) map_new)); (1,f) -> u f (\_2108 _2109 _2110-> (u (u (u map_tie (u maybe_some _val_3)) _2109) _2110)); }))); (1,f) -> u f (\_2111-> (let _2112 = _map_4 in (case _2112 of {(0,f) -> u f ((u (u (u map_tie maybe_none) (u (u (u map_set _2111) _val_3) map_new)) map_new)); (1,f) -> u f (\_2113 _2114 _2115-> (u (u (u map_tie _2113) (u (u (u map_set _2111) _val_3) _2114)) _2115)); }))); (2,f) -> u f (\_2116-> (let _2117 = _map_4 in (case _2117 of {(0,f) -> u f ((u (u (u map_tie maybe_none) map_new) (u (u (u map_set _2116) _val_3) map_new))); (1,f) -> u f (\_2118 _2119 _2120-> (u (u (u map_tie _2118) _2119) (u (u (u map_set _2116) _val_3) _2120))); }))); })))))
map_from_list = (\_xs_2-> (let _2121 = _xs_2 in (case _2121 of {(0,f) -> u f (map_new); (1,f) -> u f (\_2122 _2123-> (let _2124 = _2122 in (case _2124 of {(0,f) -> u f (\_2125 _2126-> (u (u (u map_set _2125) _2126) (u map_from_list _2123))); }))); })))
pair_fst = (\_pair_3-> (let _2127 = _pair_3 in (case _2127 of {(0,f) -> u f (\_2128 _2129-> _2128); })))
pair_snd = (\_pair_3-> (let _2130 = _pair_3 in (case _2130 of {(0,f) -> u f (\_2131 _2132-> _2132); })))
fm_term_cse = (\_path_1-> (\_expr_2-> (\_name_3-> (\_with_4-> (\_cses_5-> (\_moti_6-> (14,\t-> t _path_1 _expr_2 _name_3 _with_4 _cses_5 _moti_6)))))))
fm_parser_case = (\_idx_1-> (\_code_2-> (let _2133 = (u (u fm_parser_init _idx_1) _code_2) in (case _2133 of {(0,f) -> u f (\_2134 _2135 _2136-> (u (u (u parser_reply_error _2134) _2135) _2136)); (1,f) -> u f (\_2137 _2138 _2139-> (let _2140 = (u (u (u fm_parser_text "case ") _2137) _2138) in (case _2140 of {(0,f) -> u f (\_2141 _2142 _2143-> (u (u (u parser_reply_error _2141) _2142) _2143)); (1,f) -> u f (\_2144 _2145 _2146-> (let _2147 = (u (u fm_parser_spaces _2144) _2145) in (case _2147 of {(0,f) -> u f (\_2148 _2149 _2150-> (u (u (u parser_reply_error _2148) _2149) _2150)); (1,f) -> u f (\_2151 _2152 _2153-> (let _2154 = (u (u fm_parser_term _2151) _2152) in (case _2154 of {(0,f) -> u f (\_2155 _2156 _2157-> (u (u (u parser_reply_error _2155) _2156) _2157)); (1,f) -> u f (\_2158 _2159 _2160-> (let _2161 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2162 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2162 of {(0,f) -> u f (\_2163 _2164 _2165-> (u (u (u parser_reply_error _2163) _2164) _2165)); (1,f) -> u f (\_2166 _2167 _2168-> (u (u fm_parser_name1 _2166) _2167)); }))))) _2158) _2159) in (case _2161 of {(0,f) -> u f (\_2169 _2170 _2171-> (u (u (u parser_reply_error _2169) _2170) _2171)); (1,f) -> u f (\_2172 _2173 _2174-> (let _name_18=(let _2175 = _2174 in (case _2175 of {(0,f) -> u f ((let _2176 = (u (u fm_term_reduce _2160) map_new) in (case _2176 of {(0,f) -> u f (\_2177 _2178-> _2177); (1,f) -> u f (\_2179-> _2179); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2180 _2181 _2182 _2183 _2184-> (u fm_name_read "self")); (4,f) -> u f (\_2185 _2186-> (u fm_name_read "self")); (5,f) -> u f (\_2187 _2188-> (u fm_name_read "self")); (6,f) -> u f (\_2189 _2190 _2191-> (u fm_name_read "self")); (7,f) -> u f (\_2192 _2193 _2194-> (u fm_name_read "self")); (8,f) -> u f (\_2195 _2196 _2197-> (u fm_name_read "self")); (9,f) -> u f (\_2198 _2199 _2200-> (u fm_name_read "self")); (10,f) -> u f (\_2201-> (u fm_name_read "self")); (11,f) -> u f (\_2202-> (u fm_name_read "self")); (12,f) -> u f (\_2203-> (u fm_name_read "self")); (13,f) -> u f (\_2204-> (u fm_name_read "self")); (14,f) -> u f (\_2205 _2206 _2207 _2208 _2209 _2210-> (u fm_name_read "self")); (15,f) -> u f (\_2211 _2212-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2213-> _2213); })) in (let _2214 = (u (u (u parser_many fm_parser_case_with) _2172) _2173) in (case _2214 of {(0,f) -> u f (\_2215 _2216 _2217-> (u (u (u parser_reply_error _2215) _2216) _2217)); (1,f) -> u f (\_2218 _2219 _2220-> (let _2221 = (u (u (u fm_parser_text "{") _2218) _2219) in (case _2221 of {(0,f) -> u f (\_2222 _2223 _2224-> (u (u (u parser_reply_error _2222) _2223) _2224)); (1,f) -> u f (\_2225 _2226 _2227-> (let _2228 = (u (u (u (u parser_until (u fm_parser_text "}")) fm_parser_case_case) _2225) _2226) in (case _2228 of {(0,f) -> u f (\_2229 _2230 _2231-> (u (u (u parser_reply_error _2229) _2230) _2231)); (1,f) -> u f (\_2232 _2233 _2234-> (let _cses_28=(u map_from_list (u (u list_mapped _2234) (\_x_28-> (u (u pair_new (u fm_name_to_bits (u pair_fst _x_28))) (u pair_snd _x_28))))) in (let _2235 = (u (u (u parser_first_of (u (u list_cons (\_idx_29-> (\_code_30-> (let _2236 = (u (u (u fm_parser_text ":") _idx_29) _code_30) in (case _2236 of {(0,f) -> u f (\_2237 _2238 _2239-> (u (u (u parser_reply_error _2237) _2238) _2239)); (1,f) -> u f (\_2240 _2241 _2242-> (let _2243 = (u (u fm_parser_term _2240) _2241) in (case _2243 of {(0,f) -> u f (\_2244 _2245 _2246-> (u (u (u parser_reply_error _2244) _2245) _2246)); (1,f) -> u f (\_2247 _2248 _2249-> (u (u (u parser_reply_value _2247) _2248) (u maybe_some _2249))); }))); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (let _2250 = (u (u (u fm_parser_text "!") _idx_29) _code_30) in (case _2250 of {(0,f) -> u f (\_2251 _2252 _2253-> (u (u (u parser_reply_error _2251) _2252) _2253)); (1,f) -> u f (\_2254 _2255 _2256-> (u (u (u parser_reply_value _2254) _2255) maybe_none)); }))))) (u (u list_cons (\_idx_29-> (\_code_30-> (u (u (u parser_reply_value _idx_29) _code_30) (u maybe_some (u fm_term_hol bits_e)))))) list_nil)))) _2232) _2233) in (case _2235 of {(0,f) -> u f (\_2257 _2258 _2259-> (u (u (u parser_reply_error _2257) _2258) _2259)); (1,f) -> u f (\_2260 _2261 _2262-> (let _2263 = (u (u (u fm_parser_stop _2139) _2260) _2261) in (case _2263 of {(0,f) -> u f (\_2264 _2265 _2266-> (u (u (u parser_reply_error _2264) _2265) _2266)); (1,f) -> u f (\_2267 _2268 _2269-> (u (u (u parser_reply_value _2267) _2268) (u (u fm_term_ori _2269) (u (u (u (u (u (u fm_term_cse bits_e) _2160) _name_18) _2220) _cses_28) _2262)))); }))); })))); }))); }))); })))); }))); }))); }))); }))); }))))
fm_set = (\_name_2-> (\_val_3-> (\_map_4-> (u (u (u map_set (u fm_name_to_bits _name_2)) _val_3) _map_4))))
fm_parser_open = (\_idx_1-> (\_code_2-> (let _2270 = (u (u fm_parser_init _idx_1) _code_2) in (case _2270 of {(0,f) -> u f (\_2271 _2272 _2273-> (u (u (u parser_reply_error _2271) _2272) _2273)); (1,f) -> u f (\_2274 _2275 _2276-> (let _2277 = (u (u (u fm_parser_text "open ") _2274) _2275) in (case _2277 of {(0,f) -> u f (\_2278 _2279 _2280-> (u (u (u parser_reply_error _2278) _2279) _2280)); (1,f) -> u f (\_2281 _2282 _2283-> (let _2284 = (u (u fm_parser_spaces _2281) _2282) in (case _2284 of {(0,f) -> u f (\_2285 _2286 _2287-> (u (u (u parser_reply_error _2285) _2286) _2287)); (1,f) -> u f (\_2288 _2289 _2290-> (let _2291 = (u (u fm_parser_term _2288) _2289) in (case _2291 of {(0,f) -> u f (\_2292 _2293 _2294-> (u (u (u parser_reply_error _2292) _2293) _2294)); (1,f) -> u f (\_2295 _2296 _2297-> (let _2298 = (u (u (u parser_maybe (\_idx_15-> (\_code_16-> (let _2299 = (u (u (u fm_parser_text "as") _idx_15) _code_16) in (case _2299 of {(0,f) -> u f (\_2300 _2301 _2302-> (u (u (u parser_reply_error _2300) _2301) _2302)); (1,f) -> u f (\_2303 _2304 _2305-> (u (u fm_parser_name1 _2303) _2304)); }))))) _2295) _2296) in (case _2298 of {(0,f) -> u f (\_2306 _2307 _2308-> (u (u (u parser_reply_error _2306) _2307) _2308)); (1,f) -> u f (\_2309 _2310 _2311-> (let _2312 = (u (u (u parser_maybe (u fm_parser_text ";")) _2309) _2310) in (case _2312 of {(0,f) -> u f (\_2313 _2314 _2315-> (u (u (u parser_reply_error _2313) _2314) _2315)); (1,f) -> u f (\_2316 _2317 _2318-> (let _name_21=(let _2319 = _2311 in (case _2319 of {(0,f) -> u f ((let _2320 = (u (u fm_term_reduce _2297) map_new) in (case _2320 of {(0,f) -> u f (\_2321 _2322-> _2321); (1,f) -> u f (\_2323-> _2323); (2,f) -> u f ((u fm_name_read "self")); (3,f) -> u f (\_2324 _2325 _2326 _2327 _2328-> (u fm_name_read "self")); (4,f) -> u f (\_2329 _2330-> (u fm_name_read "self")); (5,f) -> u f (\_2331 _2332-> (u fm_name_read "self")); (6,f) -> u f (\_2333 _2334 _2335-> (u fm_name_read "self")); (7,f) -> u f (\_2336 _2337 _2338-> (u fm_name_read "self")); (8,f) -> u f (\_2339 _2340 _2341-> (u fm_name_read "self")); (9,f) -> u f (\_2342 _2343 _2344-> (u fm_name_read "self")); (10,f) -> u f (\_2345-> (u fm_name_read "self")); (11,f) -> u f (\_2346-> (u fm_name_read "self")); (12,f) -> u f (\_2347-> (u fm_name_read "self")); (13,f) -> u f (\_2348-> (u fm_name_read "self")); (14,f) -> u f (\_2349 _2350 _2351 _2352 _2353 _2354-> (u fm_name_read "self")); (15,f) -> u f (\_2355 _2356-> (u fm_name_read "self")); }))); (1,f) -> u f (\_2357-> _2357); })) in (let _wyth_22=list_nil in (let _2358 = (u (u fm_parser_term _2316) _2317) in (case _2358 of {(0,f) -> u f (\_2359 _2360 _2361-> (u (u (u parser_reply_error _2359) _2360) _2361)); (1,f) -> u f (\_2362 _2363 _2364-> (let _cses_26=(u (u (u fm_set "_") _2364) map_new) in (let _moti_27=(u maybe_some (u fm_term_hol bits_e)) in (let _2365 = (u (u (u fm_parser_stop _2276) _2362) _2363) in (case _2365 of {(0,f) -> u f (\_2366 _2367 _2368-> (u (u (u parser_reply_error _2366) _2367) _2368)); (1,f) -> u f (\_2369 _2370 _2371-> (u (u (u parser_reply_value _2369) _2370) (u (u fm_term_ori _2371) (u (u (u (u (u (u fm_term_cse bits_e) _2297) _name_21) _wyth_22) _cses_26) _moti_27)))); }))))); }))))); }))); }))); }))); }))); }))); }))))
parser_digit = (\_idx_1-> (\_code_2-> (let _2372 = _code_2 in (if null (_2372::String) then (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit.") else (let _sidx_5=(u nat_succ _idx_1) in (let _2373 = ((((fromIntegral (fromEnum (head _2372 :: Char)) :: Word16)::Word16) == 48)) in (if _2373 then (u (u (u parser_reply_value _sidx_5) (tail _2372)) 0) else (let _2374 = ((((fromIntegral (fromEnum (head _2372 :: Char)) :: Word16)::Word16) == 49)) in (if _2374 then (u (u (u parser_reply_value _sidx_5) (tail _2372)) 1) else (let _2375 = ((((fromIntegral (fromEnum (head _2372 :: Char)) :: Word16)::Word16) == 50)) in (if _2375 then (u (u (u parser_reply_value _sidx_5) (tail _2372)) 2) else (let _2376 = ((((fromIntegral (fromEnum (head _2372 :: Char)) :: Word16)::Word16) == 51)) in (if _2376 then (u (u (u parser_reply_value _sidx_5) (tail _2372)) 3) else (let _2377 = ((((fromIntegral (fromEnum (head _2372 :: Char)) :: Word16)::Word16) == 52)) in (if _2377 then (u (u (u parser_reply_value _sidx_5) (tail _2372)) 4) else (let _2378 = ((((fromIntegral (fromEnum (head _2372 :: Char)) :: Word16)::Word16) == 53)) in (if _2378 then (u (u (u parser_reply_value _sidx_5) (tail _2372)) 5) else (let _2379 = ((((fromIntegral (fromEnum (head _2372 :: Char)) :: Word16)::Word16) == 54)) in (if _2379 then (u (u (u parser_reply_value _sidx_5) (tail _2372)) 6) else (let _2380 = ((((fromIntegral (fromEnum (head _2372 :: Char)) :: Word16)::Word16) == 55)) in (if _2380 then (u (u (u parser_reply_value _sidx_5) (tail _2372)) 7) else (let _2381 = ((((fromIntegral (fromEnum (head _2372 :: Char)) :: Word16)::Word16) == 56)) in (if _2381 then (u (u (u parser_reply_value _sidx_5) (tail _2372)) 8) else (let _2382 = ((((fromIntegral (fromEnum (head _2372 :: Char)) :: Word16)::Word16) == 57)) in (if _2382 then (u (u (u parser_reply_value _sidx_5) (tail _2372)) 9) else (u (u (u parser_reply_error _idx_1) _code_2) "Not a digit."))))))))))))))))))))))))))
nat_add = (\a0-> \a1-> ((a0::Integer) + a1))
nat_mul = (\a0-> \a1-> ((a0::Integer) * a1))
nat_from_base_go = (\_b_1-> (\_ds_2-> (\_p_3-> (\_res_4-> (let _2383 = _ds_2 in (case _2383 of {(0,f) -> u f (_res_4); (1,f) -> u f (\_2384 _2385-> (u (u (u (u nat_from_base_go _b_1) _2385) (((_b_1::Integer) * _p_3))) ((((((_2384::Integer) * _p_3))::Integer) + _res_4)))); }))))))
nat_from_base = (\_base_1-> (\_ds_2-> (u (u (u (u nat_from_base_go _base_1) (u list_reverse _ds_2)) 1) 0)))
parser_nat = (\_idx_1-> (\_code_2-> (let _2386 = (u (u (u parser_many1 parser_digit) _idx_1) _code_2) in (case _2386 of {(0,f) -> u f (\_2387 _2388 _2389-> (u (u (u parser_reply_error _2387) _2388) _2389)); (1,f) -> u f (\_2390 _2391 _2392-> (u (u (u parser_reply_value _2390) _2391) (u (u nat_from_base 10) _2392))); }))))
bits_tail = (\_a_1-> (let _2393 = _a_1 in (case _2393 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_2394-> _2394); (2,f) -> u f (\_2395-> _2395); })))
bits_inc = (\_a_1-> (let _2396 = _a_1 in (case _2396 of {(0,f) -> u f ((u bits_i bits_e)); (1,f) -> u f (\_2397-> (u bits_i _2397)); (2,f) -> u f (\_2398-> (u bits_o (u bits_inc _2398))); })))
nat_to_bits = (\_n_1-> (let _2399 = _n_1 in (if _2399==0 then bits_e else (u bits_inc (u nat_to_bits (_2399-1))))))
maybe_to_bool = (\_m_2-> (let _2400 = _m_2 in (case _2400 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_2401-> bool_true); })))
fm_term_gol = (\_name_1-> (\_dref_2-> (\_verb_3-> (9,\t-> t _name_1 _dref_2 _verb_3))))
fm_parser_goal = (\_idx_1-> (\_code_2-> (let _2402 = (u (u fm_parser_init _idx_1) _code_2) in (case _2402 of {(0,f) -> u f (\_2403 _2404 _2405-> (u (u (u parser_reply_error _2403) _2404) _2405)); (1,f) -> u f (\_2406 _2407 _2408-> (let _2409 = (u (u (u fm_parser_text "?") _2406) _2407) in (case _2409 of {(0,f) -> u f (\_2410 _2411 _2412-> (u (u (u parser_reply_error _2410) _2411) _2412)); (1,f) -> u f (\_2413 _2414 _2415-> (let _2416 = (u (u fm_parser_name _2413) _2414) in (case _2416 of {(0,f) -> u f (\_2417 _2418 _2419-> (u (u (u parser_reply_error _2417) _2418) _2419)); (1,f) -> u f (\_2420 _2421 _2422-> (let _2423 = (u (u (u parser_many (\_idx_12-> (\_code_13-> (let _2424 = (u (u (u fm_parser_text "-") _idx_12) _code_13) in (case _2424 of {(0,f) -> u f (\_2425 _2426 _2427-> (u (u (u parser_reply_error _2425) _2426) _2427)); (1,f) -> u f (\_2428 _2429 _2430-> (let _2431 = (u (u parser_nat _2428) _2429) in (case _2431 of {(0,f) -> u f (\_2432 _2433 _2434-> (u (u (u parser_reply_error _2432) _2433) _2434)); (1,f) -> u f (\_2435 _2436 _2437-> (let _bits_20=(u bits_reverse (u bits_tail (u bits_reverse (u nat_to_bits _2437)))) in (u (u (u parser_reply_value _2435) _2436) _bits_20))); }))); }))))) _2420) _2421) in (case _2423 of {(0,f) -> u f (\_2438 _2439 _2440-> (u (u (u parser_reply_error _2438) _2439) _2440)); (1,f) -> u f (\_2441 _2442 _2443-> (let _2444 = (let _2445 = (u (u (u parser_maybe (u parser_text "-")) _2441) _2442) in (case _2445 of {(0,f) -> u f (\_2446 _2447 _2448-> (u (u (u parser_reply_error _2446) _2447) _2448)); (1,f) -> u f (\_2449 _2450 _2451-> (u (u (u parser_reply_value _2449) _2450) (u maybe_to_bool _2451))); })) in (case _2444 of {(0,f) -> u f (\_2452 _2453 _2454-> (u (u (u parser_reply_error _2452) _2453) _2454)); (1,f) -> u f (\_2455 _2456 _2457-> (let _2458 = (u (u (u fm_parser_stop _2408) _2455) _2456) in (case _2458 of {(0,f) -> u f (\_2459 _2460 _2461-> (u (u (u parser_reply_error _2459) _2460) _2461)); (1,f) -> u f (\_2462 _2463 _2464-> (u (u (u parser_reply_value _2462) _2463) (u (u fm_term_ori _2464) (u (u (u fm_term_gol _2422) _2443) _2457)))); }))); }))); }))); }))); }))); }))))
fm_parser_hole = (\_idx_1-> (\_code_2-> (let _2465 = (u (u fm_parser_init _idx_1) _code_2) in (case _2465 of {(0,f) -> u f (\_2466 _2467 _2468-> (u (u (u parser_reply_error _2466) _2467) _2468)); (1,f) -> u f (\_2469 _2470 _2471-> (let _2472 = (u (u (u fm_parser_text "_") _2469) _2470) in (case _2472 of {(0,f) -> u f (\_2473 _2474 _2475-> (u (u (u parser_reply_error _2473) _2474) _2475)); (1,f) -> u f (\_2476 _2477 _2478-> (let _2479 = (u (u (u fm_parser_stop _2471) _2476) _2477) in (case _2479 of {(0,f) -> u f (\_2480 _2481 _2482-> (u (u (u parser_reply_error _2480) _2481) _2482)); (1,f) -> u f (\_2483 _2484 _2485-> (u (u (u parser_reply_value _2483) _2484) (u (u fm_term_ori _2485) (u fm_term_hol bits_e)))); }))); }))); }))))
fm_parser_u8 = (\_idx_1-> (\_code_2-> (let _2486 = (u (u fm_parser_init _idx_1) _code_2) in (case _2486 of {(0,f) -> u f (\_2487 _2488 _2489-> (u (u (u parser_reply_error _2487) _2488) _2489)); (1,f) -> u f (\_2490 _2491 _2492-> (let _2493 = (u (u fm_parser_spaces _2490) _2491) in (case _2493 of {(0,f) -> u f (\_2494 _2495 _2496-> (u (u (u parser_reply_error _2494) _2495) _2496)); (1,f) -> u f (\_2497 _2498 _2499-> (let _2500 = (u (u parser_nat _2497) _2498) in (case _2500 of {(0,f) -> u f (\_2501 _2502 _2503-> (u (u (u parser_reply_error _2501) _2502) _2503)); (1,f) -> u f (\_2504 _2505 _2506-> (let _2507 = (u (u (u parser_text "b") _2504) _2505) in (case _2507 of {(0,f) -> u f (\_2508 _2509 _2510-> (u (u (u parser_reply_error _2508) _2509) _2510)); (1,f) -> u f (\_2511 _2512 _2513-> (let _term_15=(u fm_term_ref "Nat.to_u8") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2506)) in (let _2514 = (u (u (u fm_parser_stop _2492) _2511) _2512) in (case _2514 of {(0,f) -> u f (\_2515 _2516 _2517-> (u (u (u parser_reply_error _2515) _2516) _2517)); (1,f) -> u f (\_2518 _2519 _2520-> (u (u (u parser_reply_value _2518) _2519) (u (u fm_term_ori _2520) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u16 = (\_idx_1-> (\_code_2-> (let _2521 = (u (u fm_parser_init _idx_1) _code_2) in (case _2521 of {(0,f) -> u f (\_2522 _2523 _2524-> (u (u (u parser_reply_error _2522) _2523) _2524)); (1,f) -> u f (\_2525 _2526 _2527-> (let _2528 = (u (u fm_parser_spaces _2525) _2526) in (case _2528 of {(0,f) -> u f (\_2529 _2530 _2531-> (u (u (u parser_reply_error _2529) _2530) _2531)); (1,f) -> u f (\_2532 _2533 _2534-> (let _2535 = (u (u parser_nat _2532) _2533) in (case _2535 of {(0,f) -> u f (\_2536 _2537 _2538-> (u (u (u parser_reply_error _2536) _2537) _2538)); (1,f) -> u f (\_2539 _2540 _2541-> (let _2542 = (u (u (u parser_text "s") _2539) _2540) in (case _2542 of {(0,f) -> u f (\_2543 _2544 _2545-> (u (u (u parser_reply_error _2543) _2544) _2545)); (1,f) -> u f (\_2546 _2547 _2548-> (let _term_15=(u fm_term_ref "Nat.to_u16") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2541)) in (let _2549 = (u (u (u fm_parser_stop _2527) _2546) _2547) in (case _2549 of {(0,f) -> u f (\_2550 _2551 _2552-> (u (u (u parser_reply_error _2550) _2551) _2552)); (1,f) -> u f (\_2553 _2554 _2555-> (u (u (u parser_reply_value _2553) _2554) (u (u fm_term_ori _2555) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u32 = (\_idx_1-> (\_code_2-> (let _2556 = (u (u fm_parser_init _idx_1) _code_2) in (case _2556 of {(0,f) -> u f (\_2557 _2558 _2559-> (u (u (u parser_reply_error _2557) _2558) _2559)); (1,f) -> u f (\_2560 _2561 _2562-> (let _2563 = (u (u fm_parser_spaces _2560) _2561) in (case _2563 of {(0,f) -> u f (\_2564 _2565 _2566-> (u (u (u parser_reply_error _2564) _2565) _2566)); (1,f) -> u f (\_2567 _2568 _2569-> (let _2570 = (u (u parser_nat _2567) _2568) in (case _2570 of {(0,f) -> u f (\_2571 _2572 _2573-> (u (u (u parser_reply_error _2571) _2572) _2573)); (1,f) -> u f (\_2574 _2575 _2576-> (let _2577 = (u (u (u parser_text "u") _2574) _2575) in (case _2577 of {(0,f) -> u f (\_2578 _2579 _2580-> (u (u (u parser_reply_error _2578) _2579) _2580)); (1,f) -> u f (\_2581 _2582 _2583-> (let _term_15=(u fm_term_ref "Nat.to_u32") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2576)) in (let _2584 = (u (u (u fm_parser_stop _2562) _2581) _2582) in (case _2584 of {(0,f) -> u f (\_2585 _2586 _2587-> (u (u (u parser_reply_error _2585) _2586) _2587)); (1,f) -> u f (\_2588 _2589 _2590-> (u (u (u parser_reply_value _2588) _2589) (u (u fm_term_ori _2590) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_u64 = (\_idx_1-> (\_code_2-> (let _2591 = (u (u fm_parser_init _idx_1) _code_2) in (case _2591 of {(0,f) -> u f (\_2592 _2593 _2594-> (u (u (u parser_reply_error _2592) _2593) _2594)); (1,f) -> u f (\_2595 _2596 _2597-> (let _2598 = (u (u fm_parser_spaces _2595) _2596) in (case _2598 of {(0,f) -> u f (\_2599 _2600 _2601-> (u (u (u parser_reply_error _2599) _2600) _2601)); (1,f) -> u f (\_2602 _2603 _2604-> (let _2605 = (u (u parser_nat _2602) _2603) in (case _2605 of {(0,f) -> u f (\_2606 _2607 _2608-> (u (u (u parser_reply_error _2606) _2607) _2608)); (1,f) -> u f (\_2609 _2610 _2611-> (let _2612 = (u (u (u parser_text "l") _2609) _2610) in (case _2612 of {(0,f) -> u f (\_2613 _2614 _2615-> (u (u (u parser_reply_error _2613) _2614) _2615)); (1,f) -> u f (\_2616 _2617 _2618-> (let _term_15=(u fm_term_ref "Nat.to_u64") in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_nat _2611)) in (let _2619 = (u (u (u fm_parser_stop _2597) _2616) _2617) in (case _2619 of {(0,f) -> u f (\_2620 _2621 _2622-> (u (u (u parser_reply_error _2620) _2621) _2622)); (1,f) -> u f (\_2623 _2624 _2625-> (u (u (u parser_reply_value _2623) _2624) (u (u fm_term_ori _2625) _term_16))); }))))); }))); }))); }))); }))))
fm_parser_nat = (\_idx_1-> (\_code_2-> (let _2626 = (u (u fm_parser_init _idx_1) _code_2) in (case _2626 of {(0,f) -> u f (\_2627 _2628 _2629-> (u (u (u parser_reply_error _2627) _2628) _2629)); (1,f) -> u f (\_2630 _2631 _2632-> (let _2633 = (u (u fm_parser_spaces _2630) _2631) in (case _2633 of {(0,f) -> u f (\_2634 _2635 _2636-> (u (u (u parser_reply_error _2634) _2635) _2636)); (1,f) -> u f (\_2637 _2638 _2639-> (let _2640 = (u (u parser_nat _2637) _2638) in (case _2640 of {(0,f) -> u f (\_2641 _2642 _2643-> (u (u (u parser_reply_error _2641) _2642) _2643)); (1,f) -> u f (\_2644 _2645 _2646-> (let _2647 = (u (u (u fm_parser_stop _2632) _2644) _2645) in (case _2647 of {(0,f) -> u f (\_2648 _2649 _2650-> (u (u (u parser_reply_error _2648) _2649) _2650)); (1,f) -> u f (\_2651 _2652 _2653-> (u (u (u parser_reply_value _2651) _2652) (u (u fm_term_ori _2653) (u fm_term_nat _2646)))); }))); }))); }))); }))))
string_eql = (\a0-> \a1-> ((a0::String) == a1))
parser_fail = (\_error_2-> (\_idx_3-> (\_code_4-> (u (u (u parser_reply_error _idx_3) _code_4) _error_2))))
fm_parser_reference = (\_idx_1-> (\_code_2-> (let _2654 = (u (u fm_parser_init _idx_1) _code_2) in (case _2654 of {(0,f) -> u f (\_2655 _2656 _2657-> (u (u (u parser_reply_error _2655) _2656) _2657)); (1,f) -> u f (\_2658 _2659 _2660-> (let _2661 = (u (u fm_parser_name1 _2658) _2659) in (case _2661 of {(0,f) -> u f (\_2662 _2663 _2664-> (u (u (u parser_reply_error _2662) _2663) _2664)); (1,f) -> u f (\_2665 _2666 _2667-> (let _2668 = (((_2667::String) == "case")) in (if _2668 then (u parser_fail "Reserved keyword.") else (let _2669 = (((_2667::String) == "do")) in (if _2669 then (u parser_fail "Reserved keyword.") else (let _2670 = (((_2667::String) == "if")) in (if _2670 then (u parser_fail "Reserved keyword.") else (let _2671 = (((_2667::String) == "with")) in (if _2671 then (u parser_fail "Reserved keyword.") else (let _2672 = (((_2667::String) == "let")) in (if _2672 then (u parser_fail "Reserved keyword.") else (let _2673 = (((_2667::String) == "def")) in (if _2673 then (u parser_fail "Reserved keyword.") else (let _2674 = (((_2667::String) == "true")) in (if _2674 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.true")))) else (let _2675 = (((_2667::String) == "false")) in (if _2675 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Bool.false")))) else (let _2676 = (((_2667::String) == "unit")) in (if _2676 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) (u fm_term_ref "Unit.new")))) else (let _2677 = (((_2667::String) == "none")) in (if _2677 then (let _term_9=(u fm_term_ref "Maybe.none") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (\_idx_11-> (\_code_12-> (u (u (u parser_reply_value _idx_11) _code_12) _term_10))))) else (let _2678 = (((_2667::String) == "refl")) in (if _2678 then (let _term_9=(u fm_term_ref "Equal.refl") in (let _term_10=(u (u fm_term_app _term_9) (u fm_term_hol bits_e)) in (let _term_11=(u (u fm_term_app _term_10) (u fm_term_hol bits_e)) in (\_idx_12-> (\_code_13-> (u (u (u parser_reply_value _idx_12) _code_13) _term_11)))))) else (\_idx_9-> (\_code_10-> (let _2679 = (u (u (u fm_parser_stop _2660) _idx_9) _code_10) in (case _2679 of {(0,f) -> u f (\_2680 _2681 _2682-> (u (u (u parser_reply_error _2680) _2681) _2682)); (1,f) -> u f (\_2683 _2684 _2685-> (u (u (u parser_reply_value _2683) _2684) (u (u fm_term_ori _2685) (u fm_term_ref _2667)))); })))))))))))))))))))))))))) _2665 _2666); }))); }))))
list_for = (\_xs_2-> (\_b_4-> (\_f_5-> (let _2686 = _xs_2 in (case _2686 of {(0,f) -> u f (_b_4); (1,f) -> u f (\_2687 _2688-> (u (u (u list_for _2688) (u (u _f_5 _2687) _b_4)) _f_5)); })))))
fm_parser_application = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2689 = (u (u (u parser_text "(") _idx_3) _code_4) in (case _2689 of {(0,f) -> u f (\_2690 _2691 _2692-> (u (u (u parser_reply_error _2690) _2691) _2692)); (1,f) -> u f (\_2693 _2694 _2695-> (let _2696 = (u (u (u (u parser_until1 (u fm_parser_text ")")) (u fm_parser_item fm_parser_term)) _2693) _2694) in (case _2696 of {(0,f) -> u f (\_2697 _2698 _2699-> (u (u (u parser_reply_error _2697) _2698) _2699)); (1,f) -> u f (\_2700 _2701 _2702-> (let _2703 = (u (u (u fm_parser_stop _init_1) _2700) _2701) in (case _2703 of {(0,f) -> u f (\_2704 _2705 _2706-> (u (u (u parser_reply_error _2704) _2705) _2706)); (1,f) -> u f (\_2707 _2708 _2709-> (let _expr_14=(u (u (u list_for _2702) _func_2) (\_x_14-> (\_f_15-> (u (u fm_term_app _f_15) _x_14)))) in (u (u (u parser_reply_value _2707) _2708) (u (u fm_term_ori _2709) _expr_14)))); }))); }))); }))))))
parser_spaces = (u parser_many (u parser_first_of (u (u list_cons (u parser_text " ")) (u (u list_cons (u parser_text "\n")) list_nil))))
parser_spaces_text = (\_text_1-> (\_idx_2-> (\_code_3-> (let _2710 = (u (u parser_spaces _idx_2) _code_3) in (case _2710 of {(0,f) -> u f (\_2711 _2712 _2713-> (u (u (u parser_reply_error _2711) _2712) _2713)); (1,f) -> u f (\_2714 _2715 _2716-> (u (u (u parser_text _text_1) _2714) _2715)); })))))
fm_parser_application_erased = (\_init_1-> (\_func_2-> (\_idx_3-> (\_code_4-> (let _2717 = (u (u parser_get_index _idx_3) _code_4) in (case _2717 of {(0,f) -> u f (\_2718 _2719 _2720-> (u (u (u parser_reply_error _2718) _2719) _2720)); (1,f) -> u f (\_2721 _2722 _2723-> (let _2724 = (u (u (u parser_text "<") _2721) _2722) in (case _2724 of {(0,f) -> u f (\_2725 _2726 _2727-> (u (u (u parser_reply_error _2725) _2726) _2727)); (1,f) -> u f (\_2728 _2729 _2730-> (let _2731 = (u (u (u (u parser_until1 (u parser_spaces_text ">")) (u fm_parser_item fm_parser_term)) _2728) _2729) in (case _2731 of {(0,f) -> u f (\_2732 _2733 _2734-> (u (u (u parser_reply_error _2732) _2733) _2734)); (1,f) -> u f (\_2735 _2736 _2737-> (let _2738 = (u (u (u fm_parser_stop _2723) _2735) _2736) in (case _2738 of {(0,f) -> u f (\_2739 _2740 _2741-> (u (u (u parser_reply_error _2739) _2740) _2741)); (1,f) -> u f (\_2742 _2743 _2744-> (let _expr_17=(u (u (u list_for _2737) _func_2) (\_x_17-> (\_f_18-> (u (u fm_term_app _f_18) _x_17)))) in (u (u (u parser_reply_value _2742) _2743) (u (u fm_term_ori _2744) _expr_17)))); }))); }))); }))); }))))))
fm_parser_arrow = (\_init_1-> (\_xtyp_2-> (\_idx_3-> (\_code_4-> (let _2745 = (u (u (u fm_parser_text "->") _idx_3) _code_4) in (case _2745 of {(0,f) -> u f (\_2746 _2747 _2748-> (u (u (u parser_reply_error _2746) _2747) _2748)); (1,f) -> u f (\_2749 _2750 _2751-> (let _2752 = (u (u fm_parser_term _2749) _2750) in (case _2752 of {(0,f) -> u f (\_2753 _2754 _2755-> (u (u (u parser_reply_error _2753) _2754) _2755)); (1,f) -> u f (\_2756 _2757 _2758-> (let _2759 = (u (u (u fm_parser_stop _init_1) _2756) _2757) in (case _2759 of {(0,f) -> u f (\_2760 _2761 _2762-> (u (u (u parser_reply_error _2760) _2761) _2762)); (1,f) -> u f (\_2763 _2764 _2765-> (u (u (u parser_reply_value _2763) _2764) (u (u fm_term_ori _2765) (u (u (u (u (u fm_term_all bool_false) "") "") _xtyp_2) (\_s_14-> (\_x_15-> _2758)))))); }))); }))); }))))))
fm_parser_op = (\_sym_1-> (\_ref_2-> (\_init_3-> (\_val0_4-> (\_idx_5-> (\_code_6-> (let _2766 = (u (u (u fm_parser_text _sym_1) _idx_5) _code_6) in (case _2766 of {(0,f) -> u f (\_2767 _2768 _2769-> (u (u (u parser_reply_error _2767) _2768) _2769)); (1,f) -> u f (\_2770 _2771 _2772-> (let _2773 = (u (u fm_parser_term _2770) _2771) in (case _2773 of {(0,f) -> u f (\_2774 _2775 _2776-> (u (u (u parser_reply_error _2774) _2775) _2776)); (1,f) -> u f (\_2777 _2778 _2779-> (let _2780 = (u (u (u fm_parser_stop _init_3) _2777) _2778) in (case _2780 of {(0,f) -> u f (\_2781 _2782 _2783-> (u (u (u parser_reply_error _2781) _2782) _2783)); (1,f) -> u f (\_2784 _2785 _2786-> (let _term_16=(u fm_term_ref _ref_2) in (let _term_17=(u (u fm_term_app _term_16) _val0_4) in (let _term_18=(u (u fm_term_app _term_17) _2779) in (u (u (u parser_reply_value _2784) _2785) (u (u fm_term_ori _2786) _term_18)))))); }))); }))); }))))))))
fm_parser_add = (u (u fm_parser_op "+") "Nat.add")
fm_parser_sub = (u (u fm_parser_op "+") "Nat.add")
fm_parser_mul = (u (u fm_parser_op "*") "Nat.mul")
fm_parser_div = (u (u fm_parser_op "/") "Nat.div")
fm_parser_mod = (u (u fm_parser_op "%") "Nat.mod")
fm_parser_cons = (\_init_1-> (\_head_2-> (\_idx_3-> (\_code_4-> (let _2787 = (u (u (u fm_parser_text "&") _idx_3) _code_4) in (case _2787 of {(0,f) -> u f (\_2788 _2789 _2790-> (u (u (u parser_reply_error _2788) _2789) _2790)); (1,f) -> u f (\_2791 _2792 _2793-> (let _2794 = (u (u fm_parser_term _2791) _2792) in (case _2794 of {(0,f) -> u f (\_2795 _2796 _2797-> (u (u (u parser_reply_error _2795) _2796) _2797)); (1,f) -> u f (\_2798 _2799 _2800-> (let _2801 = (u (u (u fm_parser_stop _init_1) _2798) _2799) in (case _2801 of {(0,f) -> u f (\_2802 _2803 _2804-> (u (u (u parser_reply_error _2802) _2803) _2804)); (1,f) -> u f (\_2805 _2806 _2807-> (let _term_14=(u fm_term_ref "List.cons") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _head_2) in (let _term_17=(u (u fm_term_app _term_16) _2800) in (let _2808 = (u (u (u fm_parser_stop _init_1) _2805) _2806) in (case _2808 of {(0,f) -> u f (\_2809 _2810 _2811-> (u (u (u parser_reply_error _2809) _2810) _2811)); (1,f) -> u f (\_2812 _2813 _2814-> (u (u (u parser_reply_value _2812) _2813) (u (u fm_term_ori _2814) _term_17))); }))))))); }))); }))); }))))))
fm_parser_concat = (\_init_1-> (\_lst0_2-> (\_idx_3-> (\_code_4-> (let _2815 = (u (u (u fm_parser_text "++") _idx_3) _code_4) in (case _2815 of {(0,f) -> u f (\_2816 _2817 _2818-> (u (u (u parser_reply_error _2816) _2817) _2818)); (1,f) -> u f (\_2819 _2820 _2821-> (let _2822 = (u (u fm_parser_term _2819) _2820) in (case _2822 of {(0,f) -> u f (\_2823 _2824 _2825-> (u (u (u parser_reply_error _2823) _2824) _2825)); (1,f) -> u f (\_2826 _2827 _2828-> (let _2829 = (u (u (u fm_parser_stop _init_1) _2826) _2827) in (case _2829 of {(0,f) -> u f (\_2830 _2831 _2832-> (u (u (u parser_reply_error _2830) _2831) _2832)); (1,f) -> u f (\_2833 _2834 _2835-> (let _term_14=(u fm_term_ref "List.concat") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _lst0_2) in (let _term_17=(u (u fm_term_app _term_16) _2828) in (let _2836 = (u (u (u fm_parser_stop _init_1) _2833) _2834) in (case _2836 of {(0,f) -> u f (\_2837 _2838 _2839-> (u (u (u parser_reply_error _2837) _2838) _2839)); (1,f) -> u f (\_2840 _2841 _2842-> (u (u (u parser_reply_value _2840) _2841) (u (u fm_term_ori _2842) _term_17))); }))))))); }))); }))); }))))))
fm_parser_string_concat = (\_init_1-> (\_str0_2-> (\_idx_3-> (\_code_4-> (let _2843 = (u (u (u fm_parser_text "|") _idx_3) _code_4) in (case _2843 of {(0,f) -> u f (\_2844 _2845 _2846-> (u (u (u parser_reply_error _2844) _2845) _2846)); (1,f) -> u f (\_2847 _2848 _2849-> (let _2850 = (u (u fm_parser_term _2847) _2848) in (case _2850 of {(0,f) -> u f (\_2851 _2852 _2853-> (u (u (u parser_reply_error _2851) _2852) _2853)); (1,f) -> u f (\_2854 _2855 _2856-> (let _2857 = (u (u (u fm_parser_stop _init_1) _2854) _2855) in (case _2857 of {(0,f) -> u f (\_2858 _2859 _2860-> (u (u (u parser_reply_error _2858) _2859) _2860)); (1,f) -> u f (\_2861 _2862 _2863-> (let _term_14=(u fm_term_ref "String.concat") in (let _term_15=(u (u fm_term_app _term_14) _str0_2) in (let _term_16=(u (u fm_term_app _term_15) _2856) in (let _2864 = (u (u (u fm_parser_stop _init_1) _2861) _2862) in (case _2864 of {(0,f) -> u f (\_2865 _2866 _2867-> (u (u (u parser_reply_error _2865) _2866) _2867)); (1,f) -> u f (\_2868 _2869 _2870-> (u (u (u parser_reply_value _2868) _2869) (u (u fm_term_ori _2870) _term_16))); })))))); }))); }))); }))))))
fm_parser_sigma = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2871 = (u (u (u fm_parser_text "~") _idx_3) _code_4) in (case _2871 of {(0,f) -> u f (\_2872 _2873 _2874-> (u (u (u parser_reply_error _2872) _2873) _2874)); (1,f) -> u f (\_2875 _2876 _2877-> (let _2878 = (u (u fm_parser_term _2875) _2876) in (case _2878 of {(0,f) -> u f (\_2879 _2880 _2881-> (u (u (u parser_reply_error _2879) _2880) _2881)); (1,f) -> u f (\_2882 _2883 _2884-> (let _2885 = (u (u (u fm_parser_stop _init_1) _2882) _2883) in (case _2885 of {(0,f) -> u f (\_2886 _2887 _2888-> (u (u (u parser_reply_error _2886) _2887) _2888)); (1,f) -> u f (\_2889 _2890 _2891-> (let _term_14=(u fm_term_ref "Sigma.new") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) (u fm_term_hol bits_e)) in (let _term_17=(u (u fm_term_app _term_16) _val0_2) in (let _term_18=(u (u fm_term_app _term_17) _2884) in (u (u (u parser_reply_value _2889) _2890) (u (u fm_term_ori _2891) _term_18)))))))); }))); }))); }))))))
fm_parser_equality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2892 = (u (u (u fm_parser_text "==") _idx_3) _code_4) in (case _2892 of {(0,f) -> u f (\_2893 _2894 _2895-> (u (u (u parser_reply_error _2893) _2894) _2895)); (1,f) -> u f (\_2896 _2897 _2898-> (let _2899 = (u (u fm_parser_term _2896) _2897) in (case _2899 of {(0,f) -> u f (\_2900 _2901 _2902-> (u (u (u parser_reply_error _2900) _2901) _2902)); (1,f) -> u f (\_2903 _2904 _2905-> (let _2906 = (u (u (u fm_parser_stop _init_1) _2903) _2904) in (case _2906 of {(0,f) -> u f (\_2907 _2908 _2909-> (u (u (u parser_reply_error _2907) _2908) _2909)); (1,f) -> u f (\_2910 _2911 _2912-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2905) in (u (u (u parser_reply_value _2910) _2911) (u (u fm_term_ori _2912) _term_17))))))); }))); }))); }))))))
fm_parser_inequality = (\_init_1-> (\_val0_2-> (\_idx_3-> (\_code_4-> (let _2913 = (u (u (u fm_parser_text "!=") _idx_3) _code_4) in (case _2913 of {(0,f) -> u f (\_2914 _2915 _2916-> (u (u (u parser_reply_error _2914) _2915) _2916)); (1,f) -> u f (\_2917 _2918 _2919-> (let _2920 = (u (u fm_parser_term _2917) _2918) in (case _2920 of {(0,f) -> u f (\_2921 _2922 _2923-> (u (u (u parser_reply_error _2921) _2922) _2923)); (1,f) -> u f (\_2924 _2925 _2926-> (let _2927 = (u (u (u fm_parser_stop _init_1) _2924) _2925) in (case _2927 of {(0,f) -> u f (\_2928 _2929 _2930-> (u (u (u parser_reply_error _2928) _2929) _2930)); (1,f) -> u f (\_2931 _2932 _2933-> (let _term_14=(u fm_term_ref "Equal") in (let _term_15=(u (u fm_term_app _term_14) (u fm_term_hol bits_e)) in (let _term_16=(u (u fm_term_app _term_15) _val0_2) in (let _term_17=(u (u fm_term_app _term_16) _2926) in (let _term_18=(u (u fm_term_app (u fm_term_ref "Not")) _term_17) in (u (u (u parser_reply_value _2931) _2932) (u (u fm_term_ori _2933) _term_18)))))))); }))); }))); }))))))
fm_parser_rewrite = (\_init_1-> (\_subt_2-> (\_idx_3-> (\_code_4-> (let _2934 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2934 of {(0,f) -> u f (\_2935 _2936 _2937-> (u (u (u parser_reply_error _2935) _2936) _2937)); (1,f) -> u f (\_2938 _2939 _2940-> (let _2941 = (u (u (u fm_parser_text "rewrite") _2938) _2939) in (case _2941 of {(0,f) -> u f (\_2942 _2943 _2944-> (u (u (u parser_reply_error _2942) _2943) _2944)); (1,f) -> u f (\_2945 _2946 _2947-> (let _2948 = (u (u fm_parser_name1 _2945) _2946) in (case _2948 of {(0,f) -> u f (\_2949 _2950 _2951-> (u (u (u parser_reply_error _2949) _2950) _2951)); (1,f) -> u f (\_2952 _2953 _2954-> (let _2955 = (u (u (u fm_parser_text "in") _2952) _2953) in (case _2955 of {(0,f) -> u f (\_2956 _2957 _2958-> (u (u (u parser_reply_error _2956) _2957) _2958)); (1,f) -> u f (\_2959 _2960 _2961-> (let _2962 = (u (u fm_parser_term _2959) _2960) in (case _2962 of {(0,f) -> u f (\_2963 _2964 _2965-> (u (u (u parser_reply_error _2963) _2964) _2965)); (1,f) -> u f (\_2966 _2967 _2968-> (let _2969 = (u (u (u fm_parser_text "with") _2966) _2967) in (case _2969 of {(0,f) -> u f (\_2970 _2971 _2972-> (u (u (u parser_reply_error _2970) _2971) _2972)); (1,f) -> u f (\_2973 _2974 _2975-> (let _2976 = (u (u fm_parser_term _2973) _2974) in (case _2976 of {(0,f) -> u f (\_2977 _2978 _2979-> (u (u (u parser_reply_error _2977) _2978) _2979)); (1,f) -> u f (\_2980 _2981 _2982-> (let _2983 = (u (u (u fm_parser_stop _init_1) _2980) _2981) in (case _2983 of {(0,f) -> u f (\_2984 _2985 _2986-> (u (u (u parser_reply_error _2984) _2985) _2986)); (1,f) -> u f (\_2987 _2988 _2989-> (let _term_29=(u fm_term_ref "Equal.rewrite") in (let _term_30=(u (u fm_term_app _term_29) (u fm_term_hol bits_e)) in (let _term_31=(u (u fm_term_app _term_30) (u fm_term_hol bits_e)) in (let _term_32=(u (u fm_term_app _term_31) (u fm_term_hol bits_e)) in (let _term_33=(u (u fm_term_app _term_32) _2982) in (let _term_34=(u (u fm_term_app _term_33) (u (u fm_term_lam _2954) (\_x_34-> _2968))) in (let _term_35=(u (u fm_term_app _term_34) _subt_2) in (u (u (u parser_reply_value _2987) _2988) (u (u fm_term_ori _2989) _term_35)))))))))); }))); }))); }))); }))); }))); }))); }))); }))))))
fm_term_ann = (\_done_1-> (\_term_2-> (\_type_3-> (8,\t-> t _done_1 _term_2 _type_3))))
fm_parser_annotation = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _2990 = (u (u (u fm_parser_text "::") _idx_3) _code_4) in (case _2990 of {(0,f) -> u f (\_2991 _2992 _2993-> (u (u (u parser_reply_error _2991) _2992) _2993)); (1,f) -> u f (\_2994 _2995 _2996-> (let _2997 = (u (u fm_parser_term _2994) _2995) in (case _2997 of {(0,f) -> u f (\_2998 _2999 _3000-> (u (u (u parser_reply_error _2998) _2999) _3000)); (1,f) -> u f (\_3001 _3002 _3003-> (let _3004 = (u (u (u fm_parser_stop _init_1) _3001) _3002) in (case _3004 of {(0,f) -> u f (\_3005 _3006 _3007-> (u (u (u parser_reply_error _3005) _3006) _3007)); (1,f) -> u f (\_3008 _3009 _3010-> (u (u (u parser_reply_value _3008) _3009) (u (u fm_term_ori _3010) (u (u (u fm_term_ann bool_false) _term_2) _3003)))); }))); }))); }))))))
fm_parser_application_hole = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _3011 = (u (u (u fm_parser_text "!") _idx_3) _code_4) in (case _3011 of {(0,f) -> u f (\_3012 _3013 _3014-> (u (u (u parser_reply_error _3012) _3013) _3014)); (1,f) -> u f (\_3015 _3016 _3017-> (let _3018 = (u (u (u fm_parser_stop _init_1) _3015) _3016) in (case _3018 of {(0,f) -> u f (\_3019 _3020 _3021-> (u (u (u parser_reply_error _3019) _3020) _3021)); (1,f) -> u f (\_3022 _3023 _3024-> (u (u (u parser_reply_value _3022) _3023) (u (u fm_term_ori _3024) (u (u fm_term_app _term_2) (u fm_term_hol bits_e))))); }))); }))))))
fm_parser_suffix = (\_init_1-> (\_term_2-> (\_idx_3-> (\_code_4-> (let _suffix_parser_5=(u parser_first_of (u (u list_cons (u (u fm_parser_application _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_erased _init_1) _term_2)) (u (u list_cons (u (u fm_parser_arrow _init_1) _term_2)) (u (u list_cons (u (u fm_parser_add _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sub _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mul _init_1) _term_2)) (u (u list_cons (u (u fm_parser_div _init_1) _term_2)) (u (u list_cons (u (u fm_parser_mod _init_1) _term_2)) (u (u list_cons (u (u fm_parser_cons _init_1) _term_2)) (u (u list_cons (u (u fm_parser_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_string_concat _init_1) _term_2)) (u (u list_cons (u (u fm_parser_sigma _init_1) _term_2)) (u (u list_cons (u (u fm_parser_equality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_inequality _init_1) _term_2)) (u (u list_cons (u (u fm_parser_rewrite _init_1) _term_2)) (u (u list_cons (u (u fm_parser_annotation _init_1) _term_2)) (u (u list_cons (u (u fm_parser_application_hole _init_1) _term_2)) list_nil)))))))))))))))))) in (let _3025 = (u (u _suffix_parser_5 _idx_3) _code_4) in (case _3025 of {(0,f) -> u f (\_3026 _3027 _3028-> (u (u (u parser_reply_value _idx_3) _code_4) _term_2)); (1,f) -> u f (\_3029 _3030 _3031-> (u (u (u (u fm_parser_suffix _init_1) _3031) _3029) _3030)); })))))))
fm_parser_term = (\_idx_1-> (\_code_2-> (let _3032 = (u (u fm_parser_init _idx_1) _code_2) in (case _3032 of {(0,f) -> u f (\_3033 _3034 _3035-> (u (u (u parser_reply_error _3033) _3034) _3035)); (1,f) -> u f (\_3036 _3037 _3038-> (let _3039 = (u (u (u parser_first_of (u (u list_cons fm_parser_type) (u (u list_cons fm_parser_forall) (u (u list_cons fm_parser_lambda) (u (u list_cons fm_parser_lambda_erased) (u (u list_cons fm_parser_lambda_nameless) (u (u list_cons fm_parser_parenthesis) (u (u list_cons fm_parser_letforrange_u32) (u (u list_cons fm_parser_letforin) (u (u list_cons fm_parser_let) (u (u list_cons fm_parser_get) (u (u list_cons fm_parser_def) (u (u list_cons fm_parser_if) (u (u list_cons fm_parser_char) (u (u list_cons fm_parser_string) (u (u list_cons fm_parser_pair) (u (u list_cons fm_parser_sigma_type) (u (u list_cons fm_parser_some) (u (u list_cons fm_parser_apply) (u (u list_cons fm_parser_mirror) (u (u list_cons fm_parser_list) (u (u list_cons fm_parser_log) (u (u list_cons fm_parser_forrange_u32) (u (u list_cons fm_parser_forrange_u32_2) (u (u list_cons fm_parser_forin) (u (u list_cons fm_parser_forin_2) (u (u list_cons fm_parser_do) (u (u list_cons fm_parser_case) (u (u list_cons fm_parser_open) (u (u list_cons fm_parser_goal) (u (u list_cons fm_parser_hole) (u (u list_cons fm_parser_u8) (u (u list_cons fm_parser_u16) (u (u list_cons fm_parser_u32) (u (u list_cons fm_parser_u64) (u (u list_cons fm_parser_nat) (u (u list_cons fm_parser_reference) list_nil))))))))))))))))))))))))))))))))))))) _3036) _3037) in (case _3039 of {(0,f) -> u f (\_3040 _3041 _3042-> (u (u (u parser_reply_error _3040) _3041) _3042)); (1,f) -> u f (\_3043 _3044 _3045-> (u (u (u (u fm_parser_suffix _3038) _3045) _3043) _3044)); }))); }))))
fm_parser_name_term = (\_idx_1-> (\_code_2-> (let _3046 = (u (u fm_parser_name _idx_1) _code_2) in (case _3046 of {(0,f) -> u f (\_3047 _3048 _3049-> (u (u (u parser_reply_error _3047) _3048) _3049)); (1,f) -> u f (\_3050 _3051 _3052-> (let _3053 = (u (u (u fm_parser_text ":") _3050) _3051) in (case _3053 of {(0,f) -> u f (\_3054 _3055 _3056-> (u (u (u parser_reply_error _3054) _3055) _3056)); (1,f) -> u f (\_3057 _3058 _3059-> (let _3060 = (u (u fm_parser_term _3057) _3058) in (case _3060 of {(0,f) -> u f (\_3061 _3062 _3063-> (u (u (u parser_reply_error _3061) _3062) _3063)); (1,f) -> u f (\_3064 _3065 _3066-> (u (u (u parser_reply_value _3064) _3065) (u (u pair_new _3052) _3066))); }))); }))); }))))
fm_binder_new = (\_eras_1-> (\_name_2-> (\_term_3-> (0,\t-> t _eras_1 _name_2 _term_3))))
fm_parser_binder_homo = (\_eras_1-> (\_idx_2-> (\_code_3-> (let _3067 = (u (u (u fm_parser_text (let _3068 = _eras_1 in (if _3068 then "<" else "("))) _idx_2) _code_3) in (case _3067 of {(0,f) -> u f (\_3069 _3070 _3071-> (u (u (u parser_reply_error _3069) _3070) _3071)); (1,f) -> u f (\_3072 _3073 _3074-> (let _3075 = (u (u (u (u parser_until1 (u fm_parser_text (let _3076 = _eras_1 in (if _3076 then ">" else ")")))) (u fm_parser_item fm_parser_name_term)) _3072) _3073) in (case _3075 of {(0,f) -> u f (\_3077 _3078 _3079-> (u (u (u parser_reply_error _3077) _3078) _3079)); (1,f) -> u f (\_3080 _3081 _3082-> (u (u (u parser_reply_value _3080) _3081) (u (u list_mapped _3082) (\_pair_10-> (let _3083 = _pair_10 in (case _3083 of {(0,f) -> u f (\_3084 _3085-> (u (u (u fm_binder_new _eras_1) _3084) _3085)); })))))); }))); })))))
list_concat = (\_as_2-> (\_bs_3-> (let _3086 = _as_2 in (case _3086 of {(0,f) -> u f (_bs_3); (1,f) -> u f (\_3087 _3088-> (u (u list_cons _3087) (u (u list_concat _3088) _bs_3))); }))))
list_flatten = (\_xs_2-> (let _3089 = _xs_2 in (case _3089 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3090 _3091-> (u (u list_concat _3090) (u list_flatten _3091))); })))
fm_parser_binder = (\_idx_1-> (\_code_2-> (let _3092 = (u (u (u parser_many1 (u parser_first_of (u (u list_cons (u fm_parser_binder_homo bool_true)) (u (u list_cons (u fm_parser_binder_homo bool_false)) list_nil)))) _idx_1) _code_2) in (case _3092 of {(0,f) -> u f (\_3093 _3094 _3095-> (u (u (u parser_reply_error _3093) _3094) _3095)); (1,f) -> u f (\_3096 _3097 _3098-> (u (u (u parser_reply_value _3096) _3097) (u list_flatten _3098))); }))))
list_length = (\_xs_2-> (let _3099 = _xs_2 in (case _3099 of {(0,f) -> u f (0); (1,f) -> u f (\_3100 _3101-> (u nat_succ (u list_length _3101))); })))
fm_parser_make_forall = (\_binds_1-> (\_body_2-> (let _3102 = _binds_1 in (case _3102 of {(0,f) -> u f (_body_2); (1,f) -> u f (\_3103 _3104-> (let _3105 = _3103 in (case _3105 of {(0,f) -> u f (\_3106 _3107 _3108-> (u (u (u (u (u fm_term_all _3106) "") _3107) _3108) (\_s_8-> (\_x_9-> (u (u fm_parser_make_forall _3104) _body_2))))); }))); }))))
list_at = (\_index_2-> (\_list_3-> (let _3109 = _list_3 in (case _3109 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3110 _3111-> (let _3112 = _index_2 in (if _3112==0 then (u maybe_some _3110) else (u (u list_at (_3112-1)) _3111)))); }))))
list_at_last = (\_index_2-> (\_list_3-> (u (u list_at _index_2) (u list_reverse _list_3))))
fm_term_var = (\_name_1-> (\_indx_2-> (0,\t-> t _name_1 _indx_2)))
fm_context_get_name_skips = (\_name_1-> (let _3113 = _name_1 in (if null (_3113::String) then (u (u pair_new "") 0) else (let _name_skips_4=(u fm_context_get_name_skips (tail _3113)) in (let _3114 = _name_skips_4 in (case _3114 of {(0,f) -> u f (\_3115 _3116-> (let _3117 = ((((fromIntegral (fromEnum (head _3113 :: Char)) :: Word16)::Word16) == 94)) in (if _3117 then (u (u pair_new _3115) (u nat_succ _3116)) else (u (u pair_new (u (u string_cons (fromIntegral (fromEnum (head _3113 :: Char)) :: Word16)) _3115)) _3116)))); }))))))
fm_name_eql = (\_a_1-> (\_b_2-> (((_a_1::String) == _b_2))))
fm_context_find_go = (\_name_1-> (\_skip_2-> (\_ctx_3-> (let _3118 = _ctx_3 in (case _3118 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3119 _3120-> (let _3121 = _3119 in (case _3121 of {(0,f) -> u f (\_3122 _3123-> (let _3124 = (u (u fm_name_eql _name_1) _3122) in (if _3124 then (let _3125 = _skip_2 in (if _3125==0 then (u maybe_some _3123) else (u (u (u fm_context_find_go _name_1) (_3125-1)) _3120))) else (u (u (u fm_context_find_go _name_1) _skip_2) _3120)))); }))); })))))
fm_context_find = (\_name_1-> (\_ctx_2-> (let _3126 = (u fm_context_get_name_skips _name_1) in (case _3126 of {(0,f) -> u f (\_3127 _3128-> (u (u (u fm_context_find_go _3127) _3128) _ctx_2)); }))))
fm_path_o = (\_path_1-> (\_x_2-> (u _path_1 (u bits_o _x_2))))
fm_path_i = (\_path_1-> (\_x_2-> (u _path_1 (u bits_i _x_2))))
fm_path_to_bits = (\_path_1-> (u _path_1 bits_e))
fm_term_bind = (\_vars_1-> (\_path_2-> (\_term_3-> (let _3129 = _term_3 in (case _3129 of {(0,f) -> u f (\_3130 _3131-> (let _3132 = (u (u list_at_last _3131) _vars_1) in (case _3132 of {(0,f) -> u f ((u (u fm_term_var _3130) _3131)); (1,f) -> u f (\_3133-> (u pair_snd _3133)); }))); (1,f) -> u f (\_3134-> (let _3135 = (u (u fm_context_find _3134) _vars_1) in (case _3135 of {(0,f) -> u f ((u fm_term_ref _3134)); (1,f) -> u f (\_3136-> _3136); }))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3137 _3138 _3139 _3140 _3141-> (let _vlen_9=(u list_length _vars_1) in (u (u (u (u (u fm_term_all _3137) _3138) _3139) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3140)) (\_s_10-> (\_x_11-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3139) _x_11)) (u (u list_cons (u (u pair_new _3138) _s_10)) _vars_1))) (u fm_path_i _path_2)) (u (u _3141 (u (u fm_term_var _3138) _vlen_9)) (u (u fm_term_var _3139) (u nat_succ _vlen_9))))))))); (4,f) -> u f (\_3142 _3143-> (let _vlen_6=(u list_length _vars_1) in (u (u fm_term_lam _3142) (\_x_7-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3142) _x_7)) _vars_1)) (u fm_path_o _path_2)) (u _3143 (u (u fm_term_var _3142) _vlen_6))))))); (5,f) -> u f (\_3144 _3145-> (u (u fm_term_app (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3144)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3145))); (6,f) -> u f (\_3146 _3147 _3148-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_let _3146) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3147)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3146) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3148 (u (u fm_term_var _3146) _vlen_7))))))); (7,f) -> u f (\_3149 _3150 _3151-> (let _vlen_7=(u list_length _vars_1) in (u (u (u fm_term_def _3149) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3150)) (\_x_8-> (u (u (u fm_term_bind (u (u list_cons (u (u pair_new _3149) _x_8)) _vars_1)) (u fm_path_i _path_2)) (u _3151 (u (u fm_term_var _3149) _vlen_7))))))); (8,f) -> u f (\_3152 _3153 _3154-> (u (u (u fm_term_ann _3152) (u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3153)) (u (u (u fm_term_bind _vars_1) (u fm_path_i _path_2)) _3154))); (9,f) -> u f (\_3155 _3156 _3157-> (u (u (u fm_term_gol _3155) _3156) _3157)); (10,f) -> u f (\_3158-> (u fm_term_hol (u fm_path_to_bits _path_2))); (11,f) -> u f (\_3159-> (u fm_term_nat _3159)); (12,f) -> u f (\_3160-> (u fm_term_chr _3160)); (13,f) -> u f (\_3161-> (u fm_term_str _3161)); (14,f) -> u f (\_3162 _3163 _3164 _3165 _3166 _3167-> (let _expr_10=(u (u (u fm_term_bind _vars_1) (u fm_path_o _path_2)) _3163) in (let _name_11=_3164 in (let _wyth_12=_3165 in (let _cses_13=_3166 in (let _moti_14=_3167 in (u (u (u (u (u (u fm_term_cse (u fm_path_to_bits _path_2)) _expr_10) _name_11) _wyth_12) _cses_13) _moti_14))))))); (15,f) -> u f (\_3168 _3169-> (u (u fm_term_ori _3168) (u (u (u fm_term_bind _vars_1) _path_2) _3169))); })))))
fm_status_done = (2,\t-> t)
fm_define = (\_file_1-> (\_code_2-> (\_orig_3-> (\_name_4-> (\_term_5-> (\_type_6-> (\_isct_7-> (\_arit_8-> (\_done_9-> (\_defs_10-> (let _stat_11=(let _3170 = _done_9 in (if _3170 then fm_status_done else fm_status_init)) in (u (u (u fm_set _name_4) (u (u (u (u (u (u (u (u (u fm_def_new _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _stat_11)) _defs_10))))))))))))
fm_parser_file_def = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3171 = (u (u fm_parser_init _idx_4) _code_5) in (case _3171 of {(0,f) -> u f (\_3172 _3173 _3174-> (u (u (u parser_reply_error _3172) _3173) _3174)); (1,f) -> u f (\_3175 _3176 _3177-> (let _3178 = (u (u fm_parser_name1 _3175) _3176) in (case _3178 of {(0,f) -> u f (\_3179 _3180 _3181-> (u (u (u parser_reply_error _3179) _3180) _3181)); (1,f) -> u f (\_3182 _3183 _3184-> (let _3185 = (u (u (u parser_many fm_parser_binder) _3182) _3183) in (case _3185 of {(0,f) -> u f (\_3186 _3187 _3188-> (u (u (u parser_reply_error _3186) _3187) _3188)); (1,f) -> u f (\_3189 _3190 _3191-> (let _args_15=(u list_flatten _3191) in (let _3192 = (u (u (u fm_parser_text ":") _3189) _3190) in (case _3192 of {(0,f) -> u f (\_3193 _3194 _3195-> (u (u (u parser_reply_error _3193) _3194) _3195)); (1,f) -> u f (\_3196 _3197 _3198-> (let _3199 = (u (u fm_parser_term _3196) _3197) in (case _3199 of {(0,f) -> u f (\_3200 _3201 _3202-> (u (u (u parser_reply_error _3200) _3201) _3202)); (1,f) -> u f (\_3203 _3204 _3205-> (let _3206 = (u (u fm_parser_term _3203) _3204) in (case _3206 of {(0,f) -> u f (\_3207 _3208 _3209-> (u (u (u parser_reply_error _3207) _3208) _3209)); (1,f) -> u f (\_3210 _3211 _3212-> (let _3213 = (u (u (u fm_parser_stop _3177) _3210) _3211) in (case _3213 of {(0,f) -> u f (\_3214 _3215 _3216-> (u (u (u parser_reply_error _3214) _3215) _3216)); (1,f) -> u f (\_3217 _3218 _3219-> (let _arit_28=(u list_length _args_15) in (let _type_29=(u (u fm_parser_make_forall _args_15) _3205) in (let _term_30=(u (u fm_parser_make_lambda (u (u list_mapped _args_15) (\_x_30-> (let _3220 = _x_30 in (case _3220 of {(0,f) -> u f (\_3221 _3222 _3223-> _3222); }))))) _3212) in (let _type_31=(u (u (u fm_term_bind list_nil) (\_x_31-> (u bits_i _x_31))) _type_29) in (let _term_32=(u (u (u fm_term_bind list_nil) (\_x_32-> (u bits_o _x_32))) _term_30) in (let _defs_33=(u (u (u (u (u (u (u (u (u (u fm_define _file_1) _code_2) _3219) _3184) _term_32) _type_31) bool_false) _arit_28) bool_false) _defs_3) in (u (u (u parser_reply_value _3217) _3218) _defs_33)))))))); }))); }))); }))); })))); }))); }))); })))))))
maybe_default = (\_a_2-> (\_m_3-> (let _3224 = _m_3 in (case _3224 of {(0,f) -> u f (_a_2); (1,f) -> u f (\_3225-> _3225); }))))
fm_constructor_new = (\_name_1-> (\_args_2-> (\_inds_3-> (0,\t-> t _name_1 _args_2 _inds_3))))
fm_parser_constructor = (\_namespace_1-> (\_idx_2-> (\_code_3-> (let _3226 = (u (u fm_parser_name1 _idx_2) _code_3) in (case _3226 of {(0,f) -> u f (\_3227 _3228 _3229-> (u (u (u parser_reply_error _3227) _3228) _3229)); (1,f) -> u f (\_3230 _3231 _3232-> (let _3233 = (u (u (u parser_maybe fm_parser_binder) _3230) _3231) in (case _3233 of {(0,f) -> u f (\_3234 _3235 _3236-> (u (u (u parser_reply_error _3234) _3235) _3236)); (1,f) -> u f (\_3237 _3238 _3239-> (let _3240 = (u (u (u parser_maybe (\_idx_10-> (\_code_11-> (let _3241 = (u (u (u fm_parser_text "~") _idx_10) _code_11) in (case _3241 of {(0,f) -> u f (\_3242 _3243 _3244-> (u (u (u parser_reply_error _3242) _3243) _3244)); (1,f) -> u f (\_3245 _3246 _3247-> (u (u fm_parser_binder _3245) _3246)); }))))) _3237) _3238) in (case _3240 of {(0,f) -> u f (\_3248 _3249 _3250-> (u (u (u parser_reply_error _3248) _3249) _3250)); (1,f) -> u f (\_3251 _3252 _3253-> (let _args_13=(u (u maybe_default list_nil) _3239) in (let _inds_14=(u (u maybe_default list_nil) _3253) in (u (u (u parser_reply_value _3251) _3252) (u (u (u fm_constructor_new _3232) _args_13) _inds_14))))); }))); }))); })))))
fm_datatype_new = (\_name_1-> (\_pars_2-> (\_inds_3-> (\_ctrs_4-> (0,\t-> t _name_1 _pars_2 _inds_3 _ctrs_4)))))
fm_parser_datatype = (\_idx_1-> (\_code_2-> (let _3254 = (u (u (u fm_parser_text "type ") _idx_1) _code_2) in (case _3254 of {(0,f) -> u f (\_3255 _3256 _3257-> (u (u (u parser_reply_error _3255) _3256) _3257)); (1,f) -> u f (\_3258 _3259 _3260-> (let _3261 = (u (u fm_parser_name1 _3258) _3259) in (case _3261 of {(0,f) -> u f (\_3262 _3263 _3264-> (u (u (u parser_reply_error _3262) _3263) _3264)); (1,f) -> u f (\_3265 _3266 _3267-> (let _3268 = (u (u (u parser_maybe fm_parser_binder) _3265) _3266) in (case _3268 of {(0,f) -> u f (\_3269 _3270 _3271-> (u (u (u parser_reply_error _3269) _3270) _3271)); (1,f) -> u f (\_3272 _3273 _3274-> (let _3275 = (u (u (u parser_maybe (\_idx_12-> (\_code_13-> (let _3276 = (u (u (u fm_parser_text "~") _idx_12) _code_13) in (case _3276 of {(0,f) -> u f (\_3277 _3278 _3279-> (u (u (u parser_reply_error _3277) _3278) _3279)); (1,f) -> u f (\_3280 _3281 _3282-> (u (u fm_parser_binder _3280) _3281)); }))))) _3272) _3273) in (case _3275 of {(0,f) -> u f (\_3283 _3284 _3285-> (u (u (u parser_reply_error _3283) _3284) _3285)); (1,f) -> u f (\_3286 _3287 _3288-> (let _pars_15=(u (u maybe_default list_nil) _3274) in (let _inds_16=(u (u maybe_default list_nil) _3288) in (let _3289 = (u (u (u fm_parser_text "{") _3286) _3287) in (case _3289 of {(0,f) -> u f (\_3290 _3291 _3292-> (u (u (u parser_reply_error _3290) _3291) _3292)); (1,f) -> u f (\_3293 _3294 _3295-> (let _3296 = (u (u (u (u parser_until (u fm_parser_text "}")) (u fm_parser_item (u fm_parser_constructor _3267))) _3293) _3294) in (case _3296 of {(0,f) -> u f (\_3297 _3298 _3299-> (u (u (u parser_reply_error _3297) _3298) _3299)); (1,f) -> u f (\_3300 _3301 _3302-> (u (u (u parser_reply_value _3300) _3301) (u (u (u (u fm_datatype_new _3267) _pars_15) _inds_16) _3302))); }))); }))))); }))); }))); }))); }))))
fm_datatype_build_term_motive_go = (\_type_1-> (\_name_2-> (\_inds_3-> (let _3303 = _inds_3 in (case _3303 of {(0,f) -> u f ((let _3304 = _type_1 in (case _3304 of {(0,f) -> u f (\_3305 _3306 _3307 _3308-> (let _slf_8=(u fm_term_ref _name_2) in (let _slf_9=(u (u (u list_for _3306) _slf_8) (\_var_9-> (\_slf_10-> (u (u fm_term_app _slf_10) (u fm_term_ref (let _3309 = _var_9 in (case _3309 of {(0,f) -> u f (\_3310 _3311 _3312-> _3311); }))))))) in (let _slf_10=(u (u (u list_for _3307) _slf_9) (\_var_10-> (\_slf_11-> (u (u fm_term_app _slf_11) (u fm_term_ref (let _3313 = _var_10 in (case _3313 of {(0,f) -> u f (\_3314 _3315 _3316-> _3315); }))))))) in (u (u (u (u (u fm_term_all bool_false) "") "") _slf_10) (\_s_11-> (\_x_12-> fm_term_typ))))))); }))); (1,f) -> u f (\_3317 _3318-> (let _3319 = _3317 in (case _3319 of {(0,f) -> u f (\_3320 _3321 _3322-> (u (u (u (u (u fm_term_all _3320) "") _3321) _3322) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_motive_go _type_1) _name_2) _3318))))); }))); })))))
fm_datatype_build_term_motive = (\_type_1-> (let _3323 = _type_1 in (case _3323 of {(0,f) -> u f (\_3324 _3325 _3326 _3327-> (u (u (u fm_datatype_build_term_motive_go _type_1) _3324) _3326)); })))
fm_datatype_build_term_constructor_go = (\_type_1-> (\_ctor_2-> (\_args_3-> (let _3328 = _args_3 in (case _3328 of {(0,f) -> u f ((let _3329 = _type_1 in (case _3329 of {(0,f) -> u f (\_3330 _3331 _3332 _3333-> (let _3334 = _ctor_2 in (case _3334 of {(0,f) -> u f (\_3335 _3336 _3337-> (let _ret_11=(u fm_term_ref (u fm_name_read "P")) in (let _ret_12=(u (u (u list_for _3337) _ret_11) (\_var_12-> (\_ret_13-> (u (u fm_term_app _ret_13) (let _3338 = _var_12 in (case _3338 of {(0,f) -> u f (\_3339 _3340 _3341-> _3341); })))))) in (let _ctr_13=(u string_flatten (u (u list_cons _3330) (u (u list_cons (u fm_name_read ".")) (u (u list_cons _3335) list_nil)))) in (let _slf_14=(u fm_term_ref _ctr_13) in (let _slf_15=(u (u (u list_for _3331) _slf_14) (\_var_15-> (\_slf_16-> (u (u fm_term_app _slf_16) (u fm_term_ref (let _3342 = _var_15 in (case _3342 of {(0,f) -> u f (\_3343 _3344 _3345-> _3344); }))))))) in (let _slf_16=(u (u (u list_for _3336) _slf_15) (\_var_16-> (\_slf_17-> (u (u fm_term_app _slf_17) (u fm_term_ref (let _3346 = _var_16 in (case _3346 of {(0,f) -> u f (\_3347 _3348 _3349-> _3348); }))))))) in (u (u fm_term_app _ret_12) _slf_16)))))))); }))); }))); (1,f) -> u f (\_3350 _3351-> (let _3352 = _3350 in (case _3352 of {(0,f) -> u f (\_3353 _3354 _3355-> (let _eras_9=_3353 in (let _name_10=_3354 in (let _xtyp_11=_3355 in (let _body_12=(u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3351) in (u (u (u (u (u fm_term_all _eras_9) "") _name_10) _xtyp_11) (\_s_13-> (\_x_14-> _body_12)))))))); }))); })))))
fm_datatype_build_term_constructor = (\_type_1-> (\_ctor_2-> (let _3356 = _ctor_2 in (case _3356 of {(0,f) -> u f (\_3357 _3358 _3359-> (u (u (u fm_datatype_build_term_constructor_go _type_1) _ctor_2) _3358)); }))))
fm_datatype_build_term_constructors_go = (\_type_1-> (\_name_2-> (\_ctrs_3-> (let _3360 = _ctrs_3 in (case _3360 of {(0,f) -> u f ((let _3361 = _type_1 in (case _3361 of {(0,f) -> u f (\_3362 _3363 _3364 _3365-> (let _ret_8=(u fm_term_ref (u fm_name_read "P")) in (let _ret_9=(u (u (u list_for _3364) _ret_8) (\_var_9-> (\_ret_10-> (u (u fm_term_app _ret_10) (u fm_term_ref (let _3366 = _var_9 in (case _3366 of {(0,f) -> u f (\_3367 _3368 _3369-> _3368); }))))))) in (u (u fm_term_app _ret_9) (u fm_term_ref (((_name_2::String) ++ ".Self"))))))); }))); (1,f) -> u f (\_3370 _3371-> (let _3372 = _3370 in (case _3372 of {(0,f) -> u f (\_3373 _3374 _3375-> (u (u (u (u (u fm_term_all bool_false) "") _3373) (u (u fm_datatype_build_term_constructor _type_1) _3370)) (\_s_9-> (\_x_10-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _name_2) _3371))))); }))); })))))
fm_datatype_build_term_constructors = (\_type_1-> (let _3376 = _type_1 in (case _3376 of {(0,f) -> u f (\_3377 _3378 _3379 _3380-> (u (u (u fm_datatype_build_term_constructors_go _type_1) _3377) _3380)); })))
fm_datatype_build_term_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3381 = _pars_3 in (case _3381 of {(0,f) -> u f ((let _3382 = _inds_4 in (case _3382 of {(0,f) -> u f ((u (u (u (u (u fm_term_all bool_true) (((_name_2::String) ++ ".Self"))) (u fm_name_read "P")) (u fm_datatype_build_term_motive _type_1)) (\_s_5-> (\_x_6-> (u fm_datatype_build_term_constructors _type_1))))); (1,f) -> u f (\_3383 _3384-> (let _3385 = _3383 in (case _3385 of {(0,f) -> u f (\_3386 _3387 _3388-> (u (u fm_term_lam _3387) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _pars_3) _3384)))); }))); }))); (1,f) -> u f (\_3389 _3390-> (let _3391 = _3389 in (case _3391 of {(0,f) -> u f (\_3392 _3393 _3394-> (u (u fm_term_lam _3393) (\_x_10-> (u (u (u (u fm_datatype_build_term_go _type_1) _name_2) _3390) _inds_4)))); }))); }))))))
fm_datatype_build_term = (\_type_1-> (let _3395 = _type_1 in (case _3395 of {(0,f) -> u f (\_3396 _3397 _3398 _3399-> (u (u (u (u fm_datatype_build_term_go _type_1) _3396) _3397) _3398)); })))
fm_datatype_build_type_go = (\_type_1-> (\_name_2-> (\_pars_3-> (\_inds_4-> (let _3400 = _pars_3 in (case _3400 of {(0,f) -> u f ((let _3401 = _inds_4 in (case _3401 of {(0,f) -> u f (fm_term_typ); (1,f) -> u f (\_3402 _3403-> (let _3404 = _3402 in (case _3404 of {(0,f) -> u f (\_3405 _3406 _3407-> (u (u (u (u (u fm_term_all bool_false) "") _3406) _3407) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _pars_3) _3403))))); }))); }))); (1,f) -> u f (\_3408 _3409-> (let _3410 = _3408 in (case _3410 of {(0,f) -> u f (\_3411 _3412 _3413-> (u (u (u (u (u fm_term_all bool_false) "") _3412) _3413) (\_s_10-> (\_x_11-> (u (u (u (u fm_datatype_build_type_go _type_1) _name_2) _3409) _inds_4))))); }))); }))))))
fm_datatype_build_type = (\_type_1-> (let _3414 = _type_1 in (case _3414 of {(0,f) -> u f (\_3415 _3416 _3417 _3418-> (u (u (u (u fm_datatype_build_type_go _type_1) _3415) _3416) _3417)); })))
fm_constructor_build_term_opt_go = (\_type_1-> (\_ctor_2-> (\_ctrs_3-> (let _3419 = _ctrs_3 in (case _3419 of {(0,f) -> u f ((let _3420 = _ctor_2 in (case _3420 of {(0,f) -> u f (\_3421 _3422 _3423-> (let _ret_7=(u fm_term_ref _3421) in (let _ret_8=(u (u (u list_for _3422) _ret_7) (\_arg_8-> (\_ret_9-> (u (u fm_term_app _ret_9) (u fm_term_ref (let _3424 = _arg_8 in (case _3424 of {(0,f) -> u f (\_3425 _3426 _3427-> _3426); }))))))) in _ret_8))); }))); (1,f) -> u f (\_3428 _3429-> (let _3430 = _3428 in (case _3430 of {(0,f) -> u f (\_3431 _3432 _3433-> (u (u fm_term_lam _3431) (\_x_9-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3429)))); }))); })))))
fm_constructor_build_term_opt = (\_type_1-> (\_ctor_2-> (let _3434 = _type_1 in (case _3434 of {(0,f) -> u f (\_3435 _3436 _3437 _3438-> (u (u (u fm_constructor_build_term_opt_go _type_1) _ctor_2) _3438)); }))))
fm_constructor_build_term_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3439 = _pars_4 in (case _3439 of {(0,f) -> u f ((let _3440 = _args_5 in (case _3440 of {(0,f) -> u f ((u (u fm_term_lam (u fm_name_read "P")) (\_x_6-> (u (u fm_constructor_build_term_opt _type_1) _ctor_2)))); (1,f) -> u f (\_3441 _3442-> (let _3443 = _3441 in (case _3443 of {(0,f) -> u f (\_3444 _3445 _3446-> (u (u fm_term_lam _3445) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _pars_4) _3442)))); }))); }))); (1,f) -> u f (\_3447 _3448-> (let _3449 = _3447 in (case _3449 of {(0,f) -> u f (\_3450 _3451 _3452-> (u (u fm_term_lam _3451) (\_x_11-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _name_3) _3448) _args_5)))); }))); })))))))
fm_constructor_build_term = (\_type_1-> (\_ctor_2-> (let _3453 = _type_1 in (case _3453 of {(0,f) -> u f (\_3454 _3455 _3456 _3457-> (let _3458 = _ctor_2 in (case _3458 of {(0,f) -> u f (\_3459 _3460 _3461-> (u (u (u (u (u fm_constructor_build_term_go _type_1) _ctor_2) _3454) _3455) _3460)); }))); }))))
fm_constructor_build_type_go = (\_type_1-> (\_ctor_2-> (\_name_3-> (\_pars_4-> (\_args_5-> (let _3462 = _pars_4 in (case _3462 of {(0,f) -> u f ((let _3463 = _args_5 in (case _3463 of {(0,f) -> u f ((let _3464 = _type_1 in (case _3464 of {(0,f) -> u f (\_3465 _3466 _3467 _3468-> (let _3469 = _ctor_2 in (case _3469 of {(0,f) -> u f (\_3470 _3471 _3472-> (let _type_13=(u fm_term_ref _name_3) in (let _type_14=(u (u (u list_for _3466) _type_13) (\_var_14-> (\_type_15-> (u (u fm_term_app _type_15) (u fm_term_ref (let _3473 = _var_14 in (case _3473 of {(0,f) -> u f (\_3474 _3475 _3476-> _3475); }))))))) in (let _type_15=(u (u (u list_for _3472) _type_14) (\_var_15-> (\_type_16-> (u (u fm_term_app _type_16) (let _3477 = _var_15 in (case _3477 of {(0,f) -> u f (\_3478 _3479 _3480-> _3480); })))))) in _type_15)))); }))); }))); (1,f) -> u f (\_3481 _3482-> (let _3483 = _3481 in (case _3483 of {(0,f) -> u f (\_3484 _3485 _3486-> (u (u (u (u (u fm_term_all _3484) "") _3485) _3486) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _pars_4) _3482))))); }))); }))); (1,f) -> u f (\_3487 _3488-> (let _3489 = _3487 in (case _3489 of {(0,f) -> u f (\_3490 _3491 _3492-> (u (u (u (u (u fm_term_all _3490) "") _3491) _3492) (\_s_11-> (\_x_12-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _name_3) _3488) _args_5))))); }))); })))))))
fm_constructor_build_type = (\_type_1-> (\_ctor_2-> (let _3493 = _type_1 in (case _3493 of {(0,f) -> u f (\_3494 _3495 _3496 _3497-> (let _3498 = _ctor_2 in (case _3498 of {(0,f) -> u f (\_3499 _3500 _3501-> (u (u (u (u (u fm_constructor_build_type_go _type_1) _ctor_2) _3494) _3495) _3500)); }))); }))))
fm_parser_file_adt = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3502 = (u (u fm_parser_init _idx_4) _code_5) in (case _3502 of {(0,f) -> u f (\_3503 _3504 _3505-> (u (u (u parser_reply_error _3503) _3504) _3505)); (1,f) -> u f (\_3506 _3507 _3508-> (let _3509 = (u (u fm_parser_datatype _3506) _3507) in (case _3509 of {(0,f) -> u f (\_3510 _3511 _3512-> (u (u (u parser_reply_error _3510) _3511) _3512)); (1,f) -> u f (\_3513 _3514 _3515-> (let _3516 = (u (u (u fm_parser_stop _3508) _3513) _3514) in (case _3516 of {(0,f) -> u f (\_3517 _3518 _3519-> (u (u (u parser_reply_error _3517) _3518) _3519)); (1,f) -> u f (\_3520 _3521 _3522-> (let _3523 = _3515 in (case _3523 of {(0,f) -> u f (\_3524 _3525 _3526 _3527-> (let _term_19=(u fm_datatype_build_term _3515) in (let _term_20=(u (u (u fm_term_bind list_nil) (\_x_20-> (u bits_i _x_20))) _term_19) in (let _type_21=(u fm_datatype_build_type _3515) in (let _type_22=(u (u (u fm_term_bind list_nil) (\_x_22-> (u bits_o _x_22))) _type_21) in (let _arit_23=((((u list_length _3525)::Integer) + (u list_length _3526))) in (let _defs_24=(u (u (u (u (u (u (u (u (u (u fm_define _file_1) _code_2) _3522) _3524) _term_20) _type_22) bool_false) _arit_23) bool_false) _defs_3) in (let _defs_25=(u (u (u list_fold _3527) _defs_24) (\_ctr_25-> (\_defs_26-> (let _typ_name_27=_3524 in (let _ctr_arit_28=(((_arit_23::Integer) + (u list_length (let _3528 = _ctr_25 in (case _3528 of {(0,f) -> u f (\_3529 _3530 _3531-> _3530); }))))) in (let _ctr_name_29=(u string_flatten (u (u list_cons _typ_name_27) (u (u list_cons (u fm_name_read ".")) (u (u list_cons (let _3532 = _ctr_25 in (case _3532 of {(0,f) -> u f (\_3533 _3534 _3535-> _3533); }))) list_nil)))) in (let _ctr_term_30=(u (u fm_constructor_build_term _3515) _ctr_25) in (let _ctr_term_31=(u (u (u fm_term_bind list_nil) (\_x_31-> (u bits_i _x_31))) _ctr_term_30) in (let _ctr_type_32=(u (u fm_constructor_build_type _3515) _ctr_25) in (let _ctr_type_33=(u (u (u fm_term_bind list_nil) (\_x_33-> (u bits_o _x_33))) _ctr_type_32) in (u (u (u (u (u (u (u (u (u (u fm_define _file_1) _code_2) _3522) _ctr_name_29) _ctr_term_31) _ctr_type_33) bool_true) _ctr_arit_28) bool_false) _defs_26))))))))))) in (\_idx_26-> (\_code_27-> (u (u (u parser_reply_value _idx_26) _code_27) _defs_25))))))))))); })) _3520 _3521); }))); }))); })))))))
parser_eof = (\_idx_1-> (\_code_2-> (let _3536 = _code_2 in (if null (_3536::String) then (u (u (u parser_reply_value _idx_1) _code_2) unit_new) else (u (u (u parser_reply_error _idx_1) _code_2) "Expected end-of-file.")))))
fm_parser_file_end = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3537 = (u (u fm_parser_spaces _idx_4) _code_5) in (case _3537 of {(0,f) -> u f (\_3538 _3539 _3540-> (u (u (u parser_reply_error _3538) _3539) _3540)); (1,f) -> u f (\_3541 _3542 _3543-> (let _3544 = (u (u parser_eof _3541) _3542) in (case _3544 of {(0,f) -> u f (\_3545 _3546 _3547-> (u (u (u parser_reply_error _3545) _3546) _3547)); (1,f) -> u f (\_3548 _3549 _3550-> (u (u (u parser_reply_value _3548) _3549) _defs_3)); }))); })))))))
fm_parser_file = (\_file_1-> (\_code_2-> (\_defs_3-> (\_idx_4-> (\_code_5-> (let _3551 = (u (u parser_is_eof _idx_4) _code_5) in (case _3551 of {(0,f) -> u f (\_3552 _3553 _3554-> (u (u (u parser_reply_error _3552) _3553) _3554)); (1,f) -> u f (\_3555 _3556 _3557-> (let _3558 = _3557 in (if _3558 then (\_idx_9-> (\_code_10-> (u (u (u parser_reply_value _idx_9) _code_10) _defs_3))) else (\_idx_9-> (\_code_10-> (let _3559 = (u (u (u parser_first_of (u (u list_cons (u (u (u fm_parser_file_def _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_adt _file_1) _code_2) _defs_3)) (u (u list_cons (u (u (u fm_parser_file_end _file_1) _code_2) _defs_3)) list_nil)))) _idx_9) _code_10) in (case _3559 of {(0,f) -> u f (\_3560 _3561 _3562-> (u (u (u parser_reply_error _3560) _3561) _3562)); (1,f) -> u f (\_3563 _3564 _3565-> (u (u (u (u (u fm_parser_file _file_1) _code_2) _3565) _3563) _3564)); })))))) _3555 _3556); })))))))
either = (\_a_1-> (\_b_2-> ()))
string_join_go = (\_sep_1-> (\_list_2-> (\_fst_3-> (let _3566 = _list_2 in (case _3566 of {(0,f) -> u f (""); (1,f) -> u f (\_3567 _3568-> (u string_flatten (u (u list_cons (let _3569 = _fst_3 in (if _3569 then "" else _sep_1))) (u (u list_cons _3567) (u (u list_cons (u (u (u string_join_go _sep_1) _3568) bool_false)) list_nil))))); })))))
string_join = (\_sep_1-> (\_list_2-> (u (u (u string_join_go _sep_1) _list_2) bool_true)))
fm_highlight_end = (\_col_1-> (\_row_2-> (\_res_3-> (u (u string_join "\n") _res_3))))
maybe_extract = (\_m_2-> (\_a_4-> (\_f_5-> (let _3570 = _m_2 in (case _3570 of {(0,f) -> u f (_a_4); (1,f) -> u f (\_3571-> (u _f_5 _3571)); })))))
nat_is_zero = (\_n_1-> (let _3572 = _n_1 in (if _3572==0 then bool_true else bool_false)))
nat_double = (\_n_1-> (let _3573 = _n_1 in (if _3573==0 then nat_zero else (u nat_succ (u nat_succ (u nat_double (_3573-1)))))))
nat_pred = (\_n_1-> (let _3574 = _n_1 in (if _3574==0 then nat_zero else (_3574-1))))
string_pad_right = (\_size_1-> (\_chr_2-> (\_str_3-> (let _3575 = _size_1 in (if _3575==0 then _str_3 else (let _3576 = _str_3 in (if null (_3576::String) then (u (u string_cons _chr_2) (u (u (u string_pad_right (_3575-1)) _chr_2) "")) else (u (u string_cons (fromIntegral (fromEnum (head _3576 :: Char)) :: Word16)) (u (u (u string_pad_right (_3575-1)) _chr_2) (tail _3576))))))))))
string_pad_left = (\_size_1-> (\_chr_2-> (\_str_3-> (u string_reverse (u (u (u string_pad_right _size_1) _chr_2) (u string_reverse _str_3))))))
either_left = (\_value_3-> (0,\t-> t _value_3))
either_right = (\_value_3-> (1,\t-> t _value_3))
nat_sub_rem = (\_n_1-> (\_m_2-> (let _3577 = _m_2 in (if _3577==0 then (u either_left _n_1) else (let _3578 = _n_1 in (if _3578==0 then (u either_right (u nat_succ (_3577-1))) else (u (u nat_sub_rem (_3578-1)) (_3577-1))))))))
nat_div_mod_go = (\_n_1-> (\_m_2-> (\_d_3-> (let _3579 = (u (u nat_sub_rem _n_1) _m_2) in (case _3579 of {(0,f) -> u f (\_3580-> (u (u (u nat_div_mod_go _3580) _m_2) (u nat_succ _d_3))); (1,f) -> u f (\_3581-> (u (u pair_new _d_3) _n_1)); })))))
nat_div_mod = (\_n_1-> (\_m_2-> (u (u (u nat_div_mod_go _n_1) _m_2) nat_zero)))
nat_to_base_go = (\_base_1-> (\_nat_2-> (\_res_3-> (let _3582 = (u (u nat_div_mod _nat_2) _base_1) in (case _3582 of {(0,f) -> u f (\_3583 _3584-> (let _3585 = _3583 in (if _3585==0 then (u (u list_cons _3584) _res_3) else (u (u (u nat_to_base_go _base_1) _3583) (u (u list_cons _3584) _res_3))))); })))))
nat_to_base = (\_base_1-> (\_nat_2-> (u (u (u nat_to_base_go _base_1) _nat_2) list_nil)))
nat_mod_go = (\_n_1-> (\_m_2-> (\_r_3-> (let _3586 = _m_2 in (if _3586==0 then (u (u (u nat_mod_go _n_1) _r_3) _m_2) else (let _3587 = _n_1 in (if _3587==0 then _r_3 else (u (u (u nat_mod_go (_3587-1)) (_3586-1)) (u nat_succ _r_3)))))))))
nat_mod = (\_n_1-> (\_m_2-> (u (u (u nat_mod_go _n_1) _m_2) 0)))
nat_lte = (\a0-> \a1-> ((a0::Integer) <= a1))
nat_show_digit = (\_base_1-> (\_n_2-> (let _m_3=(u (u nat_mod _n_2) _base_1) in (let _base64_4=(u (u list_cons 48) (u (u list_cons 49) (u (u list_cons 50) (u (u list_cons 51) (u (u list_cons 52) (u (u list_cons 53) (u (u list_cons 54) (u (u list_cons 55) (u (u list_cons 56) (u (u list_cons 57) (u (u list_cons 65) (u (u list_cons 66) (u (u list_cons 67) (u (u list_cons 68) (u (u list_cons 69) (u (u list_cons 70) (u (u list_cons 71) (u (u list_cons 72) (u (u list_cons 73) (u (u list_cons 74) (u (u list_cons 75) (u (u list_cons 76) (u (u list_cons 77) (u (u list_cons 78) (u (u list_cons 79) (u (u list_cons 80) (u (u list_cons 81) (u (u list_cons 82) (u (u list_cons 83) (u (u list_cons 84) (u (u list_cons 85) (u (u list_cons 86) (u (u list_cons 87) (u (u list_cons 88) (u (u list_cons 89) (u (u list_cons 90) (u (u list_cons 97) (u (u list_cons 98) (u (u list_cons 99) (u (u list_cons 100) (u (u list_cons 101) (u (u list_cons 102) (u (u list_cons 103) (u (u list_cons 104) (u (u list_cons 105) (u (u list_cons 106) (u (u list_cons 107) (u (u list_cons 108) (u (u list_cons 109) (u (u list_cons 110) (u (u list_cons 111) (u (u list_cons 112) (u (u list_cons 113) (u (u list_cons 114) (u (u list_cons 115) (u (u list_cons 116) (u (u list_cons 117) (u (u list_cons 118) (u (u list_cons 119) (u (u list_cons 120) (u (u list_cons 121) (u (u list_cons 122) (u (u list_cons 43) (u (u list_cons 47) list_nil)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))) in (let _3588 = (((((_base_1::Integer) > 0)) && (((_base_1::Integer) <= 64)))) in (if _3588 then (let _3589 = (u (u list_at _m_3) _base64_4) in (case _3589 of {(0,f) -> u f (35); (1,f) -> u f (\_3590-> _3590); })) else 35))))))
nat_to_string_base = (\_base_1-> (\_nat_2-> (u (u (u list_fold (u (u nat_to_base _base_1) _nat_2)) string_nil) (\_n_3-> (\_str_4-> (u (u string_cons (u (u nat_show_digit _base_1) _n_3)) _str_4))))))
nat_show = (\_n_1-> (u (u nat_to_string_base 10) _n_1))
bool_not = (\a0-> (not a0))
fm_color = (\_col_1-> (\_str_2-> (u (u string_cons 27) (u (u string_cons 91) (((_col_1::String) ++ (u (u string_cons 109) (((_str_2::String) ++ (u (u string_cons 27) (u (u string_cons 91) (u (u string_cons 48) (u (u string_cons 109) string_nil)))))))))))))
nat_eql = (\a0-> \a1-> ((a0::Integer) == a1))
list_take = (\_n_2-> (\_xs_3-> (let _3591 = _xs_3 in (case _3591 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3592 _3593-> (let _3594 = _n_2 in (if _3594==0 then list_nil else (u (u list_cons _3592) (u (u list_take (_3594-1)) _3593))))); }))))
fm_highlight_tc = (\_code_1-> (\_ix0_2-> (\_ix1_3-> (\_col_4-> (\_row_5-> (\_lft_6-> (\_lin_7-> (\_res_8-> (let _spa_9=3 in (let _3595 = _code_1 in (if null (_3595::String) then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _3596 = ((((fromIntegral (fromEnum (head _3595 :: Char)) :: Word16)::Word16) == 10)) in (if _3596 then (let _stp_12=(u (u (u maybe_extract _lft_6) bool_false) nat_is_zero) in (let _3597 = _stp_12 in (if _3597 then (u (u (u fm_highlight_end _col_4) _row_5) (u list_reverse _res_8)) else (let _siz_13=(u nat_succ (u nat_double _spa_9)) in (let _lft_14=(let _3598 = _ix1_3 in (if _3598==0 then (let _3599 = _lft_6 in (case _3599 of {(0,f) -> u f ((u maybe_some _spa_9)); (1,f) -> u f (\_3600-> (u maybe_some (u nat_pred _3600))); })) else _lft_6)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=0 in (let _row_18=(u nat_succ _row_5) in (let _res_19=(u (u list_cons (u string_reverse _lin_7)) _res_8) in (let _lin_20=(u string_reverse (u string_flatten (u (u list_cons (u (u (u string_pad_left 4) 32) (u nat_show _row_18))) (u (u list_cons " | ") list_nil)))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3595)) _ix0_15) _ix1_16) _col_17) _row_18) _lft_14) _lin_20) _res_19)))))))))))) else (let _chr_12=(u (u string_cons (fromIntegral (fromEnum (head _3595 :: Char)) :: Word16)) string_nil) in (let _chr_13=(let _3601 = (((u nat_is_zero _ix0_2) && ((not (u nat_is_zero _ix1_3))))) in (if _3601 then (u string_reverse (u (u fm_color "31") (u (u fm_color "4") _chr_12))) else _chr_12)) in (let _res_14=(let _3602 = (((_ix0_2::Integer) == 1)) in (if _3602 then (u (u list_take _spa_9) _res_8) else _res_8)) in (let _ix0_15=(u nat_pred _ix0_2) in (let _ix1_16=(u nat_pred _ix1_3) in (let _col_17=(u nat_succ _col_4) in (let _lin_18=(u string_flatten (u (u list_cons _chr_13) (u (u list_cons _lin_7) list_nil))) in (u (u (u (u (u (u (u (u fm_highlight_tc (tail _3595)) _ix0_15) _ix1_16) _col_17) _row_5) _lft_6) _lin_18) _res_14)))))))))))))))))))))
fm_highlight = (\_code_1-> (\_idx0_2-> (\_idx1_3-> (u (u (u (u (u (u (u (u fm_highlight_tc _code_1) _idx0_2) _idx1_3) 0) 1) maybe_none) (u string_reverse "   1 | ")) list_nil))))
fm_defs_read = (\_file_1-> (\_code_2-> (\_defs_3-> (let _3603 = (u (u (u (u (u fm_parser_file _file_1) _code_2) _defs_3) 0) _code_2) in (case _3603 of {(0,f) -> u f (\_3604 _3605 _3606-> (let _err_7=_3606 in (let _hig_8=(u (u (u fm_highlight _code_2) _3604) (u nat_succ _3604)) in (let _str_9=(u string_flatten (u (u list_cons _err_7) (u (u list_cons "\n") (u (u list_cons _hig_8) list_nil)))) in (u either_left _str_9))))); (1,f) -> u f (\_3607 _3608 _3609-> (u either_right _3609)); })))))
fm_synth_load_go = (\_name_1-> (\_files_2-> (\_defs_3-> (let _3610 = _files_2 in (case _3610 of {(0,f) -> u f ((u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_pure_5))) maybe_none)); (1,f) -> u f (\_3611 _3612-> (u (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_bind_6))) (u io_get_file _3611)) (\_code_6-> (let _read_7=(u (u (u fm_defs_read _3611) _code_6) _defs_3) in (let _3613 = _read_7 in (case _3613 of {(0,f) -> u f (\_3614-> (u (u (u fm_synth_load_go _name_1) _3612) _defs_3)); (1,f) -> u f (\_3615-> (let _defs_9=_3615 in (let _3616 = (u (u fm_get _name_1) _defs_9) in (case _3616 of {(0,f) -> u f ((u (u (u fm_synth_load_go _name_1) _3612) _defs_9)); (1,f) -> u f (\_3617-> (u (u io_monad (\_m_bind_11-> (\_m_pure_12-> _m_pure_12))) (u maybe_some _defs_9))); })))); })))))); })))))
fm_synth_files_of_make = (\_names_1-> (\_last_2-> (let _3618 = _names_1 in (case _3618 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3619 _3620-> (let _head_5=(((_last_2::String) ++ (((_3619::String) ++ ".fm")))) in (let _tail_6=(u (u fm_synth_files_of_make _3620) (((_last_2::String) ++ (((_3619::String) ++ "/"))))) in (u (u list_cons _head_5) _tail_6)))); }))))
char_eql = (\_a_1-> (\_b_2-> (((_a_1::Word16) == _b_2))))
string_starts_with = (\_xs_1-> (\_match_2-> (let _3621 = _match_2 in (if null (_3621::String) then bool_true else (let _3622 = _xs_1 in (if null (_3622::String) then bool_false else (let _3623 = (u (u char_eql (fromIntegral (fromEnum (head _3621 :: Char)) :: Word16)) (fromIntegral (fromEnum (head _3622 :: Char)) :: Word16)) in (if _3623 then (u (u string_starts_with (tail _3622)) (tail _3621)) else bool_false))))))))
string_drop = (\_n_1-> (\_xs_2-> (let _3624 = _n_1 in (if _3624==0 then _xs_2 else (let _3625 = _xs_2 in (if null (_3625::String) then string_nil else (u (u string_drop (_3624-1)) (tail _3625))))))))
string_length_go = (\_xs_1-> (\_n_2-> (let _3626 = _xs_1 in (if null (_3626::String) then _n_2 else (u (u string_length_go (tail _3626)) (u nat_succ _n_2))))))
string_length = (\_xs_1-> (u (u string_length_go _xs_1) 0))
string_split_go = (\_xs_1-> (\_match_2-> (\_last_3-> (let _3627 = _xs_1 in (if null (_3627::String) then (u (u list_cons _last_3) list_nil) else (let _3628 = (u (u string_starts_with _xs_1) _match_2) in (if _3628 then (let _rest_6=(u (u string_drop (u string_length _match_2)) _xs_1) in (u (u list_cons _last_3) (u (u (u string_split_go _rest_6) _match_2) ""))) else (let _next_6=(u (u string_cons (fromIntegral (fromEnum (head _3627 :: Char)) :: Word16)) string_nil) in (u (u (u string_split_go (tail _3627)) _match_2) (((_last_3::String) ++ _next_6)))))))))))
string_split = (\_xs_1-> (\_match_2-> (u (u (u string_split_go _xs_1) _match_2) "")))
fm_synth_files_of = (\_name_1-> (u list_reverse (u (u fm_synth_files_of_make (u (u string_split _name_1) ".")) "")))
fm_synth_load = (\_name_1-> (\_defs_2-> (u (u (u fm_synth_load_go _name_1) (u fm_synth_files_of _name_1)) _defs_2)))
fm_status_wait = (1,\t-> t)
fm_check = (\_v_1-> ())
fm_check_result = (\_value_2-> (\_errors_3-> (0,\t-> t _value_2 _errors_3)))
fm_error_undefined_reference = (\_origin_1-> (\_name_2-> (5,\t-> t _origin_1 _name_2)))
fm_error_waiting = (\_name_1-> (2,\t-> t _name_1))
fm_error_indirect = (\_name_1-> (3,\t-> t _name_1))
maybe_mapped = (\_m_2-> (\_f_4-> (let _3629 = _m_2 in (case _3629 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_3630-> (u maybe_some (u _f_4 _3630))); }))))
fm_mpath_o = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_o))
fm_mpath_i = (\_path_1-> (u (u maybe_mapped _path_1) fm_path_i))
fm_error_patch = (\_path_1-> (\_term_2-> (4,\t-> t _path_1 _term_2)))
fm_mpath_to_bits = (\_path_1-> (let _3631 = _path_1 in (case _3631 of {(0,f) -> u f (bits_e); (1,f) -> u f (\_3632-> (u _3632 bits_e)); })))
fm_error_type_mismatch = (\_origin_1-> (\_expected_2-> (\_detected_3-> (\_context_4-> (0,\t-> t _origin_1 _expected_2 _detected_3 _context_4)))))
fm_error_show_goal = (\_name_1-> (\_dref_2-> (\_verb_3-> (\_goal_4-> (\_context_5-> (1,\t-> t _name_1 _dref_2 _verb_3 _goal_4 _context_5))))))
fm_term_normalize = (\_term_1-> (\_defs_2-> (let _3633 = (u (u fm_term_reduce _term_1) _defs_2) in (case _3633 of {(0,f) -> u f (\_3634 _3635-> (u (u fm_term_var _3634) _3635)); (1,f) -> u f (\_3636-> (u fm_term_ref _3636)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3637 _3638 _3639 _3640 _3641-> (u (u (u (u (u fm_term_all _3637) _3638) _3639) (u (u fm_term_normalize _3640) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_normalize (u (u _3641 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_3642 _3643-> (u (u fm_term_lam _3642) (\_x_5-> (u (u fm_term_normalize (u _3643 _x_5)) _defs_2)))); (5,f) -> u f (\_3644 _3645-> (u (u fm_term_app (u (u fm_term_normalize _3644) _defs_2)) (u (u fm_term_normalize _3645) _defs_2))); (6,f) -> u f (\_3646 _3647 _3648-> (u (u (u fm_term_let _3646) (u (u fm_term_normalize _3647) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3648 _x_6)) _defs_2)))); (7,f) -> u f (\_3649 _3650 _3651-> (u (u (u fm_term_def _3649) (u (u fm_term_normalize _3650) _defs_2)) (\_x_6-> (u (u fm_term_normalize (u _3651 _x_6)) _defs_2)))); (8,f) -> u f (\_3652 _3653 _3654-> (u (u (u fm_term_ann _3652) (u (u fm_term_normalize _3653) _defs_2)) (u (u fm_term_normalize _3654) _defs_2))); (9,f) -> u f (\_3655 _3656 _3657-> (u (u (u fm_term_gol _3655) _3656) _3657)); (10,f) -> u f (\_3658-> (u fm_term_hol _3658)); (11,f) -> u f (\_3659-> (u fm_term_nat _3659)); (12,f) -> u f (\_3660-> (u fm_term_chr _3660)); (13,f) -> u f (\_3661-> (u fm_term_str _3661)); (14,f) -> u f (\_3662 _3663 _3664 _3665 _3666 _3667-> _term_1); (15,f) -> u f (\_3668 _3669-> (u (u fm_term_normalize _3669) _defs_2)); }))))
list_tail = (\_xs_2-> (let _3670 = _xs_2 in (case _3670 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3671 _3672-> _3672); })))
fm_smartmotive_vals_cont = (\_expr_1-> (\_term_2-> (\_args_3-> (\_defs_4-> (let _3673 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3673 of {(0,f) -> u f (\_3674 _3675-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (1,f) -> u f (\_3676-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (2,f) -> u f ((u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (3,f) -> u f (\_3677 _3678 _3679 _3680 _3681-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (4,f) -> u f (\_3682 _3683-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (5,f) -> u f (\_3684 _3685-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _3684) (u (u list_cons _3685) _args_3)) _defs_4)); (6,f) -> u f (\_3686 _3687 _3688-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (7,f) -> u f (\_3689 _3690 _3691-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (8,f) -> u f (\_3692 _3693 _3694-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (9,f) -> u f (\_3695 _3696 _3697-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (10,f) -> u f (\_3698-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (11,f) -> u f (\_3699-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (12,f) -> u f (\_3700-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (13,f) -> u f (\_3701-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (14,f) -> u f (\_3702 _3703 _3704 _3705 _3706 _3707-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); (15,f) -> u f (\_3708 _3709-> (u (u list_cons _expr_1) (u list_tail (u list_reverse _args_3)))); }))))))
fm_smartmotive_vals = (\_expr_1-> (\_type_2-> (\_defs_3-> (let _3710 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3710 of {(0,f) -> u f (\_3711 _3712-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (1,f) -> u f (\_3713-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (2,f) -> u f ((u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (3,f) -> u f (\_3714 _3715 _3716 _3717 _3718-> (u (u (u fm_smartmotive_vals _expr_1) (u (u _3718 fm_term_typ) fm_term_typ)) _defs_3)); (4,f) -> u f (\_3719 _3720-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (5,f) -> u f (\_3721 _3722-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (6,f) -> u f (\_3723 _3724 _3725-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (7,f) -> u f (\_3726 _3727 _3728-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (8,f) -> u f (\_3729 _3730 _3731-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (9,f) -> u f (\_3732 _3733 _3734-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (10,f) -> u f (\_3735-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (11,f) -> u f (\_3736-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (12,f) -> u f (\_3737-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (13,f) -> u f (\_3738-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (14,f) -> u f (\_3739 _3740 _3741 _3742 _3743 _3744-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); (15,f) -> u f (\_3745 _3746-> (u (u (u (u fm_smartmotive_vals_cont _expr_1) _type_2) list_nil) _defs_3)); })))))
fm_smartmotive_nams_cont = (\_name_1-> (\_term_2-> (\_binds_3-> (\_defs_4-> (let _3747 = (u (u fm_term_reduce _term_2) _defs_4) in (case _3747 of {(0,f) -> u f (\_3748 _3749-> (u (u list_cons _name_1) (u list_tail _binds_3))); (1,f) -> u f (\_3750-> (u (u list_cons _name_1) (u list_tail _binds_3))); (2,f) -> u f ((u (u list_cons _name_1) (u list_tail _binds_3))); (3,f) -> u f (\_3751 _3752 _3753 _3754 _3755-> (u (u (u (u fm_smartmotive_nams_cont _name_1) (u (u _3755 (u fm_term_ref _3752)) (u fm_term_ref _3753))) (u (u list_cons (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3753) list_nil))))) _binds_3)) _defs_4)); (4,f) -> u f (\_3756 _3757-> (u (u list_cons _name_1) (u list_tail _binds_3))); (5,f) -> u f (\_3758 _3759-> (u (u list_cons _name_1) (u list_tail _binds_3))); (6,f) -> u f (\_3760 _3761 _3762-> (u (u list_cons _name_1) (u list_tail _binds_3))); (7,f) -> u f (\_3763 _3764 _3765-> (u (u list_cons _name_1) (u list_tail _binds_3))); (8,f) -> u f (\_3766 _3767 _3768-> (u (u list_cons _name_1) (u list_tail _binds_3))); (9,f) -> u f (\_3769 _3770 _3771-> (u (u list_cons _name_1) (u list_tail _binds_3))); (10,f) -> u f (\_3772-> (u (u list_cons _name_1) (u list_tail _binds_3))); (11,f) -> u f (\_3773-> (u (u list_cons _name_1) (u list_tail _binds_3))); (12,f) -> u f (\_3774-> (u (u list_cons _name_1) (u list_tail _binds_3))); (13,f) -> u f (\_3775-> (u (u list_cons _name_1) (u list_tail _binds_3))); (14,f) -> u f (\_3776 _3777 _3778 _3779 _3780 _3781-> (u (u list_cons _name_1) (u list_tail _binds_3))); (15,f) -> u f (\_3782 _3783-> (u (u list_cons _name_1) (u list_tail _binds_3))); }))))))
fm_smartmotive_nams = (\_name_1-> (\_type_2-> (\_defs_3-> (let _3784 = (u (u fm_term_reduce _type_2) _defs_3) in (case _3784 of {(0,f) -> u f (\_3785 _3786-> list_nil); (1,f) -> u f (\_3787-> list_nil); (2,f) -> u f (list_nil); (3,f) -> u f (\_3788 _3789 _3790 _3791 _3792-> (u (u (u (u fm_smartmotive_nams_cont _name_1) _3791) list_nil) _defs_3)); (4,f) -> u f (\_3793 _3794-> list_nil); (5,f) -> u f (\_3795 _3796-> list_nil); (6,f) -> u f (\_3797 _3798 _3799-> list_nil); (7,f) -> u f (\_3800 _3801 _3802-> list_nil); (8,f) -> u f (\_3803 _3804 _3805-> list_nil); (9,f) -> u f (\_3806 _3807 _3808-> list_nil); (10,f) -> u f (\_3809-> list_nil); (11,f) -> u f (\_3810-> list_nil); (12,f) -> u f (\_3811-> list_nil); (13,f) -> u f (\_3812-> list_nil); (14,f) -> u f (\_3813 _3814 _3815 _3816 _3817 _3818-> list_nil); (15,f) -> u f (\_3819 _3820-> list_nil); })))))
list_zip = (\_as_3-> (\_bs_4-> (let _3821 = _as_3 in (case _3821 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3822 _3823-> (let _3824 = _bs_4 in (case _3824 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_3825 _3826-> (u (u list_cons (u (u pair_new _3822) _3825)) (u (u list_zip _3823) _3826))); }))); }))))
nat_gte = (\a0-> \a1-> ((a0::Integer) >= a1))
nat_sub = (\a0-> \a1-> ((a0::Integer) - a1))
fm_term_serialize_name = (\_name_1-> (u fm_name_to_bits _name_1))
fm_term_serialize = (\_term_1-> (\_depth_2-> (\_init_3-> (\_diff_4-> (\_x_5-> (let _3827 = _term_1 in (case _3827 of {(0,f) -> u f (\_3828 _3829-> (let _3830 = (((_3829::Integer) >= _init_3)) in (if _3830 then (let _name_8=(u bits_concat (u nat_to_bits (u nat_pred (((_depth_2::Integer) - _3829))))) in (u bits_o (u bits_o (u bits_i (u _name_8 _x_5))))) else (let _name_8=(u bits_concat (u nat_to_bits _3829)) in (u bits_o (u bits_i (u bits_o (u _name_8 _x_5)))))))); (1,f) -> u f (\_3831-> (let _name_7=(u bits_concat (u fm_term_serialize_name _3831)) in (u bits_o (u bits_o (u bits_o (u _name_7 _x_5)))))); (2,f) -> u f ((u bits_o (u bits_i (u bits_i _x_5)))); (3,f) -> u f (\_3832 _3833 _3834 _3835 _3836-> (let _eras_11=(let _3837 = _3832 in (if _3837 then bits_i else bits_o)) in (let _self_12=(u bits_concat (u fm_name_to_bits _3833)) in (let _xtyp_13=(u (u (u (u fm_term_serialize _3835) _depth_2) _init_3) _diff_4) in (let _body_14=(u (u (u (u fm_term_serialize (u (u _3836 (u (u fm_term_var _3833) _depth_2)) (u (u fm_term_var _3834) (u nat_succ _depth_2)))) (u nat_succ (u nat_succ _depth_2))) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_o (u _eras_11 (u _self_12 (u _xtyp_13 (u _body_14 _x_5)))))))))))); (4,f) -> u f (\_3838 _3839-> (let _body_8=(u (u (u (u fm_term_serialize (u _3839 (u (u fm_term_var _3838) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_o (u bits_i (u _body_8 _x_5)))))); (5,f) -> u f (\_3840 _3841-> (let _func_8=(u (u (u (u fm_term_serialize _3840) _depth_2) _init_3) _diff_4) in (let _argm_9=(u (u (u (u fm_term_serialize _3841) _depth_2) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_o (u _func_8 (u _argm_9 _x_5)))))))); (6,f) -> u f (\_3842 _3843 _3844-> (let _expr_9=(u (u (u (u fm_term_serialize _3843) _depth_2) _init_3) _diff_4) in (let _body_10=(u (u (u (u fm_term_serialize (u _3844 (u (u fm_term_var _3842) _depth_2))) (u nat_succ _depth_2)) _init_3) _diff_4) in (u bits_i (u bits_i (u bits_i (u _expr_9 (u _body_10 _x_5)))))))); (7,f) -> u f (\_3845 _3846 _3847-> (u (u (u (u (u fm_term_serialize (u _3847 _3846)) _depth_2) _init_3) _diff_4) _x_5)); (8,f) -> u f (\_3848 _3849 _3850-> (u (u (u (u (u fm_term_serialize _3849) _depth_2) _init_3) _diff_4) _x_5)); (9,f) -> u f (\_3851 _3852 _3853-> (let _name_9=(u bits_concat (u fm_name_to_bits _3851)) in (u bits_o (u bits_o (u bits_o (u _name_9 _x_5)))))); (10,f) -> u f (\_3854-> _x_5); (11,f) -> u f (\_3855-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_nat _3855)) _depth_2) _init_3) _diff_4) _x_5)); (12,f) -> u f (\_3856-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_chr _3856)) _depth_2) _init_3) _diff_4) _x_5)); (13,f) -> u f (\_3857-> (u (u (u (u (u fm_term_serialize (u fm_term_unroll_str _3857)) _depth_2) _init_3) _diff_4) _x_5)); (14,f) -> u f (\_3858 _3859 _3860 _3861 _3862 _3863-> (u _diff_4 _x_5)); (15,f) -> u f (\_3864 _3865-> (u (u (u (u (u fm_term_serialize _3865) _depth_2) _init_3) _diff_4) _x_5)); })))))))
bits_eql = (\_a_1-> (\_b_2-> (let _3866 = _a_1 in (case _3866 of {(0,f) -> u f ((let _3867 = _b_2 in (case _3867 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_3868-> bool_false); (2,f) -> u f (\_3869-> bool_false); }))); (1,f) -> u f (\_3870-> (let _3871 = _b_2 in (case _3871 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3872-> (u (u bits_eql _3870) _3872)); (2,f) -> u f (\_3873-> bool_false); }))); (2,f) -> u f (\_3874-> (let _3875 = _b_2 in (case _3875 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_3876-> bool_false); (2,f) -> u f (\_3877-> (u (u bits_eql _3874) _3877)); }))); }))))
fm_term_identical = (\_a_1-> (\_b_2-> (\_lv_3-> (let _ah_4=(u (u (u (u (u fm_term_serialize _a_1) _lv_3) _lv_3) bits_o) bits_e) in (let _bh_5=(u (u (u (u (u fm_term_serialize _b_2) _lv_3) _lv_3) bits_i) bits_e) in (u (u bits_eql _ah_4) _bh_5))))))
fm_smartmotive_replace = (\_term_1-> (\_from_2-> (\_to_3-> (\_lv_4-> (let _3878 = (u (u (u fm_term_identical _term_1) _from_2) _lv_4) in (if _3878 then _to_3 else (let _3879 = _term_1 in (case _3879 of {(0,f) -> u f (\_3880 _3881-> (u (u fm_term_var _3880) _3881)); (1,f) -> u f (\_3882-> (u fm_term_ref _3882)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_3883 _3884 _3885 _3886 _3887-> (let _xtyp_10=(u (u (u (u fm_smartmotive_replace _3886) _from_2) _to_3) _lv_4) in (let _body_11=(u (u _3887 (u fm_term_ref _3884)) (u fm_term_ref _3885)) in (let _body_12=(u (u (u (u fm_smartmotive_replace _body_11) _from_2) _to_3) (u nat_succ (u nat_succ _lv_4))) in (u (u (u (u (u fm_term_all _3883) _3884) _3885) _xtyp_10) (\_s_13-> (\_x_14-> _body_12))))))); (4,f) -> u f (\_3888 _3889-> (let _body_7=(u _3889 (u fm_term_ref _3888)) in (let _body_8=(u (u (u (u fm_smartmotive_replace _body_7) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u fm_term_lam _3888) (\_x_9-> _body_8))))); (5,f) -> u f (\_3890 _3891-> (let _func_7=(u (u (u (u fm_smartmotive_replace _3890) _from_2) _to_3) _lv_4) in (let _argm_8=(u (u (u (u fm_smartmotive_replace _3891) _from_2) _to_3) _lv_4) in (u (u fm_term_app _func_7) _argm_8)))); (6,f) -> u f (\_3892 _3893 _3894-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3893) _from_2) _to_3) _lv_4) in (let _body_9=(u _3894 (u fm_term_ref _3892)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_let _3892) _expr_8) (\_x_11-> _body_10)))))); (7,f) -> u f (\_3895 _3896 _3897-> (let _expr_8=(u (u (u (u fm_smartmotive_replace _3896) _from_2) _to_3) _lv_4) in (let _body_9=(u _3897 (u fm_term_ref _3895)) in (let _body_10=(u (u (u (u fm_smartmotive_replace _body_9) _from_2) _to_3) (u nat_succ _lv_4)) in (u (u (u fm_term_def _3895) _expr_8) (\_x_11-> _body_10)))))); (8,f) -> u f (\_3898 _3899 _3900-> (let _term_8=(u (u (u (u fm_smartmotive_replace _3899) _from_2) _to_3) _lv_4) in (let _type_9=(u (u (u (u fm_smartmotive_replace _3900) _from_2) _to_3) _lv_4) in (u (u (u fm_term_ann _3898) _term_8) _type_9)))); (9,f) -> u f (\_3901 _3902 _3903-> _term_1); (10,f) -> u f (\_3904-> _term_1); (11,f) -> u f (\_3905-> _term_1); (12,f) -> u f (\_3906-> _term_1); (13,f) -> u f (\_3907-> _term_1); (14,f) -> u f (\_3908 _3909 _3910 _3911 _3912 _3913-> _term_1); (15,f) -> u f (\_3914 _3915-> (u (u (u (u fm_smartmotive_replace _3915) _from_2) _to_3) _lv_4)); }))))))))
fm_smartmotive_make = (\_name_1-> (\_expr_2-> (\_type_3-> (\_moti_4-> (\_lv_5-> (\_defs_6-> (let _vals_7=(u (u (u fm_smartmotive_vals _expr_2) _type_3) _defs_6) in (let _nams_8=(u (u (u fm_smartmotive_nams _name_1) _type_3) _defs_6) in (let _subs_9=(u (u list_zip _nams_8) _vals_7) in (let _moti_10=(u (u (u list_fold _subs_9) _moti_4) (\_sub_10-> (\_moti_11-> (let _3916 = _sub_10 in (case _3916 of {(0,f) -> u f (\_3917 _3918-> (u (u (u (u fm_smartmotive_replace _moti_11) _3918) (u fm_term_ref _3917)) _lv_5)); }))))) in _moti_10))))))))))
fm_term_desugar_cse_motive = (\_wyth_1-> (\_moti_2-> (let _3919 = _wyth_1 in (case _3919 of {(0,f) -> u f (_moti_2); (1,f) -> u f (\_3920 _3921-> (let _3922 = _3920 in (case _3922 of {(0,f) -> u f (\_3923 _3924 _3925 _3926 _3927 _3928 _3929 _3930 _3931-> (u (u (u (u (u fm_term_all bool_false) "") _3926) _3928) (\_s_14-> (\_x_15-> (u (u fm_term_desugar_cse_motive _3921) _moti_2))))); }))); }))))
string_is_empty = (\_str_1-> (let _3932 = _str_1 in (if null (_3932::String) then bool_true else bool_false)))
fm_term_desugar_cse_argument = (\_name_1-> (\_wyth_2-> (\_type_3-> (\_body_4-> (\_defs_5-> (let _3933 = (u (u fm_term_reduce _type_3) _defs_5) in (case _3933 of {(0,f) -> u f (\_3934 _3935-> (let _3936 = _wyth_2 in (case _3936 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3937 _3938-> (let _3939 = _3937 in (case _3939 of {(0,f) -> u f (\_3940 _3941 _3942 _3943 _3944 _3945 _3946 _3947 _3948-> (u (u fm_term_lam _3943) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3938) _type_3) _body_4) _defs_5)))); }))); }))); (1,f) -> u f (\_3949-> (let _3950 = _wyth_2 in (case _3950 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3951 _3952-> (let _3953 = _3951 in (case _3953 of {(0,f) -> u f (\_3954 _3955 _3956 _3957 _3958 _3959 _3960 _3961 _3962-> (u (u fm_term_lam _3957) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3952) _type_3) _body_4) _defs_5)))); }))); }))); (2,f) -> u f ((let _3963 = _wyth_2 in (case _3963 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3964 _3965-> (let _3966 = _3964 in (case _3966 of {(0,f) -> u f (\_3967 _3968 _3969 _3970 _3971 _3972 _3973 _3974 _3975-> (u (u fm_term_lam _3970) (\_x_17-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3965) _type_3) _body_4) _defs_5)))); }))); }))); (3,f) -> u f (\_3976 _3977 _3978 _3979 _3980-> (u (u fm_term_lam (let _3981 = (u string_is_empty _3978) in (if _3981 then _name_1 else (u string_flatten (u (u list_cons _name_1) (u (u list_cons ".") (u (u list_cons _3978) list_nil))))))) (\_x_11-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _wyth_2) (u (u _3980 (u (u fm_term_var _3977) 0)) (u (u fm_term_var _3978) 0))) _body_4) _defs_5)))); (4,f) -> u f (\_3982 _3983-> (let _3984 = _wyth_2 in (case _3984 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_3985 _3986-> (let _3987 = _3985 in (case _3987 of {(0,f) -> u f (\_3988 _3989 _3990 _3991 _3992 _3993 _3994 _3995 _3996-> (u (u fm_term_lam _3991) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _3986) _type_3) _body_4) _defs_5)))); }))); }))); (5,f) -> u f (\_3997 _3998-> (let _3999 = _wyth_2 in (case _3999 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4000 _4001-> (let _4002 = _4000 in (case _4002 of {(0,f) -> u f (\_4003 _4004 _4005 _4006 _4007 _4008 _4009 _4010 _4011-> (u (u fm_term_lam _4006) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4001) _type_3) _body_4) _defs_5)))); }))); }))); (6,f) -> u f (\_4012 _4013 _4014-> (let _4015 = _wyth_2 in (case _4015 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4016 _4017-> (let _4018 = _4016 in (case _4018 of {(0,f) -> u f (\_4019 _4020 _4021 _4022 _4023 _4024 _4025 _4026 _4027-> (u (u fm_term_lam _4022) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4017) _type_3) _body_4) _defs_5)))); }))); }))); (7,f) -> u f (\_4028 _4029 _4030-> (let _4031 = _wyth_2 in (case _4031 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4032 _4033-> (let _4034 = _4032 in (case _4034 of {(0,f) -> u f (\_4035 _4036 _4037 _4038 _4039 _4040 _4041 _4042 _4043-> (u (u fm_term_lam _4038) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4033) _type_3) _body_4) _defs_5)))); }))); }))); (8,f) -> u f (\_4044 _4045 _4046-> (let _4047 = _wyth_2 in (case _4047 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4048 _4049-> (let _4050 = _4048 in (case _4050 of {(0,f) -> u f (\_4051 _4052 _4053 _4054 _4055 _4056 _4057 _4058 _4059-> (u (u fm_term_lam _4054) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4049) _type_3) _body_4) _defs_5)))); }))); }))); (9,f) -> u f (\_4060 _4061 _4062-> (let _4063 = _wyth_2 in (case _4063 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4064 _4065-> (let _4066 = _4064 in (case _4066 of {(0,f) -> u f (\_4067 _4068 _4069 _4070 _4071 _4072 _4073 _4074 _4075-> (u (u fm_term_lam _4070) (\_x_20-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4065) _type_3) _body_4) _defs_5)))); }))); }))); (10,f) -> u f (\_4076-> (let _4077 = _wyth_2 in (case _4077 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4078 _4079-> (let _4080 = _4078 in (case _4080 of {(0,f) -> u f (\_4081 _4082 _4083 _4084 _4085 _4086 _4087 _4088 _4089-> (u (u fm_term_lam _4084) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4079) _type_3) _body_4) _defs_5)))); }))); }))); (11,f) -> u f (\_4090-> (let _4091 = _wyth_2 in (case _4091 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4092 _4093-> (let _4094 = _4092 in (case _4094 of {(0,f) -> u f (\_4095 _4096 _4097 _4098 _4099 _4100 _4101 _4102 _4103-> (u (u fm_term_lam _4098) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4093) _type_3) _body_4) _defs_5)))); }))); }))); (12,f) -> u f (\_4104-> (let _4105 = _wyth_2 in (case _4105 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4106 _4107-> (let _4108 = _4106 in (case _4108 of {(0,f) -> u f (\_4109 _4110 _4111 _4112 _4113 _4114 _4115 _4116 _4117-> (u (u fm_term_lam _4112) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4107) _type_3) _body_4) _defs_5)))); }))); }))); (13,f) -> u f (\_4118-> (let _4119 = _wyth_2 in (case _4119 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4120 _4121-> (let _4122 = _4120 in (case _4122 of {(0,f) -> u f (\_4123 _4124 _4125 _4126 _4127 _4128 _4129 _4130 _4131-> (u (u fm_term_lam _4126) (\_x_18-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4121) _type_3) _body_4) _defs_5)))); }))); }))); (14,f) -> u f (\_4132 _4133 _4134 _4135 _4136 _4137-> (let _4138 = _wyth_2 in (case _4138 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4139 _4140-> (let _4141 = _4139 in (case _4141 of {(0,f) -> u f (\_4142 _4143 _4144 _4145 _4146 _4147 _4148 _4149 _4150-> (u (u fm_term_lam _4145) (\_x_23-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4140) _type_3) _body_4) _defs_5)))); }))); }))); (15,f) -> u f (\_4151 _4152-> (let _4153 = _wyth_2 in (case _4153 of {(0,f) -> u f (_body_4); (1,f) -> u f (\_4154 _4155-> (let _4156 = _4154 in (case _4156 of {(0,f) -> u f (\_4157 _4158 _4159 _4160 _4161 _4162 _4163 _4164 _4165-> (u (u fm_term_lam _4160) (\_x_19-> (u (u (u (u (u fm_term_desugar_cse_argument _name_1) _4155) _type_3) _body_4) _defs_5)))); }))); }))); })))))))
maybe_or = (\_a_2-> (\_b_3-> (let _4166 = _a_2 in (case _4166 of {(0,f) -> u f (_b_3); (1,f) -> u f (\_4167-> (u maybe_some _4167)); }))))
fm_term_desugar_cse_cases = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_type_5-> (\_defs_6-> (\_ctxt_7-> (let _4168 = (u (u fm_term_reduce _type_5) _defs_6) in (case _4168 of {(0,f) -> u f (\_4169 _4170-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4171 = _defn_10 in (case _4171 of {(0,f) -> u f (\_4172 _4173 _4174 _4175 _4176 _4177 _4178 _4179 _4180-> _4176); })))))) in _expr_10)); (1,f) -> u f (\_4181-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4182 = _defn_9 in (case _4182 of {(0,f) -> u f (\_4183 _4184 _4185 _4186 _4187 _4188 _4189 _4190 _4191-> _4187); })))))) in _expr_9)); (2,f) -> u f ((let _expr_8=(u (u (u list_for _wyth_3) _expr_1) (\_defn_8-> (\_expr_9-> (u (u fm_term_app _expr_9) (let _4192 = _defn_8 in (case _4192 of {(0,f) -> u f (\_4193 _4194 _4195 _4196 _4197 _4198 _4199 _4200 _4201-> _4197); })))))) in _expr_8)); (3,f) -> u f (\_4202 _4203 _4204 _4205 _4206-> (let _got_13=(u (u maybe_or (u (u fm_get _4204) _cses_4)) (u (u fm_get "_") _cses_4)) in (let _4207 = _got_13 in (case _4207 of {(0,f) -> u f ((let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (let _4208 = _defn_14 in (case _4208 of {(0,f) -> u f (\_4209 _4210 _4211 _4212 _4213 _4214 _4215 _4216 _4217-> (u (u fm_term_app _expr_15) _4213)); }))))) in _expr_14)); (1,f) -> u f (\_4218-> (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) _wyth_3) _4205) _4218) _defs_6) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4206 (u (u fm_term_var _4203) 0)) (u (u fm_term_var _4204) 0)) in (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_6) _ctxt_7))))); })))); (4,f) -> u f (\_4219 _4220-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4221 = _defn_10 in (case _4221 of {(0,f) -> u f (\_4222 _4223 _4224 _4225 _4226 _4227 _4228 _4229 _4230-> _4226); })))))) in _expr_10)); (5,f) -> u f (\_4231 _4232-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4233 = _defn_10 in (case _4233 of {(0,f) -> u f (\_4234 _4235 _4236 _4237 _4238 _4239 _4240 _4241 _4242-> _4238); })))))) in _expr_10)); (6,f) -> u f (\_4243 _4244 _4245-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4246 = _defn_11 in (case _4246 of {(0,f) -> u f (\_4247 _4248 _4249 _4250 _4251 _4252 _4253 _4254 _4255-> _4251); })))))) in _expr_11)); (7,f) -> u f (\_4256 _4257 _4258-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4259 = _defn_11 in (case _4259 of {(0,f) -> u f (\_4260 _4261 _4262 _4263 _4264 _4265 _4266 _4267 _4268-> _4264); })))))) in _expr_11)); (8,f) -> u f (\_4269 _4270 _4271-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4272 = _defn_11 in (case _4272 of {(0,f) -> u f (\_4273 _4274 _4275 _4276 _4277 _4278 _4279 _4280 _4281-> _4277); })))))) in _expr_11)); (9,f) -> u f (\_4282 _4283 _4284-> (let _expr_11=(u (u (u list_for _wyth_3) _expr_1) (\_defn_11-> (\_expr_12-> (u (u fm_term_app _expr_12) (let _4285 = _defn_11 in (case _4285 of {(0,f) -> u f (\_4286 _4287 _4288 _4289 _4290 _4291 _4292 _4293 _4294-> _4290); })))))) in _expr_11)); (10,f) -> u f (\_4295-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4296 = _defn_9 in (case _4296 of {(0,f) -> u f (\_4297 _4298 _4299 _4300 _4301 _4302 _4303 _4304 _4305-> _4301); })))))) in _expr_9)); (11,f) -> u f (\_4306-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4307 = _defn_9 in (case _4307 of {(0,f) -> u f (\_4308 _4309 _4310 _4311 _4312 _4313 _4314 _4315 _4316-> _4312); })))))) in _expr_9)); (12,f) -> u f (\_4317-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4318 = _defn_9 in (case _4318 of {(0,f) -> u f (\_4319 _4320 _4321 _4322 _4323 _4324 _4325 _4326 _4327-> _4323); })))))) in _expr_9)); (13,f) -> u f (\_4328-> (let _expr_9=(u (u (u list_for _wyth_3) _expr_1) (\_defn_9-> (\_expr_10-> (u (u fm_term_app _expr_10) (let _4329 = _defn_9 in (case _4329 of {(0,f) -> u f (\_4330 _4331 _4332 _4333 _4334 _4335 _4336 _4337 _4338-> _4334); })))))) in _expr_9)); (14,f) -> u f (\_4339 _4340 _4341 _4342 _4343 _4344-> (let _expr_14=(u (u (u list_for _wyth_3) _expr_1) (\_defn_14-> (\_expr_15-> (u (u fm_term_app _expr_15) (let _4345 = _defn_14 in (case _4345 of {(0,f) -> u f (\_4346 _4347 _4348 _4349 _4350 _4351 _4352 _4353 _4354-> _4350); })))))) in _expr_14)); (15,f) -> u f (\_4355 _4356-> (let _expr_10=(u (u (u list_for _wyth_3) _expr_1) (\_defn_10-> (\_expr_11-> (u (u fm_term_app _expr_11) (let _4357 = _defn_10 in (case _4357 of {(0,f) -> u f (\_4358 _4359 _4360 _4361 _4362 _4363 _4364 _4365 _4366-> _4362); })))))) in _expr_10)); })))))))))
fm_term_desugar_cse = (\_expr_1-> (\_name_2-> (\_wyth_3-> (\_cses_4-> (\_moti_5-> (\_type_6-> (\_defs_7-> (\_ctxt_8-> (let _4367 = (u (u fm_term_reduce _type_6) _defs_7) in (case _4367 of {(0,f) -> u f (\_4368 _4369-> maybe_none); (1,f) -> u f (\_4370-> maybe_none); (2,f) -> u f (maybe_none); (3,f) -> u f (\_4371 _4372 _4373 _4374 _4375-> (let _moti_14=(u (u fm_term_desugar_cse_motive _wyth_3) _moti_5) in (let _argm_15=(u (u (u (u (u fm_term_desugar_cse_argument _name_2) list_nil) _4374) _moti_14) _defs_7) in (let _expr_16=(u (u fm_term_app _expr_1) _argm_15) in (let _type_17=(u (u _4375 (u (u fm_term_var _4372) 0)) (u (u fm_term_var _4373) 0)) in (u maybe_some (u (u (u (u (u (u (u fm_term_desugar_cse_cases _expr_16) _name_2) _wyth_3) _cses_4) _type_17) _defs_7) _ctxt_8))))))); (4,f) -> u f (\_4376 _4377-> maybe_none); (5,f) -> u f (\_4378 _4379-> maybe_none); (6,f) -> u f (\_4380 _4381 _4382-> maybe_none); (7,f) -> u f (\_4383 _4384 _4385-> maybe_none); (8,f) -> u f (\_4386 _4387 _4388-> maybe_none); (9,f) -> u f (\_4389 _4390 _4391-> maybe_none); (10,f) -> u f (\_4392-> maybe_none); (11,f) -> u f (\_4393-> maybe_none); (12,f) -> u f (\_4394-> maybe_none); (13,f) -> u f (\_4395-> maybe_none); (14,f) -> u f (\_4396 _4397 _4398 _4399 _4400 _4401-> maybe_none); (15,f) -> u f (\_4402 _4403-> maybe_none); }))))))))))
fm_error_cant_infer = (\_origin_1-> (\_term_2-> (\_context_3-> (6,\t-> t _origin_1 _term_2 _context_3))))
set_has = (\_bits_1-> (\_set_2-> (let _4404 = (u (u map_get _bits_1) _set_2) in (case _4404 of {(0,f) -> u f (bool_false); (1,f) -> u f (\_4405-> bool_true); }))))
set_mut_has = (\_bits_1-> (\_set_2-> (u (u set_has _bits_1) _set_2)))
bool_or = (\a0-> \a1-> (a0 || a1))
fm_term_has_holes = (\_term_1-> (let _4406 = _term_1 in (case _4406 of {(0,f) -> u f (\_4407 _4408-> bool_false); (1,f) -> u f (\_4409-> bool_false); (2,f) -> u f (bool_false); (3,f) -> u f (\_4410 _4411 _4412 _4413 _4414-> (((u fm_term_has_holes _4413) || (u fm_term_has_holes (u (u _4414 fm_term_typ) fm_term_typ))))); (4,f) -> u f (\_4415 _4416-> (u fm_term_has_holes (u _4416 fm_term_typ))); (5,f) -> u f (\_4417 _4418-> (((u fm_term_has_holes _4417) || (u fm_term_has_holes _4418)))); (6,f) -> u f (\_4419 _4420 _4421-> (((u fm_term_has_holes _4420) || (u fm_term_has_holes (u _4421 fm_term_typ))))); (7,f) -> u f (\_4422 _4423 _4424-> (((u fm_term_has_holes _4423) || (u fm_term_has_holes (u _4424 fm_term_typ))))); (8,f) -> u f (\_4425 _4426 _4427-> (((u fm_term_has_holes _4426) || (u fm_term_has_holes _4427)))); (9,f) -> u f (\_4428 _4429 _4430-> bool_false); (10,f) -> u f (\_4431-> bool_true); (11,f) -> u f (\_4432-> bool_false); (12,f) -> u f (\_4433-> bool_false); (13,f) -> u f (\_4434-> bool_false); (14,f) -> u f (\_4435 _4436 _4437 _4438 _4439 _4440-> bool_false); (15,f) -> u f (\_4441 _4442-> (u fm_term_has_holes _4442)); })))
fm_term_equal_hole = (\_path_1-> (\_term_2-> (let _4443 = _term_2 in (case _4443 of {(0,f) -> u f (\_4444 _4445-> (let _4446 = (u fm_term_has_holes _term_2) in (if _4446 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (1,f) -> u f (\_4447-> (let _4448 = (u fm_term_has_holes _term_2) in (if _4448 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (2,f) -> u f ((let _4449 = (u fm_term_has_holes _term_2) in (if _4449 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (3,f) -> u f (\_4450 _4451 _4452 _4453 _4454-> (let _4455 = (u fm_term_has_holes _term_2) in (if _4455 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (4,f) -> u f (\_4456 _4457-> (let _4458 = (u fm_term_has_holes _term_2) in (if _4458 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (5,f) -> u f (\_4459 _4460-> (let _4461 = (u fm_term_has_holes _term_2) in (if _4461 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (6,f) -> u f (\_4462 _4463 _4464-> (let _4465 = (u fm_term_has_holes _term_2) in (if _4465 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (7,f) -> u f (\_4466 _4467 _4468-> (let _4469 = (u fm_term_has_holes _term_2) in (if _4469 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (8,f) -> u f (\_4470 _4471 _4472-> (let _4473 = (u fm_term_has_holes _term_2) in (if _4473 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (9,f) -> u f (\_4474 _4475 _4476-> (let _4477 = (u fm_term_has_holes _term_2) in (if _4477 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (10,f) -> u f (\_4478-> (u (u fm_check_result (u maybe_some bool_true)) list_nil)); (11,f) -> u f (\_4479-> (let _4480 = (u fm_term_has_holes _term_2) in (if _4480 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (12,f) -> u f (\_4481-> (let _4482 = (u fm_term_has_holes _term_2) in (if _4482 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (13,f) -> u f (\_4483-> (let _4484 = (u fm_term_has_holes _term_2) in (if _4484 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (14,f) -> u f (\_4485 _4486 _4487 _4488 _4489 _4490-> (let _4491 = (u fm_term_has_holes _term_2) in (if _4491 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); (15,f) -> u f (\_4492 _4493-> (let _4494 = (u fm_term_has_holes _term_2) in (if _4494 then (u (u fm_check_result (u maybe_some bool_false)) list_nil) else (u (u fm_check_result (u maybe_some bool_true)) (u (u list_cons (u (u fm_error_patch _path_1) (u (u fm_term_normalize _term_2) map_new))) list_nil))))); }))))
fm_term_equal_extra_holes = (\_a_1-> (\_b_2-> (let _4495 = _a_1 in (case _4495 of {(0,f) -> u f (\_4496 _4497-> (let _4498 = _b_2 in (case _4498 of {(0,f) -> u f (\_4499 _4500-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4501-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4502 _4503 _4504 _4505 _4506-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4507 _4508-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4509 _4510-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4511 _4512 _4513-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4514 _4515 _4516-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4517 _4518 _4519-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4520 _4521 _4522-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4523-> (let _4524 = (u (u fm_term_equal_hole _4523) _a_1) in (case _4524 of {(0,f) -> u f (\_4525 _4526-> (let _4527 = _4525 in (case _4527 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4526)); (1,f) -> u f (\_4528-> (let _4529 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4529 of {(0,f) -> u f (\_4530 _4531-> (u (u fm_check_result _4530) (u (u list_concat _4526) _4531))); }))); }))); }))); (11,f) -> u f (\_4532-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4533-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4534-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4535 _4536 _4537 _4538 _4539 _4540-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4541 _4542-> (u (u fm_term_equal_extra_holes _a_1) _4542)); }))); (1,f) -> u f (\_4543-> (let _4544 = _b_2 in (case _4544 of {(0,f) -> u f (\_4545 _4546-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4547-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4548 _4549 _4550 _4551 _4552-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4553 _4554-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4555 _4556-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4557 _4558 _4559-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4560 _4561 _4562-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4563 _4564 _4565-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4566 _4567 _4568-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4569-> (let _4570 = (u (u fm_term_equal_hole _4569) _a_1) in (case _4570 of {(0,f) -> u f (\_4571 _4572-> (let _4573 = _4571 in (case _4573 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4572)); (1,f) -> u f (\_4574-> (let _4575 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4575 of {(0,f) -> u f (\_4576 _4577-> (u (u fm_check_result _4576) (u (u list_concat _4572) _4577))); }))); }))); }))); (11,f) -> u f (\_4578-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4579-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4580-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4581 _4582 _4583 _4584 _4585 _4586-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4587 _4588-> (u (u fm_term_equal_extra_holes _a_1) _4588)); }))); (2,f) -> u f ((let _4589 = _b_2 in (case _4589 of {(0,f) -> u f (\_4590 _4591-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4592-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4593 _4594 _4595 _4596 _4597-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4598 _4599-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4600 _4601-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4602 _4603 _4604-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4605 _4606 _4607-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4608 _4609 _4610-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4611 _4612 _4613-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4614-> (let _4615 = (u (u fm_term_equal_hole _4614) _a_1) in (case _4615 of {(0,f) -> u f (\_4616 _4617-> (let _4618 = _4616 in (case _4618 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4617)); (1,f) -> u f (\_4619-> (let _4620 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4620 of {(0,f) -> u f (\_4621 _4622-> (u (u fm_check_result _4621) (u (u list_concat _4617) _4622))); }))); }))); }))); (11,f) -> u f (\_4623-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4624-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4625-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4626 _4627 _4628 _4629 _4630 _4631-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4632 _4633-> (u (u fm_term_equal_extra_holes _a_1) _4633)); }))); (3,f) -> u f (\_4634 _4635 _4636 _4637 _4638-> (let _4639 = _b_2 in (case _4639 of {(0,f) -> u f (\_4640 _4641-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4642-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4643 _4644 _4645 _4646 _4647-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4648 _4649-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4650 _4651-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4652 _4653 _4654-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4655 _4656 _4657-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4658 _4659 _4660-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4661 _4662 _4663-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4664-> (let _4665 = (u (u fm_term_equal_hole _4664) _a_1) in (case _4665 of {(0,f) -> u f (\_4666 _4667-> (let _4668 = _4666 in (case _4668 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4667)); (1,f) -> u f (\_4669-> (let _4670 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4670 of {(0,f) -> u f (\_4671 _4672-> (u (u fm_check_result _4671) (u (u list_concat _4667) _4672))); }))); }))); }))); (11,f) -> u f (\_4673-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4674-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4675-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4676 _4677 _4678 _4679 _4680 _4681-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4682 _4683-> (u (u fm_term_equal_extra_holes _a_1) _4683)); }))); (4,f) -> u f (\_4684 _4685-> (let _4686 = _b_2 in (case _4686 of {(0,f) -> u f (\_4687 _4688-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4689-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4690 _4691 _4692 _4693 _4694-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4695 _4696-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4697 _4698-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4699 _4700 _4701-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4702 _4703 _4704-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4705 _4706 _4707-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4708 _4709 _4710-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4711-> (let _4712 = (u (u fm_term_equal_hole _4711) _a_1) in (case _4712 of {(0,f) -> u f (\_4713 _4714-> (let _4715 = _4713 in (case _4715 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4714)); (1,f) -> u f (\_4716-> (let _4717 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4717 of {(0,f) -> u f (\_4718 _4719-> (u (u fm_check_result _4718) (u (u list_concat _4714) _4719))); }))); }))); }))); (11,f) -> u f (\_4720-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4721-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4722-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4723 _4724 _4725 _4726 _4727 _4728-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4729 _4730-> (u (u fm_term_equal_extra_holes _a_1) _4730)); }))); (5,f) -> u f (\_4731 _4732-> (let _4733 = _b_2 in (case _4733 of {(0,f) -> u f (\_4734 _4735-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4736-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4737 _4738 _4739 _4740 _4741-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4742 _4743-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4744 _4745-> (let _4746 = (u (u fm_term_equal_extra_holes _4731) _4744) in (case _4746 of {(0,f) -> u f (\_4747 _4748-> (let _4749 = _4747 in (case _4749 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4748)); (1,f) -> u f (\_4750-> (let _4751 = (u (u fm_term_equal_extra_holes _4732) _4745) in (case _4751 of {(0,f) -> u f (\_4752 _4753-> (u (u fm_check_result _4752) (u (u list_concat _4748) _4753))); }))); }))); }))); (6,f) -> u f (\_4754 _4755 _4756-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4757 _4758 _4759-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4760 _4761 _4762-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4763 _4764 _4765-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4766-> (let _4767 = (u (u fm_term_equal_hole _4766) _a_1) in (case _4767 of {(0,f) -> u f (\_4768 _4769-> (let _4770 = _4768 in (case _4770 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4769)); (1,f) -> u f (\_4771-> (let _4772 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4772 of {(0,f) -> u f (\_4773 _4774-> (u (u fm_check_result _4773) (u (u list_concat _4769) _4774))); }))); }))); }))); (11,f) -> u f (\_4775-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4776-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4777-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4778 _4779 _4780 _4781 _4782 _4783-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4784 _4785-> (u (u fm_term_equal_extra_holes _a_1) _4785)); }))); (6,f) -> u f (\_4786 _4787 _4788-> (let _4789 = _b_2 in (case _4789 of {(0,f) -> u f (\_4790 _4791-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4792-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4793 _4794 _4795 _4796 _4797-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4798 _4799-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4800 _4801-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4802 _4803 _4804-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4805 _4806 _4807-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4808 _4809 _4810-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4811 _4812 _4813-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4814-> (let _4815 = (u (u fm_term_equal_hole _4814) _a_1) in (case _4815 of {(0,f) -> u f (\_4816 _4817-> (let _4818 = _4816 in (case _4818 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4817)); (1,f) -> u f (\_4819-> (let _4820 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4820 of {(0,f) -> u f (\_4821 _4822-> (u (u fm_check_result _4821) (u (u list_concat _4817) _4822))); }))); }))); }))); (11,f) -> u f (\_4823-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4824-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4825-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4826 _4827 _4828 _4829 _4830 _4831-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4832 _4833-> (u (u fm_term_equal_extra_holes _a_1) _4833)); }))); (7,f) -> u f (\_4834 _4835 _4836-> (let _4837 = _b_2 in (case _4837 of {(0,f) -> u f (\_4838 _4839-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4840-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4841 _4842 _4843 _4844 _4845-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4846 _4847-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4848 _4849-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4850 _4851 _4852-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4853 _4854 _4855-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4856 _4857 _4858-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4859 _4860 _4861-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4862-> (let _4863 = (u (u fm_term_equal_hole _4862) _a_1) in (case _4863 of {(0,f) -> u f (\_4864 _4865-> (let _4866 = _4864 in (case _4866 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4865)); (1,f) -> u f (\_4867-> (let _4868 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4868 of {(0,f) -> u f (\_4869 _4870-> (u (u fm_check_result _4869) (u (u list_concat _4865) _4870))); }))); }))); }))); (11,f) -> u f (\_4871-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4872-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4873-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4874 _4875 _4876 _4877 _4878 _4879-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4880 _4881-> (u (u fm_term_equal_extra_holes _a_1) _4881)); }))); (8,f) -> u f (\_4882 _4883 _4884-> (let _4885 = _b_2 in (case _4885 of {(0,f) -> u f (\_4886 _4887-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4888-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4889 _4890 _4891 _4892 _4893-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4894 _4895-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4896 _4897-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4898 _4899 _4900-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4901 _4902 _4903-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4904 _4905 _4906-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4907 _4908 _4909-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4910-> (let _4911 = (u (u fm_term_equal_hole _4910) _a_1) in (case _4911 of {(0,f) -> u f (\_4912 _4913-> (let _4914 = _4912 in (case _4914 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4913)); (1,f) -> u f (\_4915-> (let _4916 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4916 of {(0,f) -> u f (\_4917 _4918-> (u (u fm_check_result _4917) (u (u list_concat _4913) _4918))); }))); }))); }))); (11,f) -> u f (\_4919-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4920-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4921-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4922 _4923 _4924 _4925 _4926 _4927-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4928 _4929-> (u (u fm_term_equal_extra_holes _a_1) _4929)); }))); (9,f) -> u f (\_4930 _4931 _4932-> (let _4933 = _b_2 in (case _4933 of {(0,f) -> u f (\_4934 _4935-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4936-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4937 _4938 _4939 _4940 _4941-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4942 _4943-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4944 _4945-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_4946 _4947 _4948-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_4949 _4950 _4951-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_4952 _4953 _4954-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_4955 _4956 _4957-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_4958-> (let _4959 = (u (u fm_term_equal_hole _4958) _a_1) in (case _4959 of {(0,f) -> u f (\_4960 _4961-> (let _4962 = _4960 in (case _4962 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4961)); (1,f) -> u f (\_4963-> (let _4964 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4964 of {(0,f) -> u f (\_4965 _4966-> (u (u fm_check_result _4965) (u (u list_concat _4961) _4966))); }))); }))); }))); (11,f) -> u f (\_4967-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_4968-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_4969-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_4970 _4971 _4972 _4973 _4974 _4975-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_4976 _4977-> (u (u fm_term_equal_extra_holes _a_1) _4977)); }))); (10,f) -> u f (\_4978-> (let _4979 = (u (u fm_term_equal_hole _4978) _b_2) in (case _4979 of {(0,f) -> u f (\_4980 _4981-> (let _4982 = _4980 in (case _4982 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _4981)); (1,f) -> u f (\_4983-> (let _4984 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _4984 of {(0,f) -> u f (\_4985 _4986-> (u (u fm_check_result _4985) (u (u list_concat _4981) _4986))); }))); }))); }))); (11,f) -> u f (\_4987-> (let _4988 = _b_2 in (case _4988 of {(0,f) -> u f (\_4989 _4990-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_4991-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_4992 _4993 _4994 _4995 _4996-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_4997 _4998-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_4999 _5000-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_5001 _5002 _5003-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_5004 _5005 _5006-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_5007 _5008 _5009-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5010 _5011 _5012-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5013-> (let _5014 = (u (u fm_term_equal_hole _5013) _a_1) in (case _5014 of {(0,f) -> u f (\_5015 _5016-> (let _5017 = _5015 in (case _5017 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5016)); (1,f) -> u f (\_5018-> (let _5019 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5019 of {(0,f) -> u f (\_5020 _5021-> (u (u fm_check_result _5020) (u (u list_concat _5016) _5021))); }))); }))); }))); (11,f) -> u f (\_5022-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5023-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5024-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5025 _5026 _5027 _5028 _5029 _5030-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5031 _5032-> (u (u fm_term_equal_extra_holes _a_1) _5032)); }))); (12,f) -> u f (\_5033-> (let _5034 = _b_2 in (case _5034 of {(0,f) -> u f (\_5035 _5036-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_5037-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_5038 _5039 _5040 _5041 _5042-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_5043 _5044-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_5045 _5046-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_5047 _5048 _5049-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_5050 _5051 _5052-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_5053 _5054 _5055-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5056 _5057 _5058-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5059-> (let _5060 = (u (u fm_term_equal_hole _5059) _a_1) in (case _5060 of {(0,f) -> u f (\_5061 _5062-> (let _5063 = _5061 in (case _5063 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5062)); (1,f) -> u f (\_5064-> (let _5065 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5065 of {(0,f) -> u f (\_5066 _5067-> (u (u fm_check_result _5066) (u (u list_concat _5062) _5067))); }))); }))); }))); (11,f) -> u f (\_5068-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5069-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5070-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5071 _5072 _5073 _5074 _5075 _5076-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5077 _5078-> (u (u fm_term_equal_extra_holes _a_1) _5078)); }))); (13,f) -> u f (\_5079-> (let _5080 = _b_2 in (case _5080 of {(0,f) -> u f (\_5081 _5082-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_5083-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_5084 _5085 _5086 _5087 _5088-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_5089 _5090-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_5091 _5092-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_5093 _5094 _5095-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_5096 _5097 _5098-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_5099 _5100 _5101-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5102 _5103 _5104-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5105-> (let _5106 = (u (u fm_term_equal_hole _5105) _a_1) in (case _5106 of {(0,f) -> u f (\_5107 _5108-> (let _5109 = _5107 in (case _5109 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5108)); (1,f) -> u f (\_5110-> (let _5111 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5111 of {(0,f) -> u f (\_5112 _5113-> (u (u fm_check_result _5112) (u (u list_concat _5108) _5113))); }))); }))); }))); (11,f) -> u f (\_5114-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5115-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5116-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5117 _5118 _5119 _5120 _5121 _5122-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5123 _5124-> (u (u fm_term_equal_extra_holes _a_1) _5124)); }))); (14,f) -> u f (\_5125 _5126 _5127 _5128 _5129 _5130-> (let _5131 = _b_2 in (case _5131 of {(0,f) -> u f (\_5132 _5133-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (1,f) -> u f (\_5134-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some unit_new)) list_nil)); (3,f) -> u f (\_5135 _5136 _5137 _5138 _5139-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (4,f) -> u f (\_5140 _5141-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (5,f) -> u f (\_5142 _5143-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (6,f) -> u f (\_5144 _5145 _5146-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (7,f) -> u f (\_5147 _5148 _5149-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (8,f) -> u f (\_5150 _5151 _5152-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (9,f) -> u f (\_5153 _5154 _5155-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (10,f) -> u f (\_5156-> (let _5157 = (u (u fm_term_equal_hole _5156) _a_1) in (case _5157 of {(0,f) -> u f (\_5158 _5159-> (let _5160 = _5158 in (case _5160 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5159)); (1,f) -> u f (\_5161-> (let _5162 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _5162 of {(0,f) -> u f (\_5163 _5164-> (u (u fm_check_result _5163) (u (u list_concat _5159) _5164))); }))); }))); }))); (11,f) -> u f (\_5165-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (12,f) -> u f (\_5166-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (13,f) -> u f (\_5167-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (14,f) -> u f (\_5168 _5169 _5170 _5171 _5172 _5173-> (u (u fm_check_result (u maybe_some unit_new)) list_nil)); (15,f) -> u f (\_5174 _5175-> (u (u fm_term_equal_extra_holes _a_1) _5175)); }))); (15,f) -> u f (\_5176 _5177-> (u (u fm_term_equal_extra_holes _5177) _b_2)); }))))
set_set = (\_bits_1-> (\_set_2-> (u (u (u map_set _bits_1) unit_new) _set_2)))
set_mut_set = (\_bits_1-> (\_set_2-> (u (u set_set _bits_1) _set_2)))
bool_eql = (\_a_1-> (\_b_2-> (let _5178 = _a_1 in (if _5178 then _b_2 else ((not _b_2))))))
fm_term_equal = (\_a_1-> (\_b_2-> (\_defs_3-> (\_lv_4-> (\_seen_5-> (let _ah_6=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _a_1) map_new)) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_7=(u (u (u (u (u fm_term_serialize (u (u fm_term_reduce _b_2) map_new)) _lv_4) _lv_4) bits_i) bits_e) in (let _5179 = (u (u bits_eql _ah_6) _bh_7) in (if _5179 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _a1_8=(u (u fm_term_reduce _a_1) _defs_3) in (let _b1_9=(u (u fm_term_reduce _b_2) _defs_3) in (let _ah_10=(u (u (u (u (u fm_term_serialize _a1_8) _lv_4) _lv_4) bits_o) bits_e) in (let _bh_11=(u (u (u (u (u fm_term_serialize _b1_9) _lv_4) _lv_4) bits_i) bits_e) in (let _5180 = (u (u bits_eql _ah_10) _bh_11) in (if _5180 then (u (u fm_check_result (u maybe_some bool_true)) list_nil) else (let _id_12=(u (u bits_concat _ah_10) _bh_11) in (let _5181 = (u (u set_mut_has _id_12) _seen_5) in (if _5181 then (let _5182 = (u (u fm_term_equal_extra_holes _a_1) _b_2) in (case _5182 of {(0,f) -> u f (\_5183 _5184-> (let _5185 = _5183 in (case _5185 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5184)); (1,f) -> u f (\_5186-> (let _5187 = (u (u fm_check_result (u maybe_some bool_true)) list_nil) in (case _5187 of {(0,f) -> u f (\_5188 _5189-> (u (u fm_check_result _5188) (u (u list_concat _5184) _5189))); }))); }))); })) else (let _5190 = _a1_8 in (case _5190 of {(0,f) -> u f (\_5191 _5192-> (let _5193 = _b1_9 in (case _5193 of {(0,f) -> u f (\_5194 _5195-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5196-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5197 _5198 _5199 _5200 _5201-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5202 _5203-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5204 _5205-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5206 _5207 _5208-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5209 _5210 _5211-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5212 _5213 _5214-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5215 _5216 _5217-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5218-> (u (u fm_term_equal_hole _5218) _a_1)); (11,f) -> u f (\_5219-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5220-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5221-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5222 _5223 _5224 _5225 _5226 _5227-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5228 _5229-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (1,f) -> u f (\_5230-> (let _5231 = _b1_9 in (case _5231 of {(0,f) -> u f (\_5232 _5233-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5234-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5235 _5236 _5237 _5238 _5239-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5240 _5241-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5242 _5243-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5244 _5245 _5246-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5247 _5248 _5249-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5250 _5251 _5252-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5253 _5254 _5255-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5256-> (u (u fm_term_equal_hole _5256) _a_1)); (11,f) -> u f (\_5257-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5258-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5259-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5260 _5261 _5262 _5263 _5264 _5265-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5266 _5267-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (2,f) -> u f ((let _5268 = _b1_9 in (case _5268 of {(0,f) -> u f (\_5269 _5270-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5271-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5272 _5273 _5274 _5275 _5276-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5277 _5278-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5279 _5280-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5281 _5282 _5283-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5284 _5285 _5286-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5287 _5288 _5289-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5290 _5291 _5292-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5293-> (u (u fm_term_equal_hole _5293) _a_1)); (11,f) -> u f (\_5294-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5295-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5296-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5297 _5298 _5299 _5300 _5301 _5302-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5303 _5304-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (3,f) -> u f (\_5305 _5306 _5307 _5308 _5309-> (let _5310 = _b1_9 in (case _5310 of {(0,f) -> u f (\_5311 _5312-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5313-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5314 _5315 _5316 _5317 _5318-> (let _seen_23=(u (u set_mut_set _id_12) _seen_5) in (let _a1_body_24=(u (u _5309 (u (u fm_term_var _5306) _lv_4)) (u (u fm_term_var _5307) (u nat_succ _lv_4))) in (let _b1_body_25=(u (u _5318 (u (u fm_term_var _5315) _lv_4)) (u (u fm_term_var _5316) (u nat_succ _lv_4))) in (let _eq_self_26=(((_5306::String) == _5315)) in (let _eq_eras_27=(u (u bool_eql _5305) _5314) in (let _5319 = ((_eq_self_26 && _eq_eras_27)) in (if _5319 then (let _5320 = (u (u (u (u (u fm_term_equal _5308) _5317) _defs_3) _lv_4) _seen_23) in (case _5320 of {(0,f) -> u f (\_5321 _5322-> (let _5323 = _5321 in (case _5323 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5322)); (1,f) -> u f (\_5324-> (let _5325 = (let _5326 = (u (u (u (u (u fm_term_equal _a1_body_24) _b1_body_25) _defs_3) (u nat_succ (u nat_succ _lv_4))) _seen_23) in (case _5326 of {(0,f) -> u f (\_5327 _5328-> (let _5329 = _5327 in (case _5329 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5328)); (1,f) -> u f (\_5330-> (let _5331 = (u (u fm_check_result (u maybe_some ((_5324 && _5330)))) list_nil) in (case _5331 of {(0,f) -> u f (\_5332 _5333-> (u (u fm_check_result _5332) (u (u list_concat _5328) _5333))); }))); }))); })) in (case _5325 of {(0,f) -> u f (\_5334 _5335-> (u (u fm_check_result _5334) (u (u list_concat _5322) _5335))); }))); }))); })) else (u (u fm_check_result (u maybe_some bool_false)) list_nil))))))))); (4,f) -> u f (\_5336 _5337-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5338 _5339-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5340 _5341 _5342-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5343 _5344 _5345-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5346 _5347 _5348-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5349 _5350 _5351-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5352-> (u (u fm_term_equal_hole _5352) _a_1)); (11,f) -> u f (\_5353-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5354-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5355-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5356 _5357 _5358 _5359 _5360 _5361-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5362 _5363-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (4,f) -> u f (\_5364 _5365-> (let _5366 = _b1_9 in (case _5366 of {(0,f) -> u f (\_5367 _5368-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5369-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5370 _5371 _5372 _5373 _5374-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5375 _5376-> (let _seen_17=(u (u set_mut_set _id_12) _seen_5) in (let _a1_body_18=(u _5365 (u (u fm_term_var _5364) _lv_4)) in (let _b1_body_19=(u _5376 (u (u fm_term_var _5375) _lv_4)) in (let _5377 = (u (u (u (u (u fm_term_equal _a1_body_18) _b1_body_19) _defs_3) (u nat_succ _lv_4)) _seen_17) in (case _5377 of {(0,f) -> u f (\_5378 _5379-> (let _5380 = _5378 in (case _5380 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5379)); (1,f) -> u f (\_5381-> (let _5382 = (u (u fm_check_result (u maybe_some _5381)) list_nil) in (case _5382 of {(0,f) -> u f (\_5383 _5384-> (u (u fm_check_result _5383) (u (u list_concat _5379) _5384))); }))); }))); })))))); (5,f) -> u f (\_5385 _5386-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5387 _5388 _5389-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5390 _5391 _5392-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5393 _5394 _5395-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5396 _5397 _5398-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5399-> (u (u fm_term_equal_hole _5399) _a_1)); (11,f) -> u f (\_5400-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5401-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5402-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5403 _5404 _5405 _5406 _5407 _5408-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5409 _5410-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (5,f) -> u f (\_5411 _5412-> (let _5413 = _b1_9 in (case _5413 of {(0,f) -> u f (\_5414 _5415-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5416-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5417 _5418 _5419 _5420 _5421-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5422 _5423-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5424 _5425-> (let _seen_17=(u (u set_mut_set _id_12) _seen_5) in (let _5426 = (u (u (u (u (u fm_term_equal _5411) _5424) _defs_3) _lv_4) _seen_17) in (case _5426 of {(0,f) -> u f (\_5427 _5428-> (let _5429 = _5427 in (case _5429 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5428)); (1,f) -> u f (\_5430-> (let _5431 = (let _5432 = (u (u (u (u (u fm_term_equal _5412) _5425) _defs_3) _lv_4) _seen_17) in (case _5432 of {(0,f) -> u f (\_5433 _5434-> (let _5435 = _5433 in (case _5435 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5434)); (1,f) -> u f (\_5436-> (let _5437 = (u (u fm_check_result (u maybe_some ((_5430 && _5436)))) list_nil) in (case _5437 of {(0,f) -> u f (\_5438 _5439-> (u (u fm_check_result _5438) (u (u list_concat _5434) _5439))); }))); }))); })) in (case _5431 of {(0,f) -> u f (\_5440 _5441-> (u (u fm_check_result _5440) (u (u list_concat _5428) _5441))); }))); }))); })))); (6,f) -> u f (\_5442 _5443 _5444-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5445 _5446 _5447-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5448 _5449 _5450-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5451 _5452 _5453-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5454-> (u (u fm_term_equal_hole _5454) _a_1)); (11,f) -> u f (\_5455-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5456-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5457-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5458 _5459 _5460 _5461 _5462 _5463-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5464 _5465-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (6,f) -> u f (\_5466 _5467 _5468-> (let _5469 = _b1_9 in (case _5469 of {(0,f) -> u f (\_5470 _5471-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5472-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5473 _5474 _5475 _5476 _5477-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5478 _5479-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5480 _5481-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5482 _5483 _5484-> (let _seen_19=(u (u set_mut_set _id_12) _seen_5) in (let _a1_body_20=(u _5468 (u (u fm_term_var _5466) _lv_4)) in (let _b1_body_21=(u _5484 (u (u fm_term_var _5482) _lv_4)) in (let _5485 = (u (u (u (u (u fm_term_equal _5467) _5483) _defs_3) _lv_4) _seen_19) in (case _5485 of {(0,f) -> u f (\_5486 _5487-> (let _5488 = _5486 in (case _5488 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5487)); (1,f) -> u f (\_5489-> (let _5490 = (let _5491 = (u (u (u (u (u fm_term_equal _a1_body_20) _b1_body_21) _defs_3) (u nat_succ _lv_4)) _seen_19) in (case _5491 of {(0,f) -> u f (\_5492 _5493-> (let _5494 = _5492 in (case _5494 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5493)); (1,f) -> u f (\_5495-> (let _5496 = (u (u fm_check_result (u maybe_some ((_5489 && _5495)))) list_nil) in (case _5496 of {(0,f) -> u f (\_5497 _5498-> (u (u fm_check_result _5497) (u (u list_concat _5493) _5498))); }))); }))); })) in (case _5490 of {(0,f) -> u f (\_5499 _5500-> (u (u fm_check_result _5499) (u (u list_concat _5487) _5500))); }))); }))); })))))); (7,f) -> u f (\_5501 _5502 _5503-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5504 _5505 _5506-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5507 _5508 _5509-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5510-> (u (u fm_term_equal_hole _5510) _a_1)); (11,f) -> u f (\_5511-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5512-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5513-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5514 _5515 _5516 _5517 _5518 _5519-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5520 _5521-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (7,f) -> u f (\_5522 _5523 _5524-> (let _5525 = _b1_9 in (case _5525 of {(0,f) -> u f (\_5526 _5527-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5528-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5529 _5530 _5531 _5532 _5533-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5534 _5535-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5536 _5537-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5538 _5539 _5540-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5541 _5542 _5543-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5544 _5545 _5546-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5547 _5548 _5549-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5550-> (u (u fm_term_equal_hole _5550) _a_1)); (11,f) -> u f (\_5551-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5552-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5553-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5554 _5555 _5556 _5557 _5558 _5559-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5560 _5561-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (8,f) -> u f (\_5562 _5563 _5564-> (let _5565 = _b1_9 in (case _5565 of {(0,f) -> u f (\_5566 _5567-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5568-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5569 _5570 _5571 _5572 _5573-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5574 _5575-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5576 _5577-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5578 _5579 _5580-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5581 _5582 _5583-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5584 _5585 _5586-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5587 _5588 _5589-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5590-> (u (u fm_term_equal_hole _5590) _a_1)); (11,f) -> u f (\_5591-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5592-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5593-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5594 _5595 _5596 _5597 _5598 _5599-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5600 _5601-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (9,f) -> u f (\_5602 _5603 _5604-> (let _5605 = _b1_9 in (case _5605 of {(0,f) -> u f (\_5606 _5607-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5608-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5609 _5610 _5611 _5612 _5613-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5614 _5615-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5616 _5617-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5618 _5619 _5620-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5621 _5622 _5623-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5624 _5625 _5626-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5627 _5628 _5629-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5630-> (u (u fm_term_equal_hole _5630) _a_1)); (11,f) -> u f (\_5631-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5632-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5633-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5634 _5635 _5636 _5637 _5638 _5639-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5640 _5641-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (10,f) -> u f (\_5642-> (u (u fm_term_equal_hole _5642) _b_2)); (11,f) -> u f (\_5643-> (let _5644 = _b1_9 in (case _5644 of {(0,f) -> u f (\_5645 _5646-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5647-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5648 _5649 _5650 _5651 _5652-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5653 _5654-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5655 _5656-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5657 _5658 _5659-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5660 _5661 _5662-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5663 _5664 _5665-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5666 _5667 _5668-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5669-> (u (u fm_term_equal_hole _5669) _a_1)); (11,f) -> u f (\_5670-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5671-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5672-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5673 _5674 _5675 _5676 _5677 _5678-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5679 _5680-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (12,f) -> u f (\_5681-> (let _5682 = _b1_9 in (case _5682 of {(0,f) -> u f (\_5683 _5684-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5685-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5686 _5687 _5688 _5689 _5690-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5691 _5692-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5693 _5694-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5695 _5696 _5697-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5698 _5699 _5700-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5701 _5702 _5703-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5704 _5705 _5706-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5707-> (u (u fm_term_equal_hole _5707) _a_1)); (11,f) -> u f (\_5708-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5709-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5710-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5711 _5712 _5713 _5714 _5715 _5716-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5717 _5718-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (13,f) -> u f (\_5719-> (let _5720 = _b1_9 in (case _5720 of {(0,f) -> u f (\_5721 _5722-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5723-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5724 _5725 _5726 _5727 _5728-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5729 _5730-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5731 _5732-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5733 _5734 _5735-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5736 _5737 _5738-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5739 _5740 _5741-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5742 _5743 _5744-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5745-> (u (u fm_term_equal_hole _5745) _a_1)); (11,f) -> u f (\_5746-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5747-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5748-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5749 _5750 _5751 _5752 _5753 _5754-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5755 _5756-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (14,f) -> u f (\_5757 _5758 _5759 _5760 _5761 _5762-> (let _5763 = _b1_9 in (case _5763 of {(0,f) -> u f (\_5764 _5765-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5766-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5767 _5768 _5769 _5770 _5771-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5772 _5773-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5774 _5775-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5776 _5777 _5778-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5779 _5780 _5781-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5782 _5783 _5784-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5785 _5786 _5787-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5788-> (u (u fm_term_equal_hole _5788) _a_1)); (11,f) -> u f (\_5789-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5790-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5791-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5792 _5793 _5794 _5795 _5796 _5797-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5798 _5799-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); (15,f) -> u f (\_5800 _5801-> (let _5802 = _b1_9 in (case _5802 of {(0,f) -> u f (\_5803 _5804-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (1,f) -> u f (\_5805-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some bool_false)) list_nil)); (3,f) -> u f (\_5806 _5807 _5808 _5809 _5810-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (4,f) -> u f (\_5811 _5812-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (5,f) -> u f (\_5813 _5814-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (6,f) -> u f (\_5815 _5816 _5817-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (7,f) -> u f (\_5818 _5819 _5820-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (8,f) -> u f (\_5821 _5822 _5823-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (9,f) -> u f (\_5824 _5825 _5826-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (10,f) -> u f (\_5827-> (u (u fm_term_equal_hole _5827) _a_1)); (11,f) -> u f (\_5828-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (12,f) -> u f (\_5829-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (13,f) -> u f (\_5830-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (14,f) -> u f (\_5831 _5832 _5833 _5834 _5835 _5836-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); (15,f) -> u f (\_5837 _5838-> (u (u fm_check_result (u maybe_some bool_false)) list_nil)); }))); }))))))))))))))))))))
set_new = map_new
set_mut_new = (\_a_1-> set_new)
fm_term_check = (\_term_1-> (\_type_2-> (\_defs_3-> (\_ctx_4-> (\_path_5-> (\_orig_6-> (let _5839 = (let _5840 = _term_1 in (case _5840 of {(0,f) -> u f (\_5841 _5842-> (let _5843 = (u (u list_at_last _5842) _ctx_4) in (case _5843 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5841)) list_nil))); (1,f) -> u f (\_5844-> (u (u fm_check_result (u maybe_some (let _5845 = _5844 in (case _5845 of {(0,f) -> u f (\_5846 _5847-> _5847); })))) list_nil)); }))); (1,f) -> u f (\_5848-> (let _5849 = (u (u fm_get _5848) _defs_3) in (case _5849 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_undefined_reference _orig_6) _5848)) list_nil))); (1,f) -> u f (\_5850-> (let _5851 = _5850 in (case _5851 of {(0,f) -> u f (\_5852 _5853 _5854 _5855 _5856 _5857 _5858 _5859 _5860-> (let _ref_name_18=_5855 in (let _ref_type_19=_5857 in (let _ref_term_20=_5856 in (let _ref_stat_21=_5860 in (let _5861 = _ref_stat_21 in (case _5861 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_19)) (u (u list_cons (u fm_error_waiting _ref_name_18)) list_nil))); (1,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_19)) list_nil)); (2,f) -> u f ((u (u fm_check_result (u maybe_some _ref_type_19)) list_nil)); (3,f) -> u f (\_5862-> (u (u fm_check_result (u maybe_some _ref_type_19)) (u (u list_cons (u fm_error_indirect _ref_name_18)) list_nil))); }))))))); }))); }))); (2,f) -> u f ((u (u fm_check_result (u maybe_some fm_term_typ)) list_nil)); (3,f) -> u f (\_5863 _5864 _5865 _5866 _5867-> (let _ctx_size_12=(u list_length _ctx_4) in (let _self_var_13=(u (u fm_term_var _5864) _ctx_size_12) in (let _body_var_14=(u (u fm_term_var _5865) (u nat_succ _ctx_size_12)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5865) _5866)) (u (u list_cons (u (u pair_new _5864) _term_1)) _ctx_4)) in (let _5868 = (u (u (u (u (u (u fm_term_check _5866) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5868 of {(0,f) -> u f (\_5869 _5870-> (let _5871 = _5869 in (case _5871 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5870)); (1,f) -> u f (\_5872-> (let _5873 = (let _5874 = (u (u (u (u (u (u fm_term_check (u (u _5867 _self_var_13) _body_var_14)) (u maybe_some fm_term_typ)) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5874 of {(0,f) -> u f (\_5875 _5876-> (let _5877 = _5875 in (case _5877 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5876)); (1,f) -> u f (\_5878-> (let _5879 = (u (u fm_check_result (u maybe_some fm_term_typ)) list_nil) in (case _5879 of {(0,f) -> u f (\_5880 _5881-> (u (u fm_check_result _5880) (u (u list_concat _5876) _5881))); }))); }))); })) in (case _5873 of {(0,f) -> u f (\_5882 _5883-> (u (u fm_check_result _5882) (u (u list_concat _5870) _5883))); }))); }))); }))))))); (4,f) -> u f (\_5884 _5885-> (let _5886 = _type_2 in (case _5886 of {(0,f) -> u f ((let _lam_type_9=(u fm_term_hol bits_e) in (let _lam_term_10=(u (u (u fm_term_ann bool_false) _term_1) _lam_type_9) in (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _lam_term_10)) list_nil))))); (1,f) -> u f (\_5887-> (let _typv_10=(u (u fm_term_reduce _5887) _defs_3) in (let _5888 = _typv_10 in (case _5888 of {(0,f) -> u f (\_5889 _5890-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (1,f) -> u f (\_5891-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_11=(u either_left "(function type)") in (let _detected_12=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_11) _detected_12) _ctx_4)) list_nil))))); (3,f) -> u f (\_5892 _5893 _5894 _5895 _5896-> (let _ctx_size_16=(u list_length _ctx_4) in (let _self_var_17=_term_1 in (let _body_var_18=(u (u fm_term_var _5884) _ctx_size_16) in (let _body_typ_19=(u (u _5896 _self_var_17) _body_var_18) in (let _body_ctx_20=(u (u list_cons (u (u pair_new _5884) _5895)) _ctx_4) in (let _5897 = (u (u (u (u (u (u fm_term_check (u _5885 _body_var_18)) (u maybe_some _body_typ_19)) _defs_3) _body_ctx_20) (u fm_mpath_o _path_5)) _orig_6) in (case _5897 of {(0,f) -> u f (\_5898 _5899-> (let _5900 = _5898 in (case _5900 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5899)); (1,f) -> u f (\_5901-> (let _5902 = (u (u fm_check_result (u maybe_some _5887)) list_nil) in (case _5902 of {(0,f) -> u f (\_5903 _5904-> (u (u fm_check_result _5903) (u (u list_concat _5899) _5904))); }))); }))); })))))))); (4,f) -> u f (\_5905 _5906-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (5,f) -> u f (\_5907 _5908-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (6,f) -> u f (\_5909 _5910 _5911-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (7,f) -> u f (\_5912 _5913 _5914-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (8,f) -> u f (\_5915 _5916 _5917-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (9,f) -> u f (\_5918 _5919 _5920-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (10,f) -> u f (\_5921-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (11,f) -> u f (\_5922-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (12,f) -> u f (\_5923-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (13,f) -> u f (\_5924-> (let _expected_12=(u either_left "(function type)") in (let _detected_13=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_12) _detected_13) _ctx_4)) list_nil))))); (14,f) -> u f (\_5925 _5926 _5927 _5928 _5929 _5930-> (let _expected_17=(u either_left "(function type)") in (let _detected_18=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_17) _detected_18) _ctx_4)) list_nil))))); (15,f) -> u f (\_5931 _5932-> (let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _5887) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); })))); }))); (5,f) -> u f (\_5933 _5934-> (let _5935 = (u (u (u (u (u (u fm_term_check _5933) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5935 of {(0,f) -> u f (\_5936 _5937-> (let _5938 = _5936 in (case _5938 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5937)); (1,f) -> u f (\_5939-> (let _func_typ_12=(u (u fm_term_reduce _5939) _defs_3) in (let _5940 = (let _5941 = _func_typ_12 in (case _5941 of {(0,f) -> u f (\_5942 _5943-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (1,f) -> u f (\_5944-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (2,f) -> u f ((let _expected_13=(u either_left "(function type)") in (let _detected_14=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_13) _detected_14) _ctx_4)) list_nil))))); (3,f) -> u f (\_5945 _5946 _5947 _5948 _5949-> (let _5950 = (u (u (u (u (u (u fm_term_check _5934) (u maybe_some _5948)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _5950 of {(0,f) -> u f (\_5951 _5952-> (let _5953 = _5951 in (case _5953 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5952)); (1,f) -> u f (\_5954-> (let _5955 = (u (u fm_check_result (u maybe_some (u (u _5949 _5933) _5934))) list_nil) in (case _5955 of {(0,f) -> u f (\_5956 _5957-> (u (u fm_check_result _5956) (u (u list_concat _5952) _5957))); }))); }))); }))); (4,f) -> u f (\_5958 _5959-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (5,f) -> u f (\_5960 _5961-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); (6,f) -> u f (\_5962 _5963 _5964-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (7,f) -> u f (\_5965 _5966 _5967-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (8,f) -> u f (\_5968 _5969 _5970-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (9,f) -> u f (\_5971 _5972 _5973-> (let _expected_16=(u either_left "(function type)") in (let _detected_17=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_16) _detected_17) _ctx_4)) list_nil))))); (10,f) -> u f (\_5974-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (11,f) -> u f (\_5975-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (12,f) -> u f (\_5976-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (13,f) -> u f (\_5977-> (let _expected_14=(u either_left "(function type)") in (let _detected_15=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_14) _detected_15) _ctx_4)) list_nil))))); (14,f) -> u f (\_5978 _5979 _5980 _5981 _5982 _5983-> (let _expected_19=(u either_left "(function type)") in (let _detected_20=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_19) _detected_20) _ctx_4)) list_nil))))); (15,f) -> u f (\_5984 _5985-> (let _expected_15=(u either_left "(function type)") in (let _detected_16=(u either_right _func_typ_12) in (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) _expected_15) _detected_16) _ctx_4)) list_nil))))); })) in (case _5940 of {(0,f) -> u f (\_5986 _5987-> (u (u fm_check_result _5986) (u (u list_concat _5937) _5987))); })))); }))); }))); (6,f) -> u f (\_5988 _5989 _5990-> (let _ctx_size_10=(u list_length _ctx_4) in (let _5991 = (u (u (u (u (u (u fm_term_check _5989) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _5991 of {(0,f) -> u f (\_5992 _5993-> (let _5994 = _5992 in (case _5994 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5993)); (1,f) -> u f (\_5995-> (let _body_val_14=(u _5990 (u (u fm_term_var _5988) _ctx_size_10)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _5988) _5995)) _ctx_4) in (let _5996 = (let _5997 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _5997 of {(0,f) -> u f (\_5998 _5999-> (let _6000 = _5998 in (case _6000 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _5999)); (1,f) -> u f (\_6001-> (let _6002 = (u (u fm_check_result (u maybe_some _6001)) list_nil) in (case _6002 of {(0,f) -> u f (\_6003 _6004-> (u (u fm_check_result _6003) (u (u list_concat _5999) _6004))); }))); }))); })) in (case _5996 of {(0,f) -> u f (\_6005 _6006-> (u (u fm_check_result _6005) (u (u list_concat _5993) _6006))); }))))); }))); })))); (7,f) -> u f (\_6007 _6008 _6009-> (let _ctx_size_10=(u list_length _ctx_4) in (let _6010 = (u (u (u (u (u (u fm_term_check _6008) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _6010 of {(0,f) -> u f (\_6011 _6012-> (let _6013 = _6011 in (case _6013 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6012)); (1,f) -> u f (\_6014-> (let _body_val_14=(u _6009 (u (u (u fm_term_ann bool_true) _6008) _6014)) in (let _body_ctx_15=(u (u list_cons (u (u pair_new _6007) _6014)) _ctx_4) in (let _6015 = (let _6016 = (u (u (u (u (u (u fm_term_check _body_val_14) _type_2) _defs_3) _body_ctx_15) (u fm_mpath_i _path_5)) _orig_6) in (case _6016 of {(0,f) -> u f (\_6017 _6018-> (let _6019 = _6017 in (case _6019 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6018)); (1,f) -> u f (\_6020-> (let _6021 = (u (u fm_check_result (u maybe_some _6020)) list_nil) in (case _6021 of {(0,f) -> u f (\_6022 _6023-> (u (u fm_check_result _6022) (u (u list_concat _6018) _6023))); }))); }))); })) in (case _6015 of {(0,f) -> u f (\_6024 _6025-> (u (u fm_check_result _6024) (u (u list_concat _6012) _6025))); }))))); }))); })))); (8,f) -> u f (\_6026 _6027 _6028-> (let _6029 = _6026 in (if _6029 then (u (u fm_check_result (u maybe_some _6028)) list_nil) else (let _6030 = (u (u (u (u (u (u fm_term_check _6027) (u maybe_some _6028)) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _6030 of {(0,f) -> u f (\_6031 _6032-> (let _6033 = _6031 in (case _6033 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6032)); (1,f) -> u f (\_6034-> (let _6035 = (let _6036 = (u (u (u (u (u (u fm_term_check _6028) (u maybe_some fm_term_typ)) _defs_3) _ctx_4) (u fm_mpath_i _path_5)) _orig_6) in (case _6036 of {(0,f) -> u f (\_6037 _6038-> (let _6039 = _6037 in (case _6039 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6038)); (1,f) -> u f (\_6040-> (let _6041 = (u (u fm_check_result (u maybe_some _6028)) list_nil) in (case _6041 of {(0,f) -> u f (\_6042 _6043-> (u (u fm_check_result _6042) (u (u list_concat _6038) _6043))); }))); }))); })) in (case _6035 of {(0,f) -> u f (\_6044 _6045-> (u (u fm_check_result _6044) (u (u list_concat _6032) _6045))); }))); }))); }))))); (9,f) -> u f (\_6046 _6047 _6048-> (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u (u fm_error_show_goal _6046) _6047) _6048) _type_2) _ctx_4)) list_nil))); (10,f) -> u f (\_6049-> (u (u fm_check_result _type_2) list_nil)); (11,f) -> u f (\_6050-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Nat"))) list_nil)); (12,f) -> u f (\_6051-> (u (u fm_check_result (u maybe_some (u fm_term_ref "Char"))) list_nil)); (13,f) -> u f (\_6052-> (u (u fm_check_result (u maybe_some (u fm_term_ref "String"))) list_nil)); (14,f) -> u f (\_6053 _6054 _6055 _6056 _6057 _6058-> (let _expr_13=_6054 in (let _6059 = (u (u (u (u (u (u fm_term_check _expr_13) maybe_none) _defs_3) _ctx_4) (u fm_mpath_o _path_5)) _orig_6) in (case _6059 of {(0,f) -> u f (\_6060 _6061-> (let _6062 = _6060 in (case _6062 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6061)); (1,f) -> u f (\_6063-> (let _dsug_17=(let _6064 = _6058 in (case _6064 of {(0,f) -> u f ((let _moti_17=(let _6065 = _type_2 in (case _6065 of {(0,f) -> u f ((u fm_term_hol bits_e)); (1,f) -> u f (\_6066-> (let _size_18=(u list_length _ctx_4) in (let _typv_19=(u (u fm_term_normalize _6066) map_new) in (let _moti_20=(u (u (u (u (u (u fm_smartmotive_make _6055) _6054) _6063) _typv_19) _size_18) _defs_3) in _moti_20)))); })) in (u maybe_some (u (u (u (u (u (u fm_term_cse _6053) _6054) _6055) _6056) _6057) (u maybe_some _moti_17))))); (1,f) -> u f (\_6067-> (u (u (u (u (u (u (u (u fm_term_desugar_cse _6054) _6055) _6056) _6057) _6067) _6063) _defs_3) _ctx_4)); })) in (let _6068 = (let _6069 = _dsug_17 in (case _6069 of {(0,f) -> u f ((u (u fm_check_result _type_2) (u (u list_cons (u (u (u fm_error_cant_infer _orig_6) _term_1) _ctx_4)) list_nil))); (1,f) -> u f (\_6070-> (u (u fm_check_result _type_2) (u (u list_cons (u (u fm_error_patch (u fm_mpath_to_bits _path_5)) _6070)) list_nil))); })) in (case _6068 of {(0,f) -> u f (\_6071 _6072-> (u (u fm_check_result _6071) (u (u list_concat _6061) _6072))); })))); }))); })))); (15,f) -> u f (\_6073 _6074-> (u (u (u (u (u (u fm_term_check _6074) _type_2) _defs_3) _ctx_4) _path_5) (u maybe_some _6073))); })) in (case _5839 of {(0,f) -> u f (\_6075 _6076-> (let _6077 = _6075 in (case _6077 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6076)); (1,f) -> u f (\_6078-> (let _6079 = (let _6080 = _type_2 in (case _6080 of {(0,f) -> u f ((u (u fm_check_result (u maybe_some _6078)) list_nil)); (1,f) -> u f (\_6081-> (let _6082 = (u (u (u (u (u fm_term_equal _6081) _6078) _defs_3) (u list_length _ctx_4)) (u set_mut_new unit_new)) in (case _6082 of {(0,f) -> u f (\_6083 _6084-> (let _6085 = _6083 in (case _6085 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6084)); (1,f) -> u f (\_6086-> (let _6087 = (let _6088 = _6086 in (if _6088 then (u (u fm_check_result (u maybe_some _6081)) list_nil) else (u (u fm_check_result _type_2) (u (u list_cons (u (u (u (u fm_error_type_mismatch _orig_6) (u either_right _6081)) (u either_right _6078)) _ctx_4)) list_nil)))) in (case _6087 of {(0,f) -> u f (\_6089 _6090-> (u (u fm_check_result _6089) (u (u list_concat _6084) _6090))); }))); }))); }))); })) in (case _6079 of {(0,f) -> u f (\_6091 _6092-> (u (u fm_check_result _6091) (u (u list_concat _6076) _6092))); }))); }))); }))))))))
fm_path_nil = (\_x_1-> _x_1)
fm_mpath_nil = (u maybe_some fm_path_nil)
list_is_empty = (\_list_2-> (let _6093 = _list_2 in (case _6093 of {(0,f) -> u f (bool_true); (1,f) -> u f (\_6094 _6095-> bool_false); })))
fm_term_patch_at = (\_path_1-> (\_term_2-> (\_fn_3-> (let _6096 = _term_2 in (case _6096 of {(0,f) -> u f (\_6097 _6098-> (let _6099 = _path_1 in (case _6099 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6100-> _term_2); (2,f) -> u f (\_6101-> _term_2); }))); (1,f) -> u f (\_6102-> (let _6103 = _path_1 in (case _6103 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6104-> _term_2); (2,f) -> u f (\_6105-> _term_2); }))); (2,f) -> u f ((let _6106 = _path_1 in (case _6106 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6107-> _term_2); (2,f) -> u f (\_6108-> _term_2); }))); (3,f) -> u f (\_6109 _6110 _6111 _6112 _6113-> (let _6114 = _path_1 in (case _6114 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6115-> (u (u (u (u (u fm_term_all _6109) _6110) _6111) (u (u (u fm_term_patch_at _6115) _6112) _fn_3)) _6113)); (2,f) -> u f (\_6116-> (u (u (u (u (u fm_term_all _6109) _6110) _6111) _6112) (\_s_10-> (\_x_11-> (u (u (u fm_term_patch_at _6116) (u (u _6113 _s_10) _x_11)) _fn_3))))); }))); (4,f) -> u f (\_6117 _6118-> (let _6119 = _path_1 in (case _6119 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6120-> (u (u fm_term_lam _6117) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _6118 _x_7)) _fn_3)))); (2,f) -> u f (\_6121-> (u (u fm_term_lam _6117) (\_x_7-> (u (u (u fm_term_patch_at (u bits_tail _path_1)) (u _6118 _x_7)) _fn_3)))); }))); (5,f) -> u f (\_6122 _6123-> (let _6124 = _path_1 in (case _6124 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6125-> (u (u fm_term_app (u (u (u fm_term_patch_at _6125) _6122) _fn_3)) _6123)); (2,f) -> u f (\_6126-> (u (u fm_term_app _6122) (u (u (u fm_term_patch_at _6126) _6123) _fn_3))); }))); (6,f) -> u f (\_6127 _6128 _6129-> (let _6130 = _path_1 in (case _6130 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6131-> (u (u (u fm_term_let _6127) (u (u (u fm_term_patch_at _6131) _6128) _fn_3)) _6129)); (2,f) -> u f (\_6132-> (u (u (u fm_term_let _6127) _6128) (\_x_8-> (u (u (u fm_term_patch_at _6132) (u _6129 _x_8)) _fn_3)))); }))); (7,f) -> u f (\_6133 _6134 _6135-> (let _6136 = _path_1 in (case _6136 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6137-> (u (u (u fm_term_def _6133) (u (u (u fm_term_patch_at _6137) _6134) _fn_3)) _6135)); (2,f) -> u f (\_6138-> (u (u (u fm_term_def _6133) _6134) (\_x_8-> (u (u (u fm_term_patch_at _6138) (u _6135 _x_8)) _fn_3)))); }))); (8,f) -> u f (\_6139 _6140 _6141-> (let _6142 = _path_1 in (case _6142 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6143-> (u (u (u fm_term_ann _6139) (u (u (u fm_term_patch_at _6143) _6140) _fn_3)) _6141)); (2,f) -> u f (\_6144-> (u (u (u fm_term_ann _6139) _6140) (u (u (u fm_term_patch_at _6144) _6141) _fn_3))); }))); (9,f) -> u f (\_6145 _6146 _6147-> (let _6148 = _path_1 in (case _6148 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6149-> _term_2); (2,f) -> u f (\_6150-> _term_2); }))); (10,f) -> u f (\_6151-> (let _6152 = _path_1 in (case _6152 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6153-> _term_2); (2,f) -> u f (\_6154-> _term_2); }))); (11,f) -> u f (\_6155-> (let _6156 = _path_1 in (case _6156 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6157-> _term_2); (2,f) -> u f (\_6158-> _term_2); }))); (12,f) -> u f (\_6159-> (let _6160 = _path_1 in (case _6160 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6161-> _term_2); (2,f) -> u f (\_6162-> _term_2); }))); (13,f) -> u f (\_6163-> (let _6164 = _path_1 in (case _6164 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6165-> _term_2); (2,f) -> u f (\_6166-> _term_2); }))); (14,f) -> u f (\_6167 _6168 _6169 _6170 _6171 _6172-> (let _6173 = _path_1 in (case _6173 of {(0,f) -> u f ((u _fn_3 _term_2)); (1,f) -> u f (\_6174-> _term_2); (2,f) -> u f (\_6175-> _term_2); }))); (15,f) -> u f (\_6176 _6177-> (u (u fm_term_ori _6176) (u (u (u fm_term_patch_at _path_1) _6177) _fn_3))); })))))
fm_synth_fix = (\_file_1-> (\_code_2-> (\_orig_3-> (\_name_4-> (\_term_5-> (\_type_6-> (\_isct_7-> (\_arit_8-> (\_defs_9-> (\_errs_10-> (\_fixd_11-> (let _6178 = _errs_10 in (case _6178 of {(0,f) -> u f ((let _6179 = _fixd_11 in (if _6179 then (let _type_12=(u (u (u fm_term_bind list_nil) (\_x_12-> (u bits_i _x_12))) _type_6) in (let _term_13=(u (u (u fm_term_bind list_nil) (\_x_13-> (u bits_o _x_13))) _term_5) in (let _defs_14=(u (u (u fm_set _name_4) (u (u (u (u (u (u (u (u (u fm_def_new _file_1) _code_2) _orig_3) _name_4) _term_13) _type_12) _isct_7) _arit_8) fm_status_init)) _defs_9) in (u (u io_monad (\_m_bind_15-> (\_m_pure_16-> _m_pure_16))) (u maybe_some _defs_14))))) else (u (u io_monad (\_m_bind_12-> (\_m_pure_13-> _m_pure_13))) maybe_none)))); (1,f) -> u f (\_6180 _6181-> (let _6182 = _6180 in (case _6182 of {(0,f) -> u f (\_6183 _6184 _6185 _6186-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6181) _fixd_11)); (1,f) -> u f (\_6187 _6188 _6189 _6190 _6191-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6181) _fixd_11)); (2,f) -> u f (\_6192-> (u (u (u io_monad (\_m_bind_15-> (\_m_pure_16-> _m_bind_15))) (u (u fm_synth_one _6192) _defs_9)) (\_new_defs_15-> (let _6193 = _new_defs_15 in (case _6193 of {(0,f) -> u f ((u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6181) _fixd_11)); (1,f) -> u f (\_6194-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _6194) _6181) bool_true)); }))))); (3,f) -> u f (\_6195-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6181) _fixd_11)); (4,f) -> u f (\_6196 _6197-> (let _6198 = _6196 in (case _6198 of {(0,f) -> u f ((u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_pure_17))) maybe_none)); (1,f) -> u f (\_6199-> (let _term_17=(u (u (u fm_term_patch_at _6199) _term_5) (\_x_17-> _6197)) in (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_17) _type_6) _isct_7) _arit_8) _defs_9) _6181) bool_true))); (2,f) -> u f (\_6200-> (let _type_17=(u (u (u fm_term_patch_at _6200) _type_6) (\_x_17-> _6197)) in (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_17) _isct_7) _arit_8) _defs_9) _6181) bool_true))); }))); (5,f) -> u f (\_6201 _6202-> (u (u (u io_monad (\_m_bind_16-> (\_m_pure_17-> _m_bind_16))) (u (u fm_synth_one _6202) _defs_9)) (\_new_defs_16-> (let _6203 = _new_defs_16 in (case _6203 of {(0,f) -> u f ((u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6181) _fixd_11)); (1,f) -> u f (\_6204-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _6204) _6181) bool_true)); }))))); (6,f) -> u f (\_6205 _6206 _6207-> (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_1) _code_2) _orig_3) _name_4) _term_5) _type_6) _isct_7) _arit_8) _defs_9) _6181) _fixd_11)); }))); })))))))))))))
fm_status_fail = (\_errors_1-> (3,\t-> t _errors_1))
fm_synth_one = (\_name_1-> (\_defs_2-> (let _6208 = (u (u fm_get _name_1) _defs_2) in (case _6208 of {(0,f) -> u f ((u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u (u fm_synth_load _name_1) _defs_2)) (\_loaded_3-> (let _6209 = _loaded_3 in (case _6209 of {(0,f) -> u f ((u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_pure_5))) maybe_none)); (1,f) -> u f (\_6210-> (u (u fm_synth_one _name_1) _6210)); }))))); (1,f) -> u f (\_6211-> (let _6212 = _6211 in (case _6212 of {(0,f) -> u f (\_6213 _6214 _6215 _6216 _6217 _6218 _6219 _6220 _6221-> (let _file_13=_6213 in (let _code_14=_6214 in (let _orig_15=_6215 in (let _name_16=_6216 in (let _term_17=_6217 in (let _type_18=_6218 in (let _isct_19=_6219 in (let _arit_20=_6220 in (let _stat_21=_6221 in (let _6222 = _stat_21 in (case _6222 of {(0,f) -> u f ((let _defs_22=(u (u (u fm_set _name_16) (u (u (u (u (u (u (u (u (u fm_def_new _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) _arit_20) fm_status_wait)) _defs_2) in (let _checked_23=(let _6223 = (u (u (u (u (u (u fm_term_check _type_18) (u maybe_some fm_term_typ)) _defs_22) list_nil) (u fm_mpath_i fm_mpath_nil)) maybe_none) in (case _6223 of {(0,f) -> u f (\_6224 _6225-> (let _6226 = _6224 in (case _6226 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6225)); (1,f) -> u f (\_6227-> (let _6228 = (let _6229 = (u (u (u (u (u (u fm_term_check _term_17) (u maybe_some _type_18)) _defs_22) list_nil) (u fm_mpath_o fm_mpath_nil)) maybe_none) in (case _6229 of {(0,f) -> u f (\_6230 _6231-> (let _6232 = _6230 in (case _6232 of {(0,f) -> u f ((u (u fm_check_result maybe_none) _6231)); (1,f) -> u f (\_6233-> (let _6234 = (u (u fm_check_result (u maybe_some unit_new)) list_nil) in (case _6234 of {(0,f) -> u f (\_6235 _6236-> (u (u fm_check_result _6235) (u (u list_concat _6231) _6236))); }))); }))); })) in (case _6228 of {(0,f) -> u f (\_6237 _6238-> (u (u fm_check_result _6237) (u (u list_concat _6225) _6238))); }))); }))); })) in (let _6239 = _checked_23 in (case _6239 of {(0,f) -> u f (\_6240 _6241-> (let _6242 = (u list_is_empty _6241) in (if _6242 then (let _defs_26=(u (u (u (u (u (u (u (u (u (u fm_define _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) _arit_20) bool_true) _defs_22) in (u (u io_monad (\_m_bind_27-> (\_m_pure_28-> _m_pure_28))) (u maybe_some _defs_26))) else (u (u (u io_monad (\_m_bind_26-> (\_m_pure_27-> _m_bind_26))) (u (u (u (u (u (u (u (u (u (u (u fm_synth_fix _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) _arit_20) _defs_22) _6241) bool_false)) (\_fixed_26-> (let _6243 = _fixed_26 in (case _6243 of {(0,f) -> u f ((let _stat_27=(u fm_status_fail _6241) in (let _defs_28=(u (u (u fm_set _name_16) (u (u (u (u (u (u (u (u (u fm_def_new _file_13) _code_14) _orig_15) _name_16) _term_17) _type_18) _isct_19) _arit_20) _stat_27)) _defs_22) in (u (u io_monad (\_m_bind_29-> (\_m_pure_30-> _m_pure_30))) (u maybe_some _defs_28))))); (1,f) -> u f (\_6244-> (u (u fm_synth_one _name_16) _6244)); }))))))); }))))); (1,f) -> u f ((u (u io_monad (\_m_bind_22-> (\_m_pure_23-> _m_pure_23))) (u maybe_some _defs_2))); (2,f) -> u f ((u (u io_monad (\_m_bind_22-> (\_m_pure_23-> _m_pure_23))) (u maybe_some _defs_2))); (3,f) -> u f (\_6245-> (u (u io_monad (\_m_bind_23-> (\_m_pure_24-> _m_pure_24))) (u maybe_some _defs_2))); })))))))))))); }))); }))))
map_map = (\_fn_3-> (\_map_4-> (let _6246 = _map_4 in (case _6246 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6247 _6248 _6249-> (let _val_8=(let _6250 = _6247 in (case _6250 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6251-> (u maybe_some (u _fn_3 _6251))); })) in (let _lft_9=(u (u map_map _fn_3) _6248) in (let _rgt_10=(u (u map_map _fn_3) _6249) in (u (u (u map_tie _val_8) _lft_9) _rgt_10))))); }))))
fm_term_inline_names = (let _inl_1=(u (u list_cons "Monad.pure") (u (u list_cons "Monad.bind") (u (u list_cons "Monad.new") (u (u list_cons "Parser.monad") (u (u list_cons "Parser.bind") (u (u list_cons "Parser.pure") (u (u list_cons "Fm.Check.pure") (u (u list_cons "Fm.Check.bind") (u (u list_cons "Fm.Check.monad") (u (u list_cons "Fm.Check.value") (u (u list_cons "Fm.Check.none") list_nil))))))))))) in (let _kvs_2=(u (u list_mapped _inl_1) (\_x_2-> (u (u pair_new (u fm_name_to_bits _x_2)) unit_new))) in (u map_from_list _kvs_2)))
fm_term_inline_reduce = (\_term_1-> (\_defs_2-> (let _6252 = _term_1 in (case _6252 of {(0,f) -> u f (\_6253 _6254-> _term_1); (1,f) -> u f (\_6255-> (let _inli_4=(u (u set_has (u fm_name_to_bits _6255)) fm_term_inline_names) in (let _6256 = _inli_4 in (if _6256 then (let _6257 = (u (u fm_get _6255) _defs_2) in (case _6257 of {(0,f) -> u f ((u fm_term_ref _6255)); (1,f) -> u f (\_6258-> (let _6259 = _6258 in (case _6259 of {(0,f) -> u f (\_6260 _6261 _6262 _6263 _6264 _6265 _6266 _6267 _6268-> (u (u fm_term_inline_reduce _6264) _defs_2)); }))); })) else _term_1)))); (2,f) -> u f (_term_1); (3,f) -> u f (\_6269 _6270 _6271 _6272 _6273-> _term_1); (4,f) -> u f (\_6274 _6275-> _term_1); (5,f) -> u f (\_6276 _6277-> (let _func_5=(u (u fm_term_inline_reduce _6276) _defs_2) in (let _6278 = _func_5 in (case _6278 of {(0,f) -> u f (\_6279 _6280-> _term_1); (1,f) -> u f (\_6281-> _term_1); (2,f) -> u f (_term_1); (3,f) -> u f (\_6282 _6283 _6284 _6285 _6286-> _term_1); (4,f) -> u f (\_6287 _6288-> (u (u fm_term_inline_reduce (u _6288 _6277)) _defs_2)); (5,f) -> u f (\_6289 _6290-> _term_1); (6,f) -> u f (\_6291 _6292 _6293-> (u (u (u fm_term_let _6291) _6292) (\_x_9-> (u (u fm_term_inline_reduce (u (u fm_term_app (u _6293 _x_9)) _6277)) _defs_2)))); (7,f) -> u f (\_6294 _6295 _6296-> _term_1); (8,f) -> u f (\_6297 _6298 _6299-> _term_1); (9,f) -> u f (\_6300 _6301 _6302-> _term_1); (10,f) -> u f (\_6303-> _term_1); (11,f) -> u f (\_6304-> _term_1); (12,f) -> u f (\_6305-> _term_1); (13,f) -> u f (\_6306-> _term_1); (14,f) -> u f (\_6307 _6308 _6309 _6310 _6311 _6312-> _term_1); (15,f) -> u f (\_6313 _6314-> _term_1); })))); (6,f) -> u f (\_6315 _6316 _6317-> _term_1); (7,f) -> u f (\_6318 _6319 _6320-> _term_1); (8,f) -> u f (\_6321 _6322 _6323-> _term_1); (9,f) -> u f (\_6324 _6325 _6326-> _term_1); (10,f) -> u f (\_6327-> _term_1); (11,f) -> u f (\_6328-> _term_1); (12,f) -> u f (\_6329-> _term_1); (13,f) -> u f (\_6330-> _term_1); (14,f) -> u f (\_6331 _6332 _6333 _6334 _6335 _6336-> _term_1); (15,f) -> u f (\_6337 _6338-> (u (u fm_term_inline_reduce _6338) _defs_2)); }))))
fm_term_inline = (\_term_1-> (\_defs_2-> (let _6339 = (u (u fm_term_inline_reduce _term_1) _defs_2) in (case _6339 of {(0,f) -> u f (\_6340 _6341-> (u (u fm_term_var _6340) _6341)); (1,f) -> u f (\_6342-> (u fm_term_ref _6342)); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6343 _6344 _6345 _6346 _6347-> (u (u (u (u (u fm_term_all _6343) _6344) _6345) (u (u fm_term_inline _6346) _defs_2)) (\_s_8-> (\_x_9-> (u (u fm_term_inline (u (u _6347 _s_8) _x_9)) _defs_2))))); (4,f) -> u f (\_6348 _6349-> (u (u fm_term_lam _6348) (\_x_5-> (u (u fm_term_inline (u _6349 _x_5)) _defs_2)))); (5,f) -> u f (\_6350 _6351-> (u (u fm_term_app (u (u fm_term_inline _6350) _defs_2)) (u (u fm_term_inline _6351) _defs_2))); (6,f) -> u f (\_6352 _6353 _6354-> (u (u (u fm_term_let _6352) (u (u fm_term_inline _6353) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6354 _x_6)) _defs_2)))); (7,f) -> u f (\_6355 _6356 _6357-> (u (u (u fm_term_def _6355) (u (u fm_term_inline _6356) _defs_2)) (\_x_6-> (u (u fm_term_inline (u _6357 _x_6)) _defs_2)))); (8,f) -> u f (\_6358 _6359 _6360-> (u (u (u fm_term_ann _6358) (u (u fm_term_inline _6359) _defs_2)) (u (u fm_term_inline _6360) _defs_2))); (9,f) -> u f (\_6361 _6362 _6363-> (u (u (u fm_term_gol _6361) _6362) _6363)); (10,f) -> u f (\_6364-> (u fm_term_hol _6364)); (11,f) -> u f (\_6365-> (u fm_term_nat _6365)); (12,f) -> u f (\_6366-> (u fm_term_chr _6366)); (13,f) -> u f (\_6367-> (u fm_term_str _6367)); (14,f) -> u f (\_6368 _6369 _6370 _6371 _6372 _6373-> _term_1); (15,f) -> u f (\_6374 _6375-> (u (u fm_term_inline _6375) _defs_2)); }))))
map_values_go = (\_xs_2-> (\_list_3-> (let _6376 = _xs_2 in (case _6376 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6377 _6378 _6379-> (let _list0_7=(let _6380 = _6377 in (case _6380 of {(0,f) -> u f (_list_3); (1,f) -> u f (\_6381-> (u (u list_cons _6381) _list_3)); })) in (let _list1_8=(u (u map_values_go _6378) _list0_7) in (let _list2_9=(u (u map_values_go _6379) _list1_8) in _list2_9)))); }))))
map_values = (\_xs_2-> (u (u map_values_go _xs_2) list_nil))
fm_core_var_name = (\_indx_1-> (\_name_2-> (\_brui_3-> (\_vars_4-> (let _6382 = _indx_1 in (if _6382==0 then (let _6383 = _brui_3 in (if _6383==0 then _name_2 else (((_name_2::String) ++ ((("^"::String) ++ (u nat_show _brui_3))))))) else (let _6384 = _vars_4 in (case _6384 of {(0,f) -> u f ("unbound"); (1,f) -> u f (\_6385 _6386-> (let _brui_8=(let _6387 = (((_name_2::String) == _6385)) in (if _6387 then (u nat_succ _brui_3) else _brui_3)) in (u (u (u (u fm_core_var_name (_6382-1)) _name_2) _brui_8) _6386))); }))))))))
fm_name_show = (\_name_1-> _name_1)
bits_to_nat = (\_b_1-> (let _6388 = _b_1 in (case _6388 of {(0,f) -> u f (0); (1,f) -> u f (\_6389-> (((2::Integer) * (u bits_to_nat _6389)))); (2,f) -> u f (\_6390-> (u nat_succ (((2::Integer) * (u bits_to_nat _6390))))); })))
u16_show_hex = (\_a_1-> (let _6391 = _a_1 in (u (u nat_to_string_base 16) (u bits_to_nat (u word_to_bits (u16_to_word _6391))))))
fm_escape_char = (\_chr_1-> (let _6392 = (((_chr_1::Word16) == fm_backslash)) in (if _6392 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6393 = (((_chr_1::Word16) == 34)) in (if _6393 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6394 = (((_chr_1::Word16) == 39)) in (if _6394 then (u (u string_cons fm_backslash) (u (u string_cons _chr_1) string_nil)) else (let _6395 = (u (u (u u16_btw 32) _chr_1) 126) in (if _6395 then (u (u string_cons _chr_1) string_nil) else (u string_flatten (u (u list_cons (u (u string_cons fm_backslash) string_nil)) (u (u list_cons "u{") (u (u list_cons (u u16_show_hex _chr_1)) (u (u list_cons "}") (u (u list_cons string_nil) list_nil)))))))))))))))
fm_escape_go = (\_str_1-> (\_result_2-> (let _6396 = _str_1 in (if null (_6396::String) then (u string_reverse _result_2) else (u (u fm_escape_go (tail _6396)) ((((u string_reverse (u fm_escape_char (fromIntegral (fromEnum (head _6396 :: Char)) :: Word16)))::String) ++ _result_2)))))))
fm_escape = (\_str_1-> (u (u fm_escape_go _str_1) ""))
fm_core_show = (\_term_1-> (\_indx_2-> (\_vars_3-> (let _6397 = _term_1 in (case _6397 of {(0,f) -> u f (\_6398 _6399-> (u (u (u (u fm_core_var_name (u nat_pred (((_indx_2::Integer) - _6399)))) _6398) 0) _vars_3)); (1,f) -> u f (\_6400-> (u fm_name_show _6400)); (2,f) -> u f ("*"); (3,f) -> u f (\_6401 _6402 _6403 _6404 _6405-> (let _eras_9=_6401 in (let _init_10=(let _6406 = _eras_9 in (if _6406 then "%" else "@")) in (let _self_11=(u fm_name_show _6402) in (let _name_12=(u fm_name_show _6403) in (let _xtyp_13=(u (u (u fm_core_show _6404) _indx_2) _vars_3) in (let _body_14=(u (u (u fm_core_show (u (u _6405 (u (u fm_term_var _6402) _indx_2)) (u (u fm_term_var _6403) (u nat_succ _indx_2)))) (u nat_succ (u nat_succ _indx_2))) (u (u list_cons _6403) (u (u list_cons _6402) _vars_3))) in (u string_flatten (u (u list_cons _init_10) (u (u list_cons _self_11) (u (u list_cons "(") (u (u list_cons _name_12) (u (u list_cons ":") (u (u list_cons _xtyp_13) (u (u list_cons ") ") (u (u list_cons _body_14) list_nil)))))))))))))))); (4,f) -> u f (\_6407 _6408-> (let _name_6=(u fm_name_show _6407) in (let _body_7=(u (u (u fm_core_show (u _6408 (u (u fm_term_var _6407) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6407) _vars_3)) in (u string_flatten (u (u list_cons "#") (u (u list_cons _name_6) (u (u list_cons " ") (u (u list_cons _body_7) list_nil)))))))); (5,f) -> u f (\_6409 _6410-> (let _func_6=(u (u (u fm_core_show _6409) _indx_2) _vars_3) in (let _argm_7=(u (u (u fm_core_show _6410) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "(") (u (u list_cons _func_6) (u (u list_cons " ") (u (u list_cons _argm_7) (u (u list_cons ")") list_nil))))))))); (6,f) -> u f (\_6411 _6412 _6413-> (let _name_7=(u fm_name_show _6411) in (let _expr_8=(u (u (u fm_core_show _6412) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_core_show (u _6413 (u (u fm_term_var _6411) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6411) _vars_3)) in (u string_flatten (u (u list_cons "!") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (7,f) -> u f (\_6414 _6415 _6416-> (let _name_7=(u fm_name_show _6414) in (let _expr_8=(u (u (u fm_core_show _6415) _indx_2) _vars_3) in (let _body_9=(u (u (u fm_core_show (u _6416 (u (u fm_term_var _6414) _indx_2))) (u nat_succ _indx_2)) (u (u list_cons _6414) _vars_3)) in (u string_flatten (u (u list_cons "$") (u (u list_cons _name_7) (u (u list_cons " = ") (u (u list_cons _expr_8) (u (u list_cons "; ") (u (u list_cons _body_9) list_nil))))))))))); (8,f) -> u f (\_6417 _6418 _6419-> (let _term_7=(u (u (u fm_core_show _6418) _indx_2) _vars_3) in (let _type_8=(u (u (u fm_core_show _6419) _indx_2) _vars_3) in (u string_flatten (u (u list_cons "{") (u (u list_cons _term_7) (u (u list_cons ":") (u (u list_cons _type_8) (u (u list_cons "}") list_nil))))))))); (9,f) -> u f (\_6420 _6421 _6422-> "<GOL>"); (10,f) -> u f (\_6423-> "<HOL>"); (11,f) -> u f (\_6424-> (u string_flatten (u (u list_cons "+") (u (u list_cons (u nat_show _6424)) list_nil)))); (12,f) -> u f (\_6425-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6425)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6426-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6426)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6427 _6428 _6429 _6430 _6431 _6432-> "<CSE>"); (15,f) -> u f (\_6433 _6434-> (u (u (u fm_core_show _6434) _indx_2) _vars_3)); })))))
fm_defs_core = (\_defs_1-> (let _result_2="" in (let _result_3=(u (u (u list_for (u map_values _defs_1)) _result_2) (\_defn_3-> (\_result_4-> (let _6435 = _defn_3 in (case _6435 of {(0,f) -> u f (\_6436 _6437 _6438 _6439 _6440 _6441 _6442 _6443 _6444-> (let _6445 = _6444 in (case _6445 of {(0,f) -> u f (_result_4); (1,f) -> u f (_result_4); (2,f) -> u f ((let _name_14=_6439 in (let _term_15=(u (u (u fm_core_show _6440) 0) list_nil) in (let _type_16=(u (u (u fm_core_show _6441) 0) list_nil) in (u string_flatten (u (u list_cons _result_4) (u (u list_cons _name_14) (u (u list_cons " : ") (u (u list_cons _type_16) (u (u list_cons " = ") (u (u list_cons _term_15) (u (u list_cons ";\n") list_nil)))))))))))); (3,f) -> u f (\_6446-> _result_4); }))); }))))) in _result_3)))
fm_to_core_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_one _name_1) map_new)) (\_new_defs_2-> (let _defs_3=(let _6447 = _new_defs_2 in (case _6447 of {(0,f) -> u f (map_new); (1,f) -> u f (\_6448-> _6448); })) in (let _defs_4=(u (u map_map (\_defn_4-> (let _6449 = _defn_4 in (case _6449 of {(0,f) -> u f (\_6450 _6451 _6452 _6453 _6454 _6455 _6456 _6457 _6458-> (let _term_14=(u (u fm_term_inline _6454) _defs_3) in (let _type_15=(u (u fm_term_inline _6455) _defs_3) in (u (u (u (u (u (u (u (u (u fm_def_new _6450) _6451) _6452) _6453) _term_14) _type_15) _6456) _6457) _6458)))); })))) _defs_3) in (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_pure_6))) (u fm_defs_core _defs_4)))))))
io_put_string = (\_text_1-> (u (u (u io_ask "put_string") _text_1) (\_skip_2-> (u io_end unit_new))))
io_print = (\_text_1-> (u io_put_string (((_text_1::String) ++ "\n"))))
maybe_bind = (\_m_3-> (\_f_4-> (let _6459 = _m_3 in (case _6459 of {(0,f) -> u f (maybe_none); (1,f) -> u f (\_6460-> (u _f_4 _6460)); }))))
maybe_monad = (\_new_2-> (u (u _new_2 maybe_bind) maybe_some))
fm_term_show_as_nat_go = (\_term_1-> (let _6461 = _term_1 in (case _6461 of {(0,f) -> u f (\_6462 _6463-> maybe_none); (1,f) -> u f (\_6464-> (let _6465 = (((_6464::String) == "Nat.zero")) in (if _6465 then (u maybe_some 0) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6466 _6467 _6468 _6469 _6470-> maybe_none); (4,f) -> u f (\_6471 _6472-> maybe_none); (5,f) -> u f (\_6473 _6474-> (let _6475 = _6473 in (case _6475 of {(0,f) -> u f (\_6476 _6477-> maybe_none); (1,f) -> u f (\_6478-> (let _6479 = (((_6478::String) == "Nat.succ")) in (if _6479 then (u (u (u maybe_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u fm_term_show_as_nat_go _6474)) (\_pred_5-> (u (u maybe_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u nat_succ _pred_5)))) else maybe_none))); (2,f) -> u f (maybe_none); (3,f) -> u f (\_6480 _6481 _6482 _6483 _6484-> maybe_none); (4,f) -> u f (\_6485 _6486-> maybe_none); (5,f) -> u f (\_6487 _6488-> maybe_none); (6,f) -> u f (\_6489 _6490 _6491-> maybe_none); (7,f) -> u f (\_6492 _6493 _6494-> maybe_none); (8,f) -> u f (\_6495 _6496 _6497-> maybe_none); (9,f) -> u f (\_6498 _6499 _6500-> maybe_none); (10,f) -> u f (\_6501-> maybe_none); (11,f) -> u f (\_6502-> maybe_none); (12,f) -> u f (\_6503-> maybe_none); (13,f) -> u f (\_6504-> maybe_none); (14,f) -> u f (\_6505 _6506 _6507 _6508 _6509 _6510-> maybe_none); (15,f) -> u f (\_6511 _6512-> maybe_none); }))); (6,f) -> u f (\_6513 _6514 _6515-> maybe_none); (7,f) -> u f (\_6516 _6517 _6518-> maybe_none); (8,f) -> u f (\_6519 _6520 _6521-> maybe_none); (9,f) -> u f (\_6522 _6523 _6524-> maybe_none); (10,f) -> u f (\_6525-> maybe_none); (11,f) -> u f (\_6526-> maybe_none); (12,f) -> u f (\_6527-> maybe_none); (13,f) -> u f (\_6528-> maybe_none); (14,f) -> u f (\_6529 _6530 _6531 _6532 _6533 _6534-> maybe_none); (15,f) -> u f (\_6535 _6536-> maybe_none); })))
fm_term_show_as_nat = (\_term_1-> (u (u maybe_mapped (u fm_term_show_as_nat_go _term_1)) nat_show))
fm_term_show_is_ref = (\_term_1-> (\_name_2-> (let _6537 = _term_1 in (case _6537 of {(0,f) -> u f (\_6538 _6539-> bool_false); (1,f) -> u f (\_6540-> (((_name_2::String) == _6540))); (2,f) -> u f (bool_false); (3,f) -> u f (\_6541 _6542 _6543 _6544 _6545-> bool_false); (4,f) -> u f (\_6546 _6547-> bool_false); (5,f) -> u f (\_6548 _6549-> bool_false); (6,f) -> u f (\_6550 _6551 _6552-> bool_false); (7,f) -> u f (\_6553 _6554 _6555-> bool_false); (8,f) -> u f (\_6556 _6557 _6558-> bool_false); (9,f) -> u f (\_6559 _6560 _6561-> bool_false); (10,f) -> u f (\_6562-> bool_false); (11,f) -> u f (\_6563-> bool_false); (12,f) -> u f (\_6564-> bool_false); (13,f) -> u f (\_6565-> bool_false); (14,f) -> u f (\_6566 _6567 _6568 _6569 _6570 _6571-> bool_false); (15,f) -> u f (\_6572 _6573-> bool_false); }))))
fm_term_show_app_done = (\_term_1-> (\_path_2-> (\_args_3-> (let _arity_4=(u list_length _args_3) in (let _6574 = (((u (u fm_term_show_is_ref _term_1) "Equal") && (((_arity_4::Integer) == 3)))) in (if _6574 then (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _eq_lft_6=(u (u maybe_default "?") (u (u list_at 1) _args_3)) in (let _eq_rgt_7=(u (u maybe_default "?") (u (u list_at 2) _args_3)) in (u string_flatten (u (u list_cons _eq_lft_6) (u (u list_cons " == ") (u (u list_cons _eq_rgt_7) list_nil))))))) else (let _func_5=(u (u fm_term_show_go _term_1) _path_2) in (let _wrap_6=(let _6575 = _func_5 in (if null (_6575::String) then bool_false else ((((fromIntegral (fromEnum (head _6575 :: Char)) :: Word16)::Word16) == 40)))) in (let _args_7=(u (u string_join ",") _args_3) in (let _func_8=(let _6576 = _wrap_6 in (if _6576 then (u string_flatten (u (u list_cons "(") (u (u list_cons _func_5) (u (u list_cons ")") list_nil)))) else _func_5)) in (u string_flatten (u (u list_cons _func_8) (u (u list_cons "(") (u (u list_cons _args_7) (u (u list_cons ")") list_nil)))))))))))))))
fm_term_show_app = (\_term_1-> (\_path_2-> (\_args_3-> (let _6577 = _term_1 in (case _6577 of {(0,f) -> u f (\_6578 _6579-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (1,f) -> u f (\_6580-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (2,f) -> u f ((u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (3,f) -> u f (\_6581 _6582 _6583 _6584 _6585-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (4,f) -> u f (\_6586 _6587-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (5,f) -> u f (\_6588 _6589-> (u (u (u fm_term_show_app _6588) (u fm_mpath_o _path_2)) (u (u list_cons (u (u fm_term_show_go _6589) (u fm_mpath_i _path_2))) _args_3))); (6,f) -> u f (\_6590 _6591 _6592-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (7,f) -> u f (\_6593 _6594 _6595-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (8,f) -> u f (\_6596 _6597 _6598-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (9,f) -> u f (\_6599 _6600 _6601-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (10,f) -> u f (\_6602-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (11,f) -> u f (\_6603-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (12,f) -> u f (\_6604-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (13,f) -> u f (\_6605-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (14,f) -> u f (\_6606 _6607 _6608 _6609 _6610 _6611-> (u (u (u fm_term_show_app_done _term_1) _path_2) _args_3)); (15,f) -> u f (\_6612 _6613-> (u (u (u fm_term_show_app _6613) _path_2) _args_3)); })))))
map_to_list_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6614 = _xs_2 in (case _6614 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6615 _6616 _6617-> (let _list0_8=(let _6618 = _6615 in (case _6618 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6619-> (u (u list_cons (u (u pair_new (u bits_reverse _key_3)) _6619)) _list_4)); })) in (let _list1_9=(u (u (u map_to_list_go _6616) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_to_list_go _6617) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_to_list = (\_xs_2-> (u list_reverse (u (u (u map_to_list_go _xs_2) bits_e) list_nil)))
bits_chunks_of_go = (\_len_1-> (\_bits_2-> (\_need_3-> (\_chunk_4-> (let _6620 = _bits_2 in (case _6620 of {(0,f) -> u f ((u (u list_cons (u bits_reverse _chunk_4)) list_nil)); (1,f) -> u f (\_6621-> (let _6622 = _need_3 in (if _6622==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_o _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6621) (_6622-1)) _chunk_7))))); (2,f) -> u f (\_6623-> (let _6624 = _need_3 in (if _6624==0 then (let _head_6=(u bits_reverse _chunk_4) in (let _tail_7=(u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e) in (u (u list_cons _head_6) _tail_7))) else (let _chunk_7=(u bits_i _chunk_4) in (u (u (u (u bits_chunks_of_go _len_1) _6623) (_6624-1)) _chunk_7))))); }))))))
bits_chunks_of = (\_len_1-> (\_bits_2-> (u (u (u (u bits_chunks_of_go _len_1) _bits_2) _len_1) bits_e)))
word_from_bits = (\_size_1-> (\_bits_2-> (let _6625 = _size_1 in (if _6625==0 then word_e else (let _6626 = _bits_2 in (case _6626 of {(0,f) -> u f ((u word_o (u (u word_from_bits (_6625-1)) bits_e))); (1,f) -> u f (\_6627-> (u word_o (u (u word_from_bits (_6625-1)) _6627))); (2,f) -> u f (\_6628-> (u word_i (u (u word_from_bits (_6625-1)) _6628))); }))))))
fm_name_from_bits = (\_bits_1-> (let _list_2=(u (u bits_chunks_of 6) _bits_1) in (let _name_3=(u (u (u list_fold _list_2) string_nil) (\_bts_3-> (\_name_4-> (let _u16_5=(u u16_new (u (u word_from_bits 16) (u bits_reverse _bts_3))) in (let _chr_6=(let _6629 = (u (u (u u16_btw 0) _u16_5) 25) in (if _6629 then (((_u16_5::Word16) + 65)) else (let _6630 = (u (u (u u16_btw 26) _u16_5) 51) in (if _6630 then (((_u16_5::Word16) + 71)) else (let _6631 = (u (u (u u16_btw 52) _u16_5) 61) in (if _6631 then (((_u16_5::Word16) - 4)) else (let _6632 = (((62::Word16) == _u16_5)) in (if _6632 then 46 else 95)))))))) in (u (u string_cons _chr_6) _name_4)))))) in _name_3)))
fm_term_show_go = (\_term_1-> (\_path_2-> (let _6633 = (u fm_term_show_as_nat _term_1) in (case _6633 of {(0,f) -> u f ((let _6634 = _term_1 in (case _6634 of {(0,f) -> u f (\_6635 _6636-> (u fm_name_show _6635)); (1,f) -> u f (\_6637-> (let _name_4=(u fm_name_show _6637) in (let _6638 = _path_2 in (case _6638 of {(0,f) -> u f (_name_4); (1,f) -> u f (\_6639-> (let _path_val_6=(u (u bits_concat (u fm_path_to_bits _6639)) (u bits_i bits_e)) in (let _path_str_7=(u nat_show (u bits_to_nat _path_val_6)) in (u string_flatten (u (u list_cons _name_4) (u (u list_cons (u (u fm_color "2") ((("-"::String) ++ _path_str_7)))) list_nil)))))); })))); (2,f) -> u f ("Type"); (3,f) -> u f (\_6640 _6641 _6642 _6643 _6644-> (let _eras_8=_6640 in (let _self_9=(u fm_name_show _6641) in (let _name_10=(u fm_name_show _6642) in (let _type_11=(u (u fm_term_show_go _6643) (u fm_mpath_o _path_2)) in (let _open_12=(let _6645 = _eras_8 in (if _6645 then "<" else "(")) in (let _clos_13=(let _6646 = _eras_8 in (if _6646 then ">" else ")")) in (let _body_14=(u (u fm_term_show_go (u (u _6644 (u (u fm_term_var _6641) 0)) (u (u fm_term_var _6642) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _self_9) (u (u list_cons _open_12) (u (u list_cons _name_10) (u (u list_cons ":") (u (u list_cons _type_11) (u (u list_cons _clos_13) (u (u list_cons " ") (u (u list_cons _body_14) list_nil))))))))))))))))); (4,f) -> u f (\_6647 _6648-> (let _name_5=(u fm_name_show _6647) in (let _body_6=(u (u fm_term_show_go (u _6648 (u (u fm_term_var _6647) 0))) (u fm_mpath_o _path_2)) in (u string_flatten (u (u list_cons "(") (u (u list_cons _name_5) (u (u list_cons ") ") (u (u list_cons _body_6) list_nil)))))))); (5,f) -> u f (\_6649 _6650-> (u (u (u fm_term_show_app _term_1) _path_2) list_nil)); (6,f) -> u f (\_6651 _6652 _6653-> (let _name_6=(u fm_name_show _6651) in (let _expr_7=(u (u fm_term_show_go _6652) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6653 (u (u fm_term_var _6651) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "let ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (7,f) -> u f (\_6654 _6655 _6656-> (let _name_6=(u fm_name_show _6654) in (let _expr_7=(u (u fm_term_show_go _6655) (u fm_mpath_o _path_2)) in (let _body_8=(u (u fm_term_show_go (u _6656 (u (u fm_term_var _6654) 0))) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons "def ") (u (u list_cons _name_6) (u (u list_cons " = ") (u (u list_cons _expr_7) (u (u list_cons "; ") (u (u list_cons _body_8) list_nil))))))))))); (8,f) -> u f (\_6657 _6658 _6659-> (let _term_6=(u (u fm_term_show_go _6658) (u fm_mpath_o _path_2)) in (let _type_7=(u (u fm_term_show_go _6659) (u fm_mpath_i _path_2)) in (u string_flatten (u (u list_cons _term_6) (u (u list_cons "::") (u (u list_cons _type_7) list_nil))))))); (9,f) -> u f (\_6660 _6661 _6662-> (let _name_6=(u fm_name_show _6660) in (u string_flatten (u (u list_cons "?") (u (u list_cons _name_6) list_nil))))); (10,f) -> u f (\_6663-> "_"); (11,f) -> u f (\_6664-> (u string_flatten (u (u list_cons (u nat_show _6664)) list_nil))); (12,f) -> u f (\_6665-> (u string_flatten (u (u list_cons "'") (u (u list_cons (u fm_escape_char _6665)) (u (u list_cons "'") list_nil))))); (13,f) -> u f (\_6666-> (u string_flatten (u (u list_cons "\"") (u (u list_cons (u fm_escape _6666)) (u (u list_cons "\"") list_nil))))); (14,f) -> u f (\_6667 _6668 _6669 _6670 _6671 _6672-> (let _expr_9=(u (u fm_term_show_go _6668) (u fm_mpath_o _path_2)) in (let _name_10=(u fm_name_show _6669) in (let _wyth_11=(u (u string_join "") (u (u list_mapped _6670) (\_defn_11-> (let _6673 = _defn_11 in (case _6673 of {(0,f) -> u f (\_6674 _6675 _6676 _6677 _6678 _6679 _6680 _6681 _6682-> (let _name_21=(u fm_name_show _6677) in (let _type_22=(u (u fm_term_show_go _6679) maybe_none) in (let _term_23=(u (u fm_term_show_go _6678) maybe_none) in (u string_flatten (u (u list_cons _name_21) (u (u list_cons ": ") (u (u list_cons _type_22) (u (u list_cons " = ") (u (u list_cons _term_23) (u (u list_cons ";") list_nil))))))))))); }))))) in (let _cses_12=(u map_to_list _6671) in (let _cses_13=(u (u string_join "") (u (u list_mapped _cses_12) (\_x_13-> (let _name_14=(u fm_name_from_bits (u pair_fst _x_13)) in (let _term_15=(u (u fm_term_show_go (u pair_snd _x_13)) maybe_none) in (u string_flatten (u (u list_cons _name_14) (u (u list_cons ": ") (u (u list_cons _term_15) (u (u list_cons "; ") list_nil)))))))))) in (let _moti_14=(let _6683 = _6672 in (case _6683 of {(0,f) -> u f (""); (1,f) -> u f (\_6684-> (u string_flatten (u (u list_cons ": ") (u (u list_cons (u (u fm_term_show_go _6684) maybe_none)) list_nil)))); })) in (u string_flatten (u (u list_cons "case ") (u (u list_cons _expr_9) (u (u list_cons " as ") (u (u list_cons _name_10) (u (u list_cons _wyth_11) (u (u list_cons " { ") (u (u list_cons _cses_13) (u (u list_cons "}") (u (u list_cons _moti_14) list_nil))))))))))))))))); (15,f) -> u f (\_6685 _6686-> (u (u fm_term_show_go _6686) _path_2)); }))); (1,f) -> u f (\_6687-> _6687); }))))
fm_term_show = (\_term_1-> (u (u fm_term_show_go _term_1) maybe_none))
fm_defs_report_types = (\_defs_1-> (\_names_2-> (let _types_3="" in (let _types_4=(u (u (u list_for _names_2) _types_3) (\_name_4-> (\_types_5-> (let _6688 = (u (u fm_get _name_4) _defs_1) in (case _6688 of {(0,f) -> u f (_types_5); (1,f) -> u f (\_6689-> (let _6690 = _6689 in (case _6690 of {(0,f) -> u f (\_6691 _6692 _6693 _6694 _6695 _6696 _6697 _6698 _6699-> (((_types_5::String) ++ (((_name_4::String) ++ (((": "::String) ++ ((((u fm_term_show _6696)::String) ++ "\n"))))))))); }))); }))))) in _types_4))))
map_keys_go = (\_xs_2-> (\_key_3-> (\_list_4-> (let _6700 = _xs_2 in (case _6700 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6701 _6702 _6703-> (let _list0_8=(let _6704 = _6701 in (case _6704 of {(0,f) -> u f (_list_4); (1,f) -> u f (\_6705-> (u (u list_cons (u bits_reverse _key_3)) _list_4)); })) in (let _list1_9=(u (u (u map_keys_go _6702) (u bits_o _key_3)) _list0_8) in (let _list2_10=(u (u (u map_keys_go _6703) (u bits_i _key_3)) _list1_9) in _list2_10)))); })))))
map_keys = (\_xs_2-> (u list_reverse (u (u (u map_keys_go _xs_2) bits_e) list_nil)))
fm_error_relevant = (\_errors_1-> (\_got_2-> (let _6706 = _errors_1 in (case _6706 of {(0,f) -> u f (list_nil); (1,f) -> u f (\_6707 _6708-> (let _keep_5=(let _6709 = _6707 in (case _6709 of {(0,f) -> u f (\_6710 _6711 _6712 _6713-> ((not _got_2))); (1,f) -> u f (\_6714 _6715 _6716 _6717 _6718-> bool_true); (2,f) -> u f (\_6719-> bool_false); (3,f) -> u f (\_6720-> bool_false); (4,f) -> u f (\_6721 _6722-> bool_false); (5,f) -> u f (\_6723 _6724-> ((not _got_2))); (6,f) -> u f (\_6725 _6726 _6727-> ((not _got_2))); })) in (let _got_6=(let _6728 = _6707 in (case _6728 of {(0,f) -> u f (\_6729 _6730 _6731 _6732-> bool_true); (1,f) -> u f (\_6733 _6734 _6735 _6736 _6737-> _got_2); (2,f) -> u f (\_6738-> _got_2); (3,f) -> u f (\_6739-> _got_2); (4,f) -> u f (\_6740 _6741-> _got_2); (5,f) -> u f (\_6742 _6743-> bool_true); (6,f) -> u f (\_6744 _6745 _6746-> _got_2); })) in (let _tail_7=(u (u fm_error_relevant _6708) _got_6) in (let _6747 = _keep_5 in (if _6747 then (u (u list_cons _6707) _tail_7) else _tail_7)))))); }))))
fm_context_show = (\_context_1-> (let _6748 = _context_1 in (case _6748 of {(0,f) -> u f (""); (1,f) -> u f (\_6749 _6750-> (let _6751 = _6749 in (case _6751 of {(0,f) -> u f (\_6752 _6753-> (let _name_6=(u fm_name_show _6752) in (let _type_7=(u fm_term_show (u (u fm_term_normalize _6753) map_new)) in (let _rest_8=(u fm_context_show _6750) in (u string_flatten (u (u list_cons _rest_8) (u (u list_cons "- ") (u (u list_cons _name_6) (u (u list_cons ": ") (u (u list_cons _type_7) (u (u list_cons "\n") list_nil))))))))))); }))); })))
fm_term_expand_at = (\_path_1-> (\_term_2-> (\_defs_3-> (u (u (u fm_term_patch_at _path_1) _term_2) (\_term_4-> (let _6754 = _term_4 in (case _6754 of {(0,f) -> u f (\_6755 _6756-> _term_4); (1,f) -> u f (\_6757-> (let _6758 = (u (u fm_get _6757) _defs_3) in (case _6758 of {(0,f) -> u f ((u fm_term_ref _6757)); (1,f) -> u f (\_6759-> (let _6760 = _6759 in (case _6760 of {(0,f) -> u f (\_6761 _6762 _6763 _6764 _6765 _6766 _6767 _6768 _6769-> _6765); }))); }))); (2,f) -> u f (_term_4); (3,f) -> u f (\_6770 _6771 _6772 _6773 _6774-> _term_4); (4,f) -> u f (\_6775 _6776-> _term_4); (5,f) -> u f (\_6777 _6778-> _term_4); (6,f) -> u f (\_6779 _6780 _6781-> _term_4); (7,f) -> u f (\_6782 _6783 _6784-> _term_4); (8,f) -> u f (\_6785 _6786 _6787-> _term_4); (9,f) -> u f (\_6788 _6789 _6790-> _term_4); (10,f) -> u f (\_6791-> _term_4); (11,f) -> u f (\_6792-> _term_4); (12,f) -> u f (\_6793-> _term_4); (13,f) -> u f (\_6794-> _term_4); (14,f) -> u f (\_6795 _6796 _6797 _6798 _6799 _6800-> _term_4); (15,f) -> u f (\_6801 _6802-> _term_4); })))))))
fm_term_expand_ct = (\_term_1-> (\_defs_2-> (\_arity_3-> (let _6803 = _term_1 in (case _6803 of {(0,f) -> u f (\_6804 _6805-> (u (u fm_term_var _6804) _6805)); (1,f) -> u f (\_6806-> (let _6807 = (u (u fm_get _6806) _defs_2) in (case _6807 of {(0,f) -> u f ((u fm_term_ref _6806)); (1,f) -> u f (\_6808-> (let _6809 = _6808 in (case _6809 of {(0,f) -> u f (\_6810 _6811 _6812 _6813 _6814 _6815 _6816 _6817 _6818-> (let _6819 = ((_6816 && (((_arity_3::Integer) > _6817)))) in (if _6819 then _6814 else (u fm_term_ref _6806)))); }))); }))); (2,f) -> u f (fm_term_typ); (3,f) -> u f (\_6820 _6821 _6822 _6823 _6824-> (u (u (u (u (u fm_term_all _6820) _6821) _6822) (u (u (u fm_term_expand_ct _6823) _defs_2) 0)) (\_s_9-> (\_x_10-> (u (u (u fm_term_expand_ct (u (u _6824 _s_9) _x_10)) _defs_2) 0))))); (4,f) -> u f (\_6825 _6826-> (u (u fm_term_lam _6825) (\_x_6-> (u (u (u fm_term_expand_ct (u _6826 _x_6)) _defs_2) 0)))); (5,f) -> u f (\_6827 _6828-> (u (u fm_term_app (u (u (u fm_term_expand_ct _6827) _defs_2) (u nat_succ _arity_3))) (u (u (u fm_term_expand_ct _6828) _defs_2) 0))); (6,f) -> u f (\_6829 _6830 _6831-> (u (u (u fm_term_let _6829) (u (u (u fm_term_expand_ct _6830) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6831 _x_7)) _defs_2) 0)))); (7,f) -> u f (\_6832 _6833 _6834-> (u (u (u fm_term_def _6832) (u (u (u fm_term_expand_ct _6833) _defs_2) 0)) (\_x_7-> (u (u (u fm_term_expand_ct (u _6834 _x_7)) _defs_2) 0)))); (8,f) -> u f (\_6835 _6836 _6837-> (u (u (u fm_term_ann _6835) (u (u (u fm_term_expand_ct _6836) _defs_2) 0)) (u (u (u fm_term_expand_ct _6837) _defs_2) 0))); (9,f) -> u f (\_6838 _6839 _6840-> (u (u (u fm_term_gol _6838) _6839) _6840)); (10,f) -> u f (\_6841-> (u fm_term_hol _6841)); (11,f) -> u f (\_6842-> (u fm_term_nat _6842)); (12,f) -> u f (\_6843-> (u fm_term_chr _6843)); (13,f) -> u f (\_6844-> (u fm_term_str _6844)); (14,f) -> u f (\_6845 _6846 _6847 _6848 _6849 _6850-> _term_1); (15,f) -> u f (\_6851 _6852-> (u (u fm_term_ori _6851) _6852)); })))))
fm_term_expand = (\_dref_1-> (\_term_2-> (\_defs_3-> (let _term_4=(u (u fm_term_normalize _term_2) map_new) in (let _term_5=(u (u (u list_for _dref_1) _term_4) (\_path_5-> (\_term_6-> (let _term_7=(u (u (u fm_term_expand_at _path_5) _term_6) _defs_3) in (let _term_8=(u (u fm_term_normalize _term_7) map_new) in (let _term_9=(u (u (u fm_term_expand_ct _term_8) _defs_3) 0) in (let _term_10=(u (u fm_term_normalize _term_9) map_new) in _term_10))))))) in _term_5)))))
fm_error_show = (\_error_1-> (\_defs_2-> (let _6853 = _error_1 in (case _6853 of {(0,f) -> u f (\_6854 _6855 _6856 _6857-> (let _expected_7=(let _6858 = _6855 in (case _6858 of {(0,f) -> u f (\_6859-> _6859); (1,f) -> u f (\_6860-> (u fm_term_show (u (u fm_term_normalize _6860) map_new))); })) in (let _detected_8=(let _6861 = _6856 in (case _6861 of {(0,f) -> u f (\_6862-> _6862); (1,f) -> u f (\_6863-> (u fm_term_show (u (u fm_term_normalize _6863) map_new))); })) in (u string_flatten (u (u list_cons "Type mismatch.\n") (u (u list_cons "- Expected: ") (u (u list_cons _expected_7) (u (u list_cons "\n") (u (u list_cons "- Detected: ") (u (u list_cons _detected_8) (u (u list_cons "\n") (u (u list_cons (let _6864 = _6857 in (case _6864 of {(0,f) -> u f (""); (1,f) -> u f (\_6865 _6866-> (u string_flatten (u (u list_cons "With context:\n") (u (u list_cons (u fm_context_show _6857)) list_nil)))); }))) list_nil)))))))))))); (1,f) -> u f (\_6867 _6868 _6869 _6870 _6871-> (let _goal_name_8=(u string_flatten (u (u list_cons "Goal ?") (u (u list_cons (u fm_name_show _6867)) (u (u list_cons ":\n") list_nil)))) in (let _with_type_9=(let _6872 = _6870 in (case _6872 of {(0,f) -> u f (""); (1,f) -> u f (\_6873-> (let _goal_10=(u (u (u fm_term_expand _6868) _6873) _defs_2) in (u string_flatten (u (u list_cons "With type: ") (u (u list_cons (let _6874 = _6869 in (if _6874 then (u (u fm_term_show_go _goal_10) (u maybe_some (\_x_11-> _x_11))) else (u fm_term_show _goal_10)))) (u (u list_cons "\n") list_nil)))))); })) in (let _with_ctxt_10=(let _6875 = _6871 in (case _6875 of {(0,f) -> u f (""); (1,f) -> u f (\_6876 _6877-> (u string_flatten (u (u list_cons "With ctxt:\n") (u (u list_cons (u fm_context_show _6871)) list_nil)))); })) in (u string_flatten (u (u list_cons _goal_name_8) (u (u list_cons _with_type_9) (u (u list_cons _with_ctxt_10) list_nil)))))))); (2,f) -> u f (\_6878-> (u string_flatten (u (u list_cons "Waiting for '") (u (u list_cons _6878) (u (u list_cons "'.") list_nil))))); (3,f) -> u f (\_6879-> (u string_flatten (u (u list_cons "Error on dependency '") (u (u list_cons _6879) (u (u list_cons "'.") list_nil))))); (4,f) -> u f (\_6880 _6881-> (u string_flatten (u (u list_cons "Patching: ") (u (u list_cons (u fm_term_show _6881)) list_nil)))); (5,f) -> u f (\_6882 _6883-> (u string_flatten (u (u list_cons "Undefined reference: ") (u (u list_cons (u fm_name_show _6883)) (u (u list_cons "\n") list_nil))))); (6,f) -> u f (\_6884 _6885 _6886-> (let _term_6=(u fm_term_show _6885) in (let _context_7=(u fm_context_show _6886) in (u string_flatten (u (u list_cons "Can't infer type of: ") (u (u list_cons _term_6) (u (u list_cons "\n") (u (u list_cons "With ctxt:\n") (u (u list_cons _context_7) list_nil))))))))); }))))
fm_error_origin = (\_error_1-> (let _6887 = _error_1 in (case _6887 of {(0,f) -> u f (\_6888 _6889 _6890 _6891-> _6888); (1,f) -> u f (\_6892 _6893 _6894 _6895 _6896-> maybe_none); (2,f) -> u f (\_6897-> maybe_none); (3,f) -> u f (\_6898-> maybe_none); (4,f) -> u f (\_6899 _6900-> maybe_none); (5,f) -> u f (\_6901 _6902-> _6901); (6,f) -> u f (\_6903 _6904 _6905-> _6903); })))
fm_defs_report_errors = (\_defs_1-> (let _errors_2="" in (let _errors_3=(u (u (u list_for (u map_keys _defs_1)) _errors_2) (\_key_3-> (\_errors_4-> (let _name_5=(u fm_name_from_bits _key_3) in (let _6906 = (u (u fm_get _name_5) _defs_1) in (case _6906 of {(0,f) -> u f (_errors_4); (1,f) -> u f (\_6907-> (let _6908 = _6907 in (case _6908 of {(0,f) -> u f (\_6909 _6910 _6911 _6912 _6913 _6914 _6915 _6916 _6917-> (let _6918 = _6917 in (case _6918 of {(0,f) -> u f (_errors_4); (1,f) -> u f (_errors_4); (2,f) -> u f (_errors_4); (3,f) -> u f (\_6919-> (let _6920 = _6919 in (case _6920 of {(0,f) -> u f (_errors_4); (1,f) -> u f (\_6921 _6922-> (let _name_str_19=_6912 in (let _rel_errs_20=(u (u fm_error_relevant _6919) bool_false) in (let _errors_21=(u (u (u list_for _rel_errs_20) _errors_4) (\_err_21-> (\_errors_22-> (let _err_msg_23=(u (u fm_error_show _err_21) _defs_1) in (let _ori_msg_24=(let _6923 = (u fm_error_origin _err_21) in (case _6923 of {(0,f) -> u f (""); (1,f) -> u f (\_6924-> (let _6925 = _6924 in (case _6925 of {(0,f) -> u f (\_6926 _6927-> (let _inside_27=((("Inside '"::String) ++ (((_6909::String) ++ "':\n")))) in (let _source_28=(u (u (u fm_highlight _6910) _6926) _6927) in (((_inside_27::String) ++ (((_source_28::String) ++ "\n"))))))); }))); })) in (((_errors_22::String) ++ (((_err_msg_23::String) ++ (((_ori_msg_24::String) ++ "\n"))))))))))) in _errors_21)))); }))); }))); }))); })))))) in _errors_3)))
fm_defs_report = (\_defs_1-> (\_names_2-> (let _types_3=(u (u fm_defs_report_types _defs_1) _names_2) in (let _errors_4=(u fm_defs_report_errors _defs_1) in (let _errors_5=(let _6928 = _errors_4 in (if null (_6928::String) then "All terms check." else _errors_4)) in (((_types_3::String) ++ ((("\n"::String) ++ _errors_5)))))))))
fm_checker_io_one = (\_name_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_one _name_1) map_new)) (\_new_defs_2-> (let _6929 = _new_defs_2 in (case _6929 of {(0,f) -> u f ((let _notfound_3=((("Term not found: '"::String) ++ (((_name_1::String) ++ "'.")))) in (let _filelist_4=(u (u list_mapped (u fm_synth_files_of _name_1)) (\_x_4-> ((("'"::String) ++ (((_x_4::String) ++ "'")))))) in (let _searched_5=((("Searched on: "::String) ++ ((((u (u string_join ", ") _filelist_4)::String) ++ ".")))) in (u io_print (((_notfound_3::String) ++ ((("\n"::String) ++ _searched_5))))))))); (1,f) -> u f (\_6930-> (u io_print (u (u fm_defs_report _6930) (u (u list_cons _name_1) list_nil)))); })))))
fm_synth_many = (\_names_1-> (\_defs_2-> (let _6931 = _names_1 in (case _6931 of {(0,f) -> u f ((u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_pure_4))) _defs_2)); (1,f) -> u f (\_6932 _6933-> (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u fm_synth_one _6932) _defs_2)) (\_new_defs_5-> (let _6934 = _new_defs_5 in (case _6934 of {(0,f) -> u f ((u (u fm_synth_many _6933) _defs_2)); (1,f) -> u f (\_6935-> (u (u fm_synth_many _6933) _6935)); }))))); }))))
fm_synth_file = (\_file_1-> (\_defs_2-> (u (u (u io_monad (\_m_bind_3-> (\_m_pure_4-> _m_bind_3))) (u io_get_file _file_1)) (\_code_3-> (let _read_4=(u (u (u fm_defs_read _file_1) _code_3) _defs_2) in (let _6936 = _read_4 in (case _6936 of {(0,f) -> u f (\_6937-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u either_left _6937))); (1,f) -> u f (\_6938-> (let _file_defs_6=_6938 in (let _file_keys_7=(u map_keys _file_defs_6) in (let _file_nams_8=(u (u list_mapped _file_keys_7) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_9-> (\_m_pure_10-> _m_bind_9))) (u (u fm_synth_many _file_nams_8) _file_defs_6)) (\_defs_9-> (u (u io_monad (\_m_bind_10-> (\_m_pure_11-> _m_pure_11))) (u either_right (u (u pair_new _file_nams_8) _defs_9))))))))); })))))))
fm_checker_io_file = (\_file_1-> (u (u (u io_monad (\_m_bind_2-> (\_m_pure_3-> _m_bind_2))) (u (u fm_synth_file _file_1) map_new)) (\_loaded_2-> (let _6939 = _loaded_2 in (case _6939 of {(0,f) -> u f (\_6940-> (u (u (u io_monad (\_m_bind_4-> (\_m_pure_5-> _m_bind_4))) (u io_print (u string_flatten (u (u list_cons "On '") (u (u list_cons _file_1) (u (u list_cons "':") list_nil)))))) (\__4-> (u io_print _6940)))); (1,f) -> u f (\_6941-> (let _6942 = _6941 in (case _6942 of {(0,f) -> u f (\_6943 _6944-> (let _nams_6=_6943 in (let _defs_7=_6944 in (let _6945 = _nams_6 in (case _6945 of {(0,f) -> u f ((u io_print ((("File not found or empty: '"::String) ++ (((_file_1::String) ++ "'.")))))); (1,f) -> u f (\_6946 _6947-> (u io_print (u (u fm_defs_report _defs_7) _nams_6))); }))))); }))); })))))
io_purify = (\_io_2-> (let _6948 = _io_2 in (case _6948 of {(0,f) -> u f (\_6949-> _6949); (1,f) -> u f (\_6950 _6951 _6952-> (u io_purify (u _6952 ""))); })))
fm_checker_code = (\_code_1-> (let _6953 = (u (u (u fm_defs_read "Main.fm") _code_1) map_new) in (case _6953 of {(0,f) -> u f (\_6954-> _6954); (1,f) -> u f (\_6955-> (u io_purify (let _defs_3=_6955 in (let _nams_4=(u (u list_mapped (u map_keys _defs_3)) fm_name_from_bits) in (u (u (u io_monad (\_m_bind_5-> (\_m_pure_6-> _m_bind_5))) (u (u fm_synth_many _nams_4) _defs_3)) (\_defs_5-> (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) (u (u fm_defs_report _defs_5) _nams_4)))))))); })))
fm_term_read = (\_code_1-> (let _6956 = (u (u fm_parser_term 0) _code_1) in (case _6956 of {(0,f) -> u f (\_6957 _6958 _6959-> maybe_none); (1,f) -> u f (\_6960 _6961 _6962-> (u maybe_some _6962)); })))
fm = (let ___1=fm_to_core_io_one in (let ___2=fm_checker_io_one in (let ___3=fm_checker_io_file in (let ___4=fm_checker_code in (let ___5=fm_term_read in (u (u io_monad (\_m_bind_6-> (\_m_pure_7-> _m_pure_7))) unit_new))))))

